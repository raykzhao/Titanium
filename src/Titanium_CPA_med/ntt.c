/* ****************************** *
 * Titanium_CPA_med               *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 768=3*256 */
#define N1_768 3
#define N2_768 256

/* 1792=7*256 */
#define N1_1792 7
#define N2_1792 256

/* 2048=8*256 */
#define N1_2048 8
#define N2_2048 256

/* multiplication inverses of 768, 1792, 2048 */
#define INV_768 300665
#define INV_1792 300889
#define INV_2048 300910

/* omega_n: n-th root of unity mod Q */

static const uint32_t w_3[2]={11096,289960};

static const uint32_t w_7[6][6]={{5408,43935,66507,207798,226860,51605},
{43935,207798,51605,5408,66507,226860},
{66507,51605,43935,226860,5408,207798},
{207798,5408,226860,43935,51605,66507},
{226860,66507,5408,51605,207798,43935},
{51605,226860,207798,66507,43935,5408}};

static const uint32_t w_8[7][7]={{111890,217812,119473,301056,189167,83245,181584},
{217812,301056,83245,1,217812,301056,83245},
{119473,83245,111890,301056,181584,217812,189167},
{301056,1,301056,1,301056,1,301056},
{189167,217812,181584,301056,111890,83245,119473},
{83245,301056,217812,1,83245,301056,217812},
{181584,83245,189167,301056,119473,217812,111890}};

/* omega_256,768,1792,2048, respectively */
static const uint32_t omega_256[128]={1,15142,175787,121817,277832,262683,281959,133861,207538,107430,94089,93914,153577,98666,155738,5315,97511,128034,184805,293552,158836,251396,73524,292679,186378,27358,404,96228,269553,141777,250924,151868,111890,190641,151506,49512,78774,8074,27366,121540,298296,39861,257034,244989,300141,279607,44603,107775,200110,227972,32462,214580,163216,39759,217835,77078,218144,240101,45010,249429,93853,133086,213711,251326,217812,29869,88784,147823,278128,228860,232050,64853,257249,188892,161164,278303,169197,286961,7781,106615,96696,130641,221532,60450,120620,216278,284487,178598,236942,79495,87404,24796,42953,111206,69451,34941,119473,8653,63931,144947,81944,140151,15649,25299,132954,21309,228831,93989,84999,36183,260303,69782,230031,200969,289499,203938,87547,82703,192763,69731,59903,267542,97972,184185,238279,153530,290163,22288};
static const uint32_t omega_768[768]={1,146766,232520,15142,229055,257282,175787,174170,86464,121817,22820,242052,277832,228061,83466,262683,175872,4886,281959,204659,224847,133861,166877,280718,207538,80133,8173,107430,114176,21139,94089,183698,63147,93914,89493,14842,153577,45449,149042,98666,273513,70692,155738,193754,160629,5315,22603,4815,97511,253874,52936,128034,264332,143178,184805,263386,89819,293552,88733,164829,158836,278752,78188,251396,43644,166572,73524,37333,278735,292679,212297,87287,186378,215585,59524,27358,27019,248807,404,286292,8296,96228,113721,77263,269553,218399,8844,141777,187570,246540,250924,13202,1880,151868,2836,167602,111890,192618,220031,190641,282597,212640,151506,160633,291322,49512,65383,110560,78774,153970,222600,8074,28332,276085,27366,297976,1568,121540,11333,260210,298296,1796,166861,39861,99902,138918,257034,205716,11097,244989,215950,40968,300141,134823,160036,279607,22349,57319,44603,20490,278024,107775,170870,159377,200110,29682,13622,227972,267800,40279,32462,90867,264193,214580,77624,266047,163216,56080,39957,39759,182620,205381,217835,23495,261349,77078,212973,253350,218144,215639,157406,240101,242573,274440,45010,144966,80709,249429,68585,105315,93853,168477,281858,133086,222773,109804,213711,186138,215414,251326,5962,147250,217812,260561,31358,29869,62677,55947,88784,123470,276133,147823,18770,126270,278128,17532,268390,228860,238327,293994,232050,278232,228346,64853,298343,276544,257249,149421,27435,188892,89427,263167,161164,250305,84262,278303,111737,15638,169197,282371,159794,286961,50168,5639,7781,77045,186607,106615,19515,183249,96696,159213,215046,130641,239847,295077,221532,112683,68997,60450,155967,84784,120620,161206,92280,216278,11096,98223,284487,25826,71086,178598,285306,105437,236942,236559,21783,79495,192,180771,87404,197751,24238,24796,32720,23313,42953,207475,166642,111206,56655,134447,69451,158617,49040,34941,246925,157118,119473,111467,128342,8653,107772,31629,63931,154684,245688,144947,1668,46347,81944,269125,22407,140151,284255,296612,15649,278338,130578,25299,97053,170757,132954,117309,124978,21309,56578,273631,228831,196911,174168,93989,258891,293593,84999,64325,177544,36183,89755,233295,260303,98912,251109,69782,267986,243625,230031,197766,118329,200969,259850,147511,289499,134767,69679,203938,77568,175690,87547,111299,158328,82703,273429,85685,192763,126054,187657,69731,8288,126328,59903,257184,243455,267542,107833,253702,97972,175175,68364,184185,187680,133722,238279,173537,210199,153530,71758,58654,290163,44923,20718,22288,136303,10562,301056,154291,68537,285915,72002,43775,125270,126887,214593,179240,278237,59005,23225,72996,217591,38374,125185,296171,19098,96398,76210,167196,134180,20339,93519,220924,292884,193627,186881,279918,206968,117359,237910,207143,211564,286215,147480,255608,152015,202391,27544,230365,145319,107303,140428,295742,278454,296242,203546,47183,248121,173023,36725,157879,116252,37671,211238,7505,212324,136228,142221,22305,222869,49661,257413,134485,227533,263724,22322,8378,88760,213770,114679,85472,241533,273699,274038,52250,300653,14765,292761,204829,187336,223794,31504,82658,292213,159280,113487,54517,50133,287855,299177,149189,298221,133455,189167,108439,81026,110416,18460,88417,149551,140424,9735,251545,235674,190497,222283,147087,78457,292983,272725,24972,273691,3081,299489,179517,289724,40847,2761,299261,134196,261196,201155,162139,44023,95341,289960,56068,85107,260089,916,166234,141021,21450,278708,243738,256454,280567,23033,193282,130187,141680,100947,271375,287435,73085,33257,260778,268595,210190,36864,86477,223433,35010,137841,244977,261100,261298,118437,95676,83222,277562,39708,223979,88084,47707,82913,85418,143651,60956,58484,26617,256047,156091,220348,51628,232472,195742,207204,132580,19199,167971,78284,191253,87346,114919,85643,49731,295095,153807,83245,40496,269699,271188,238380,245110,212273,177587,24924,153234,282287,174787,22929,283525,32667,72197,62730,7063,69007,22825,72711,236204,2714,24513,43808,151636,273622,112165,211630,37890,139893,50752,216795,22754,189320,285419,131860,18686,141263,14096,250889,295418,293276,224012,114450,194442,281542,117808,204361,141844,86011,170416,61210,5980,79525,188374,232060,240607,145090,216273,180437,139851,208777,84779,289961,202834,16570,275231,229971,122459,15751,195620,64115,64498,279274,221562,300865,120286,213653,103306,276819,276261,268337,277744,258104,93582,134415,189851,244402,166610,231606,142440,252017,266116,54132,143939,181584,189590,172715,292404,193285,269428,237126,146373,55369,156110,299389,254710,219113,31932,278650,160906,16802,4445,285408,22719,170479,275758,204004,130300,168103,183748,176079,279748,244479,27426,72226,104146,126889,207068,42166,7464,216058,236732,123513,264874,211302,67762,40754,202145,49948,231275,33071,57432,71026,103291,182728,100088,41207,153546,11558,166290,231378,97119,223489,125367,213510,189758,142729,218354,27628,215372,108294,175003,113400,231326,292769,174729,241154,43873,57602,33515,193224,47355,203085,125882,232693,116872,113377,167335,62778,127520,90858,147527,229299,242403,10894,256134,280339,278769,164754,290495};
static const uint32_t omega_1792[1792]={1,168263,133718,296939,126180,283586,98732,15142,294012,149631,265100,109838,83221,251939,175787,199845,258677,151219,128128,208837,167091,121817,129083,135564,219613,102868,208183,8894,277832,112742,103462,205481,259395,240196,100469,262683,146174,222033,270264,169468,279272,60577,281959,296701,120167,69687,175645,90002,237312,133861,273988,281263,296826,79052,226302,263009,207538,160836,132024,59339,2752,34110,100282,107430,128639,88928,157050,124918,180865,239593,94089,12948,220872,1857,268282,243358,180356,93914,70509,1611,120393,163943,290213,62505,153577,99156,8145,90671,209941,177274,228559,98666,48893,199277,120362,65759,58696,190163,155738,38643,259080,223383,127279,54568,138998,5315,178555,216650,89991,192761,168248,18229,97511,187950,197228,59740,39447,66882,255306,128034,47079,241993,207852,9386,272553,271572,184805,268299,93259,45106,23908,108170,5661,293552,120300,170448,197776,144422,160060,218674,158836,187750,263012,110213,260933,119670,136822,251396,29249,145708,86295,276475,282114,185507,73524,33511,164840,91510,186865,72415,85184,292679,142517,244750,180106,176144,58336,127940,186378,15838,293887,190746,108485,22474,266742,27358,177624,113437,236131,112878,106898,26652,404,240427,132869,142670,98087,167084,148204,96228,164390,239524,225165,119173,203957,26090,269553,54104,38729,278962,282965,74188,67996,141777,66671,276539,212894,12806,111029,281549,250924,88161,252782,223649,27744,98830,247838,151868,47124,287403,204022,125133,230570,87491,111890,46518,77291,155247,212185,233968,137922,190641,203233,131763,97018,24966,205737,283572,151506,250489,50607,189453,208637,232875,172290,49512,188352,101129,226230,190353,213666,156275,78774,113023,119416,148114,5408,172050,8030,8074,186278,48730,168595,432,134879,264289,27366,18443,280010,203187,219147,268187,214394,121540,184067,125689,156071,73620,230738,56317,298296,257865,201541,230689,241026,68311,158590,39861,183597,220070,229524,202738,234367,139148,257034,65436,201064,50400,281624,226255,182130,244989,53325,222704,278362,179260,225607,130340,300141,12276,44511,159404,25008,47415,179645,279607,131023,219996,121399,242487,238042,134595,44603,285693,284784,270673,46982,177560,182657,107775,75373,159917,241625,3753,174510,282692,200110,291936,61763,241086,229210,53131,93838,227972,74981,132304,208087,112724,85298,207013,32462,76355,113890,291849,174675,47786,286419,214580,108530,67884,262912,143105,135641,230413,163216,192154,90930,136793,188681,65168,265130,39759,181020,128399,47446,277829,210067,3365,217835,181912,292609,105330,217257,167309,74197,77078,141011,29609,207931,55655,299280,247307,218144,92318,65605,37096,69467,187796,175628,240101,71505,203867,236327,277213,123667,122695,45010,127738,216693,99932,222552,292231,24943,249429,218628,246220,57862,151383,26016,161428,93853,42404,274409,70534,294445,151716,60993,133086,227844,213421,176649,133077,218762,214187,213711,201685,74944,228770,77433,265090,233550,251326,293119,118215,73498,174528,300856,198578,217812,225604,227665,200044,24630,268085,211817,29869,1989,200780,131771,238894,191539,172793,88784,11738,137174,171743,133093,201457,246276,147823,113166,96465,2140,18648,152370,219190,278128,244185,245523,190781,277607,186749,122612,228860,168253,257430,163987,167360,226014,273442,232050,142592,220081,274075,168351,189069,21843,64853,248317,66569,273962,121223,131785,186120,257249,115141,48962,68201,14137,82674,34463,188892,43935,180270,74032,10927,54702,106965,161164,228857,265578,157333,176341,89877,278427,278303,186624,163727,72245,80889,139894,240463,169197,139606,250896,193709,121362,37896,107388,286961,192855,28949,244384,11476,6590,60239,7781,258567,6766,170941,59703,135913,237285,106615,276286,91392,201593,249712,270051,155232,96696,34540,199692,104283,164241,156068,170945,130641,68671,220813,9221,206402,185263,262161,221532,266461,11404,234991,66367,3220,205317,60450,287605,173707,41039,848,287063,195432,120620,125405,237442,30890,196022,46980,142091,216278,116011,124070,194859,44161,274526,188600,284487,272024,72260,196378,38265,178693,255555,178598,226591,119782,15687,174962,170147,128189,236942,195350,171676,299638,274061,221125,123359,79495,104675,191854,189606,61974,219853,144350,87404,224802,154275,134500,15639,226877,73880,24796,201442,130787,249452,174936,10107,264205,42953,226297,23808,141062,181426,103238,146694,111206,259457,135507,262446,7367,141852,42002,69451,205101,143539,4932,160024,182346,161900,34941,236387,137055,18208,176672,89385,283706,119473,105281,100909,238381,275979,216455,93919,8653,68087,99803,192729,202858,255108,229287,63931,154186,211943,157017,292322,284026,74430,144947,288434,274343,104285,199710,122447,162709,81944,33729,117220,39505,192312,183468,190247,140151,131846,214225,285508,165000,219517,206698,15649,103165,206832,284673,259014,257134,32544,25299,240714,255230,285497,120449,253904,251996,132954,295346,23951,118111,35452,116478,127014,21309,228454,193414,158182,29553,117970,93872,228831,105538,293349,283409,120824,130559,119727,93989,45840,95580,112600,294676,184116,242037,84999,172895,91361,103409,18195,96652,157393,36183,285475,31347,21621,41535,66507,77594,260303,86044,190442,136223,14897,13329,203934,69782,204609,148818,147159,78681,119528,26979,230031,11891,291568,158721,105153,239349,282726,200969,21436,222808,15351,237310,98392,6552,289499,44466,113994,28838,232725,221628,162631,203938,140720,137367,132346,49765,8797,213399,87547,201851,8301,147740,297016,136980,42877,82703,97178,152973,225570,226806,169487,164642,192763,203717,285665,89275,139253,162286,257204,69731,52792,253511,56120,266755,107378,109616,59903,70129,186812,186186,223498,209876,78231,267542,65279,276789,130664,24979,285757,215564,97972,84487,124541,268741,104426,141290,10094,184185,110961,279831,189810,67128,102138,207449,238279,273402,124784,212898,83744,43787,265077,153530,18277,45596,284217,300621,95240,104010,290163,78951,90931,3999,21342,61050,90253,22288,279752,143541,40401,126403,174110,113203,301056,132794,167339,4118,174877,17471,202325,285915,7045,151426,35957,191219,217836,49118,125270,101212,42380,149838,172929,92220,133966,179240,171974,165493,81444,198189,92874,292163,23225,188315,197595,95576,41662,60861,200588,38374,154883,79024,30793,131589,21785,240480,19098,4356,180890,231370,125412,211055,63745,167196,27069,19794,4231,222005,74755,38048,93519,140221,169033,241718,298305,266947,200775,193627,172418,212129,144007,176139,120192,61464,206968,288109,80185,299200,32775,57699,120701,207143,230548,299446,180664,137114,10844,238552,147480,201901,292912,210386,91116,123783,72498,202391,252164,101780,180695,235298,242361,110894,145319,262414,41977,77674,173778,246489,162059,295742,122502,84407,211066,108296,132809,282828,203546,113107,103829,241317,261610,234175,45751,173023,253978,59064,93205,291671,28504,29485,116252,32758,207798,255951,277149,192887,295396,7505,180757,130609,103281,156635,140997,82383,142221,113307,38045,190844,40124,181387,164235,49661,271808,155349,214762,24582,18943,115550,227533,267546,136217,209547,114192,228642,215873,8378,158540,56307,120951,124913,242721,173117,114679,285219,7170,110311,192572,278583,34315,273699,123433,187620,64926,188179,194159,274405,300653,60630,168188,158387,202970,133973,152853,204829,136667,61533,75892,181884,97100,274967,31504,246953,262328,22095,18092,226869,233061,159280,234386,24518,88163,288251,190028,19508,50133,212896,48275,77408,273313,202227,53219,149189,253933,13654,97035,175924,70487,213566,189167,254539,223766,145810,88872,67089,163135,110416,97824,169294,204039,276091,95320,17485,149551,50568,250450,111604,92420,68182,128767,251545,112705,199928,74827,110704,87391,144782,222283,188034,181641,152943,295649,129007,293027,292983,114779,252327,132462,300625,166178,36768,273691,282614,21047,97870,81910,32870,86663,179517,116990,175368,144986,227437,70319,244740,2761,43192,99516,70368,60031,232746,142467,261196,117460,80987,71533,98319,66690,161909,44023,235621,99993,250657,19433,74802,118927,56068,247732,78353,22695,121797,75450,170717,916,288781,256546,141653,276049,253642,121412,21450,170034,81061,179658,58570,63015,166462,256454,15364,16273,30384,254075,123497,118400,193282,225684,141140,59432,297304,126547,18365,100947,9121,239294,59971,71847,247926,207219,73085,226076,168753,92970,188333,215759,94044,268595,224702,187167,9208,126382,253271,14638,86477,192527,233173,38145,157952,165416,70644,137841,108903,210127,164264,112376,235889,35927,261298,120037,172658,253611,23228,90990,297692,83222,119145,8448,195727,83800,133748,226860,223979,160046,271448,93126,245402,1777,53750,82913,208739,235452,263961,231590,113261,125429,60956,229552,97190,64730,23844,177390,178362,256047,173319,84364,201125,78505,8826,276114,51628,82429,54837,243195,149674,275041,139629,207204,258653,26648,230523,6612,149341,240064,167971,73213,87636,124408,167980,82295,86870,87346,99372,226113,72287,223624,35967,67507,49731,7938,182842,227559,126529,201,102479,83245,75453,73392,101013,276427,32972,89240,271188,299068,100277,169286,62163,109518,128264,212273,289319,163883,129314,167964,99600,54781,153234,187891,204592,298917,282409,148687,81867,22929,56872,55534,110276,23450,114308,178445,72197,132804,43627,137070,133697,75043,27615,69007,158465,80976,26982,132706,111988,279214,236204,52740,234488,27095,179834,169272,114937,43808,185916,252095,232856,286920,218383,266594,112165,257122,120787,227025,290130,246355,194092,139893,72200,35479,143724,124716,211180,22630,22754,114433,137330,228812,220168,161163,60594,131860,161451,50161,107348,179695,263161,193669,14096,108202,272108,56673,289581,294467,240818,293276,42490,294291,130116,241354,165144,63772,194442,24771,209665,99464,51345,31006,145825,204361,266517,101365,196774,136816,144989,130112,170416,232386,80244,291836,94655,115794,38896,79525,34596,289653,66066,234690,297837,95740,240607,13452,127350,260018,300209,13994,105625,180437,175652,63615,270167,105035,254077,158966,84779,185046,176987,106198,256896,26531,112457,16570,29033,228797,104679,262792,122364,45502,122459,74466,181275,285370,126095,130910,172868,64115,105707,129381,1419,26996,79932,177698,221562,196382,109203,111451,239083,81204,156707,213653,76255,146782,166557,285418,74180,227177,276261,99615,170270,51605,126121,290950,36852,258104,74760,277249,159995,119631,197819,154363,189851,41600,165550,38611,293690,159205,259055,231606,95956,157518,296125,141033,118711,139157,266116,64670,164002,282849,124385,211672,17351,181584,195776,200148,62676,25078,84602,207138,292404,232970,201254,108328,98199,45949,71770,237126,146871,89114,144040,8735,17031,226627,156110,12623,26714,196772,101347,178610,138348,219113,267328,183837,261552,108745,117589,110810,160906,169211,86832,15549,136057,81540,94359,285408,197892,94225,16384,42043,43923,268513,275758,60343,45827,15560,180608,47153,49061,168103,5711,277106,182946,265605,184579,174043,279748,72603,107643,142875,271504,183087,207185,72226,195519,7708,17648,180233,170498,181330,207068,255217,205477,188457,6381,116941,59020,216058,128162,209696,197648,282862,204405,143664,264874,15582,269710,279436,259522,234550,223463,40754,215013,110615,164834,286160,287728,97123,231275,96448,152239,153898,222376,181529,274078,71026,289166,9489,142336,195904,61708,18331,100088,279621,78249,285706,63747,202665,294505,11558,256591,187063,272219,68332,79429,138426,97119,160337,163690,168711,251292,292260,87658,213510,99206,292756,153317,4041,164077,258180,218354,203879,148084,75487,74251,131570,136415,108294,97340,15392,211782,161804,138771,43853,231326,248265,47546,244937,34302,193679,191441,241154,230928,114245,114871,77559,91181,222826,33515,235778,24268,170393,276078,15300,85493,203085,216570,176516,32316,196631,159767,290963,116872,190096,21226,111247,233929,198919,93608,62778,27655,176273,88159,217313,257270,35980,147527,282780,255461,16840,436,205817,197047,10894,222106,210126,297058,279715,240007,210804,278769,21305,157516,260656,174654,126947,187854};
static const uint32_t omega_2048[2048]={1,174,30276,150055,218668,115050,148938,24310,15142,226252,230438,55631,45970,171298,1209,210366,175787,180181,41566,7116,33956,188261,243258,178912,121817,122168,183242,273123,257453,240386,281298,174618,277832,173648,109052,8457,267290,145682,59880,183182,262683,247235,268796,106669,195929,72205,220333,103703,281959,289632,119449,11193,141240,190143,269669,258571,133861,110425,247359,290372,248209,137215,91907,35797,207538,285829,59841,176396,286147,115173,170340,135574,107430,27286,231909,10528,25530,227422,132961,254882,94089,114408,37230,155823,18072,133958,127303,173561,93914,83958,157956,88157,286468,171027,255112,134109,153577,229382,172944,287613,69200,299577,43537,49013,98666,7635,124262,246541,148040,169115,223481,49341,155738,3282,270011,17022,252315,249545,68622,199005,5315,21639,152502,42332,140400,43983,126617,54197,97511,107722,78094,40791,173323,52502,103638,270649,128034,300755,248509,189415,142997,194804,177512,179274,184805,244028,11835,252948,58630,266739,49808,236996,293552,199415,76655,91462,259424,282283,44951,295049,158836,241277,135275,55404,6472,222957,259222,247135,251396,89639,243279,182566,155499,262753,259415,280717,73524,148782,298223,108998,300118,137671,171251,294088,292679,47513,138723,53242,232398,95614,78701,146409,186378,216673,68977,260775,216300,4075,106936,242387,27358,244437,83001,292495,15497,288022,140366,38067,404,70296,189224,109763,132171,117422,260609,187416,96228,185537,70339,196706,207403,262339,187379,89790,269553,238387,234529,165351,170659,191080,131650,26768,141777,283581,270803,154830,146347,175590,145903,98334,250924,7511,102686,105001,206754,149413,106960,246563,151868,233073,213064,43125,278382,269348,202717,49089,111890,201212,88276,6117,161187,48237,264699,296962,190641,55264,283169,199115,24455,40372,100417,11252,151506,170085,91204,214532,298557,167114,176364,280579,49512,185492,62509,38514,78182,56103,128098,10834,78774,159111,289127,31579,75720,229829,250722,273420,8074,200648,291197,90702,127184,152855,103754,290833,27366,245829,24152,288707,259556,4194,127642,232547,121540,73970,226386,253754,198874,283578,270281,64002,298296,121700,101810,253634,177994,263142,26044,15801,39861,11503,195180,242936,122884,6769,274635,219484,257034,167480,240048,222486,177268,136818,22829,58505,244989,179049,145655,55182,268901,124939,63282,173016,300141,141673,265485,132669,204074,285207,252670,10258,279607,181441,260806,221694,39460,242786,96784,282281,44603,234497,159783,104998,206232,58585,258909,192673,107775,87316,140134,298756,201740,180148,35824,212236,200110,197585,59292,80870,222758,224596,243351,195094,227972,228661,47490,134721,260065,92760,184219,142064,32462,229362,169464,284207,78670,141015,150993,80823,214580,5852,115077,153636,239648,152886,109148,25161,163216,100226,279075,88873,109995,172539,217143,150757,39759,294812,117598,291233,96966,12892,135809,148320,217835,271165,217818,268207,4183,125728,200568,277277,77078,165064,120721,232521,117016,189965,238697,288469,218144,23874,240335,272424,135827,151452,160689,262642,240101,231708,276611,262251,172067,135015,10164,263251,45010,4258,138778,62812,91236,220100,63161,151962,249429,48438,299673,60241,245996,53210,226830,29953,93853,73344,117462,267569,194228,77288,201604,156484,133086,276632,265905,205749,275600,86337,270845,162138,213711,155703,298249,113522,184123,125360,136536,274818,251326,77459,231358,215711,202646,36735,69693,84302,217812,267163,123584,128569,92788,189091,86621,19204,29869,79237,239673,157236,263934,163852,210890,266963,88784,94509,187488,108756,258010,36247,285838,61407,147823,131357,276843,1562,271788,25163,163564,160778,278128,225152,39038,169358,265763,181041,191206,153574,228860,82116,138505,15310,255484,198837,277140,53240,232050,35062,79648,10130,257335,219854,20357,230491,64853,145313,296731,150447,286876,242019,264383,241978,257249,204890,126134,271212,225996,185894,132457,167186,188892,51995,15420,274624,217570,225055,22160,243156,161164,44235,170465,157324,279246,118627,169222,242099,278303,255602,219369,237024,298424,143972,63397,193026,169197,237749,123517,116911,171695,70287,187658,138336,286961,256809,128330,51202,178495,49259,141470,230163,7781,149666,150982,78909,182601,161589,118185,92314,106615,186533,243643,245902,36854,90399,74462,10937,96696,266969,89828,276165,184647,216536,45139,26704,130641,152259,50,8700,8515,277382,95348,32417,221532,11272,154986,173491,81734,72037,191101,135304,60450,282362,58697,278397,271958,54743,192515,80283,120620,214947,69710,87260,130390,108585,228256,278077,216278,247,42978,252804,33574,121793,117992,58732,284487,127390,188699,18413,193292,215481,162626,298623,178598,67181,249328,30864,252367,258593,137689,174383,236942,284156,69796,102224,24613,67864,67113,237496,79495,284565,140962,141771,282537,89147,157671,38567,87404,155446,253531,160072,155284,225343,72272,231991,24796,99706,188595,317,55158,264725,429,74646,42953,248454,179845,284159,70318,193052,173721,121754,111206,82196,152425,28934,217604,230971,148373,227057,69451,42194,116388,80693,191960,284770,176632,26154,34941,58594,260475,164100,254042,248986,272413,133913,119473,15369,265750,178779,98675,9201,95689,91751,8653,337,58638,268131,292016,233208,236554,216644,63931,285942,79503,285957,82113,137983,225539,106376,144947,233047,208540,159120,290693,3006,221987,90442,81944,108577,226864,35869,220066,57245,25749,265528,140151,657,114318,21570,140496,60687,22543,8741,15649,13413,226463,267152,121670,96590,248525,192199,25299,187228,63516,213732,159357,30874,254107,260296,132954,253664,183214,268251,11839,253644,179734,264845,21309,95082,287190,296655,137223,93299,278005,203750,228831,77070,163672,179570,236309,174014,172736,251421,93989,97008,20200,203173,128433,69124,286353,151017,84999,38033,295545,245140,205323,201476,134212,171499,36183,274702,231142,178127,286284,139011,103354,221233,260303,134172,164539,29371,293642,215075,91982,48847,69782,99788,202863,74493,16331,132081,101762,245282,230031,285870,66975,213484,116205,48851,70478,220892,200969,45994,175474,125719,199002,4793,231868,3394,289499,96307,199283,53687,8771,20869,18522,212258,203938,261543,48875,74654,44345,189605,176057,227161,87547,180328,67144,242890,114880,119358,296416,95637,82703,240643,24959,128068,5614,73665,173316,51284,192763,123435,102643,97519,109114,19245,37003,116325,69731,90914,164072,249170,3372,285671,32349,209700,59903,187184,55860,85816,180191,43306,8819,29221,267542,189530,163007,63860,273588,37306,169047,211649,97972,187936,186708,274093,125176,104520,123060,37393,184185,136148,207306,245461,261177,286248,132747,217646,238279,215737,207170,221797,57382,49587,198542,225810,153530,221204,255257,159339,27742,10196,268819,110671,290163,211843,131728,40340,94849,246648,166658,97020,22288,265428,122751,284684,161668,131931,75662,219737,301056,300883,270781,151002,82389,186007,152119,276747,285915,74805,70619,245426,255087,129759,299848,90691,125270,120876,259491,293941,267101,112796,57799,122145,179240,178889,117815,27934,43604,60671,19759,126439,23225,127409,192005,292600,33767,155375,241177,117875,38374,53822,32261,194388,105128,228852,80724,197354,19098,11425,181608,289864,159817,110914,31388,42486,167196,190632,53698,10685,52848,163842,209150,265260,93519,15228,241216,124661,14910,185884,130717,165483,193627,273771,69148,290529,275527,73635,168096,46175,206968,186649,263827,145234,282985,167099,173754,127496,207143,217099,143101,212900,14589,130030,45945,166948,147480,71675,128113,13444,231857,1480,257520,252044,202391,293422,176795,54516,153017,131942,77576,251716,145319,297775,31046,284035,48742,51512,232435,102052,295742,279418,148555,258725,160657,257074,174440,246860,203546,193335,222963,260266,127734,248555,197419,30408,173023,302,52548,111642,158060,106253,123545,121783,116252,57029,289222,48109,242427,34318,251249,64061,7505,101642,224402,209595,41633,18774,256106,6008,142221,59780,165782,245653,294585,78100,41835,53922,49661,211418,57778,118491,145558,38304,41642,20340,227533,152275,2834,192059,939,163386,129806,6969,8378,253544,162334,247815,68659,205443,222356,154648,114679,84384,232080,40282,84757,296982,194121,58670,273699,56620,218056,8562,285560,13035,160691,262990,300653,230761,111833,191294,168886,183635,40448,113641,204829,115520,230718,104351,93654,38718,113678,211267,31504,62670,66528,135706,130398,109977,169407,274289,159280,17476,30254,146227,154710,125467,155154,202723,50133,293546,198371,196056,94303,151644,194097,54494,149189,67984,87993,257932,22675,31709,98340,251968,189167,99845,212781,294940,139870,252820,36358,4095,110416,245793,17888,101942,276602,260685,200640,289805,149551,130972,209853,86525,2500,133943,124693,20478,251545,115565,238548,262543,222875,244954,172959,290223,222283,141946,11930,269478,225337,71228,50335,27637,292983,100409,9860,210355,173873,148202,197303,10224,273691,55228,276905,12350,41501,296863,173415,68510,179517,227087,74671,47303,102183,17479,30776,237055,2761,179357,199247,47423,123063,37915,275013,285256,261196,289554,105877,58121,178173,294288,26422,81573,44023,133577,61009,78571,123789,164239,278228,242552,56068,122008,155402,245875,32156,176118,237775,128041,916,159384,35572,168388,96983,15850,48387,290799,21450,119616,40251,79363,261597,58271,204273,18776,256454,66560,141274,196059,94825,242472,42148,108384,193282,213741,160923,2301,99317,120909,265233,88821,100947,103472,241765,220187,78299,76461,57706,105963,73085,72396,253567,166336,40992,208297,116838,158993,268595,71695,131593,16850,222387,160042,150064,220234,86477,295205,185980,147421,61409,148171,191909,275896,137841,200831,21982,212184,191062,128518,83914,150300,261298,6245,183459,9824,204091,288165,165248,152737,83222,29892,83239,32850,296874,175329,100489,23780,223979,135993,180336,68536,184041,111092,62360,12588,82913,277183,60722,28633,165230,149605,140368,38415,60956,69349,24446,38806,128990,166042,290893,37806,256047,296799,162279,238245,209821,80957,237896,149095,51628,252619,1384,240816,55061,247847,74227,271104,207204,227713,183595,33488,106829,223769,99453,144573,167971,24425,35152,95308,25457,214720,30212,138919,87346,145354,2808,187535,116934,175697,164521,26239,49731,223598,69699,85346,98411,264322,231364,216755,83245,33894,177473,172488,208269,111966,214436,281853,271188,221820,61384,143821,37123,137205,90167,34094,212273,206548,113569,192301,43047,264810,15219,239650,153234,169700,24214,299495,29269,275894,137493,140279,22929,75905,262019,131699,35294,120016,109851,147483,72197,218941,162552,285747,45573,102220,23917,247817,69007,265995,221409,290927,43722,81203,280700,70566,236204,155744,4326,150610,14181,59038,36674,59079,43808,96167,174923,29845,75061,115163,168600,133871,112165,249062,285637,26433,83487,76002,278897,57901,139893,256822,130592,143733,21811,182430,131835,58958,22754,45455,81688,64033,2633,157085,237660,108031,131860,63308,177540,184146,129362,230770,113399,162721,14096,44248,172727,249855,122562,251798,159587,70894,293276,151391,150075,222148,118456,139468,182872,208743,194442,114524,57414,55155,264203,210658,226595,290120,204361,34088,211229,24892,116410,84521,255918,274353,170416,148798,301007,292357,292542,23675,205709,268640,79525,289785,146071,127566,219323,229020,109956,165753,240607,18695,242360,22660,29099,246314,108542,220774,180437,86110,231347,213797,170667,192472,72801,22980,84779,300810,258079,48253,267483,179264,183065,242325,16570,173667,112358,282644,107765,85576,138431,2434,122459,233876,51729,270193,48690,42464,163368,126674,64115,16901,231261,198833,276444,233193,233944,63561,221562,16492,160095,159286,18520,211910,143386,262490,213653,145611,47526,140985,145773,75714,228785,69066,276261,201351,112462,300740,245899,36332,300628,226411,258104,52603,121212,16898,230739,108005,127336,179303,189851,218861,148632,272123,83453,70086,152684,74000,231606,258863,184669,220364,109097,16287,124425,274903,266116,242463,40582,136957,47015,52071,28644,167144,181584,285688,35307,122278,202382,291856,205368,209306,292404,300720,242419,32926,9041,67849,64503,84413,237126,15115,221554,15100,218944,163074,75518,194681,156110,68010,92517,141937,10364,298051,79070,210615,219113,192480,74193,265188,80991,243812,275308,35529,160906,300400,186739,279487,160561,240370,278514,292316,285408,287644,74594,33905,179387,204467,52532,108858,275758,113829,237541,87325,141700,270183,46950,40761,168103,47393,117843,32806,289218,47413,121323,36212,279748,205975,13867,4402,163834,207758,23052,97307,72226,223987,137385,121487,64748,127043,128321,49636,207068,204049,280857,97884,172624,231933,14704,150040,216058,263024,5512,55917,95734,99581,166845,129558,264874,26355,69915,122930,14773,162046,197703,79824,40754,166885,136518,271686,7415,85982,209075,252210,231275,201269,98194,226564,284726,168976,199295,55775,71026,15187,234082,87573,184852,252206,230579,80165,100088,255063,125583,175338,102055,296264,69189,297663,11558,204750,101774,247370,292286,280188,282535,88799,97119,39514,252182,226403,256712,111452,125000,73896,213510,120729,233913,58167,186177,181699,4641,205420,218354,60414,276098,172989,295443,227392,127741,249773,108294,177622,198414,203538,191943,281812,264054,184732,231326,210143,136985,51887,297685,15386,268708,91357,241154,113873,245197,215241,120866,257751,292238,271836,33515,111527,138050,237197,27469,263751,132010,89408,203085,113121,114349,26964,175881,196537,177997,263664,116872,164909,93751,55596,39880,14809,168310,83411,62778,85320,93887,79260,243675,251470,102515,75247,147527,79853,45800,141718,273315,290861,32238,190386,10894,89214,169329,260717,206208,54409,134399,204037,278769,35629,178306,16373,139389,169126,225395,81320};

/* multiplication inverses of omega */
static const uint32_t w_3_inv[2]={289960,11096};

static const uint32_t w_7_inv[6][6]={{51605,226860,207798,66507,43935,5408},
{226860,66507,5408,51605,207798,43935},
{207798,5408,226860,43935,51605,66507},
{66507,51605,43935,226860,5408,207798},
{43935,207798,51605,5408,66507,226860},
{5408,43935,66507,207798,226860,51605}};

static const uint32_t omega_256_inv[128]={1,278769,10894,147527,62778,116872,203085,33515,241154,231326,108294,218354,213510,97119,11558,100088,71026,231275,40754,264874,216058,207068,72226,279748,168103,275758,285408,160906,219113,156110,237126,292404,181584,266116,231606,189851,258104,276261,213653,221562,64115,122459,16570,84779,180437,240607,79525,170416,204361,194442,293276,14096,131860,22754,139893,112165,43808,236204,69007,72197,22929,153234,212273,271188,83245,49731,87346,167971,207204,51628,256047,60956,82913,223979,83222,261298,137841,86477,268595,73085,100947,193282,256454,21450,916,56068,44023,261196,2761,179517,273691,292983,222283,251545,149551,110416,189167,149189,50133,159280,31504,204829,300653,273699,114679,8378,227533,49661,142221,7505,116252,173023,203546,295742,145319,202391,147480,207143,206968,193627,93519,167196,19098,38374,23225,179240,125270,285915};
static const uint32_t omega_768_inv[768]={1,290495,164754,278769,280339,256134,10894,242403,229299,147527,90858,127520,62778,167335,113377,116872,232693,125882,203085,47355,193224,33515,57602,43873,241154,174729,292769,231326,113400,175003,108294,215372,27628,218354,142729,189758,213510,125367,223489,97119,231378,166290,11558,153546,41207,100088,182728,103291,71026,57432,33071,231275,49948,202145,40754,67762,211302,264874,123513,236732,216058,7464,42166,207068,126889,104146,72226,27426,244479,279748,176079,183748,168103,130300,204004,275758,170479,22719,285408,4445,16802,160906,278650,31932,219113,254710,299389,156110,55369,146373,237126,269428,193285,292404,172715,189590,181584,143939,54132,266116,252017,142440,231606,166610,244402,189851,134415,93582,258104,277744,268337,276261,276819,103306,213653,120286,300865,221562,279274,64498,64115,195620,15751,122459,229971,275231,16570,202834,289961,84779,208777,139851,180437,216273,145090,240607,232060,188374,79525,5980,61210,170416,86011,141844,204361,117808,281542,194442,114450,224012,293276,295418,250889,14096,141263,18686,131860,285419,189320,22754,216795,50752,139893,37890,211630,112165,273622,151636,43808,24513,2714,236204,72711,22825,69007,7063,62730,72197,32667,283525,22929,174787,282287,153234,24924,177587,212273,245110,238380,271188,269699,40496,83245,153807,295095,49731,85643,114919,87346,191253,78284,167971,19199,132580,207204,195742,232472,51628,220348,156091,256047,26617,58484,60956,143651,85418,82913,47707,88084,223979,39708,277562,83222,95676,118437,261298,261100,244977,137841,35010,223433,86477,36864,210190,268595,260778,33257,73085,287435,271375,100947,141680,130187,193282,23033,280567,256454,243738,278708,21450,141021,166234,916,260089,85107,56068,289960,95341,44023,162139,201155,261196,134196,299261,2761,40847,289724,179517,299489,3081,273691,24972,272725,292983,78457,147087,222283,190497,235674,251545,9735,140424,149551,88417,18460,110416,81026,108439,189167,133455,298221,149189,299177,287855,50133,54517,113487,159280,292213,82658,31504,223794,187336,204829,292761,14765,300653,52250,274038,273699,241533,85472,114679,213770,88760,8378,22322,263724,227533,134485,257413,49661,222869,22305,142221,136228,212324,7505,211238,37671,116252,157879,36725,173023,248121,47183,203546,296242,278454,295742,140428,107303,145319,230365,27544,202391,152015,255608,147480,286215,211564,207143,237910,117359,206968,279918,186881,193627,292884,220924,93519,20339,134180,167196,76210,96398,19098,296171,125185,38374,217591,72996,23225,59005,278237,179240,214593,126887,125270,43775,72002,285915,68537,154291,301056,10562,136303,22288,20718,44923,290163,58654,71758,153530,210199,173537,238279,133722,187680,184185,68364,175175,97972,253702,107833,267542,243455,257184,59903,126328,8288,69731,187657,126054,192763,85685,273429,82703,158328,111299,87547,175690,77568,203938,69679,134767,289499,147511,259850,200969,118329,197766,230031,243625,267986,69782,251109,98912,260303,233295,89755,36183,177544,64325,84999,293593,258891,93989,174168,196911,228831,273631,56578,21309,124978,117309,132954,170757,97053,25299,130578,278338,15649,296612,284255,140151,22407,269125,81944,46347,1668,144947,245688,154684,63931,31629,107772,8653,128342,111467,119473,157118,246925,34941,49040,158617,69451,134447,56655,111206,166642,207475,42953,23313,32720,24796,24238,197751,87404,180771,192,79495,21783,236559,236942,105437,285306,178598,71086,25826,284487,98223,11096,216278,92280,161206,120620,84784,155967,60450,68997,112683,221532,295077,239847,130641,215046,159213,96696,183249,19515,106615,186607,77045,7781,5639,50168,286961,159794,282371,169197,15638,111737,278303,84262,250305,161164,263167,89427,188892,27435,149421,257249,276544,298343,64853,228346,278232,232050,293994,238327,228860,268390,17532,278128,126270,18770,147823,276133,123470,88784,55947,62677,29869,31358,260561,217812,147250,5962,251326,215414,186138,213711,109804,222773,133086,281858,168477,93853,105315,68585,249429,80709,144966,45010,274440,242573,240101,157406,215639,218144,253350,212973,77078,261349,23495,217835,205381,182620,39759,39957,56080,163216,266047,77624,214580,264193,90867,32462,40279,267800,227972,13622,29682,200110,159377,170870,107775,278024,20490,44603,57319,22349,279607,160036,134823,300141,40968,215950,244989,11097,205716,257034,138918,99902,39861,166861,1796,298296,260210,11333,121540,1568,297976,27366,276085,28332,8074,222600,153970,78774,110560,65383,49512,291322,160633,151506,212640,282597,190641,220031,192618,111890,167602,2836,151868,1880,13202,250924,246540,187570,141777,8844,218399,269553,77263,113721,96228,8296,286292,404,248807,27019,27358,59524,215585,186378,87287,212297,292679,278735,37333,73524,166572,43644,251396,78188,278752,158836,164829,88733,293552,89819,263386,184805,143178,264332,128034,52936,253874,97511,4815,22603,5315,160629,193754,155738,70692,273513,98666,149042,45449,153577,14842,89493,93914,63147,183698,94089,21139,114176,107430,8173,80133,207538,280718,166877,133861,224847,204659,281959,4886,175872,262683,83466,228061,277832,242052,22820,121817,86464,174170,175787,257282,229055,15142,232520,146766};
static const uint32_t omega_1792_inv[1792]={1,187854,126947,174654,260656,157516,21305,278769,210804,240007,279715,297058,210126,222106,10894,197047,205817,436,16840,255461,282780,147527,35980,257270,217313,88159,176273,27655,62778,93608,198919,233929,111247,21226,190096,116872,290963,159767,196631,32316,176516,216570,203085,85493,15300,276078,170393,24268,235778,33515,222826,91181,77559,114871,114245,230928,241154,191441,193679,34302,244937,47546,248265,231326,43853,138771,161804,211782,15392,97340,108294,136415,131570,74251,75487,148084,203879,218354,258180,164077,4041,153317,292756,99206,213510,87658,292260,251292,168711,163690,160337,97119,138426,79429,68332,272219,187063,256591,11558,294505,202665,63747,285706,78249,279621,100088,18331,61708,195904,142336,9489,289166,71026,274078,181529,222376,153898,152239,96448,231275,97123,287728,286160,164834,110615,215013,40754,223463,234550,259522,279436,269710,15582,264874,143664,204405,282862,197648,209696,128162,216058,59020,116941,6381,188457,205477,255217,207068,181330,170498,180233,17648,7708,195519,72226,207185,183087,271504,142875,107643,72603,279748,174043,184579,265605,182946,277106,5711,168103,49061,47153,180608,15560,45827,60343,275758,268513,43923,42043,16384,94225,197892,285408,94359,81540,136057,15549,86832,169211,160906,110810,117589,108745,261552,183837,267328,219113,138348,178610,101347,196772,26714,12623,156110,226627,17031,8735,144040,89114,146871,237126,71770,45949,98199,108328,201254,232970,292404,207138,84602,25078,62676,200148,195776,181584,17351,211672,124385,282849,164002,64670,266116,139157,118711,141033,296125,157518,95956,231606,259055,159205,293690,38611,165550,41600,189851,154363,197819,119631,159995,277249,74760,258104,36852,290950,126121,51605,170270,99615,276261,227177,74180,285418,166557,146782,76255,213653,156707,81204,239083,111451,109203,196382,221562,177698,79932,26996,1419,129381,105707,64115,172868,130910,126095,285370,181275,74466,122459,45502,122364,262792,104679,228797,29033,16570,112457,26531,256896,106198,176987,185046,84779,158966,254077,105035,270167,63615,175652,180437,105625,13994,300209,260018,127350,13452,240607,95740,297837,234690,66066,289653,34596,79525,38896,115794,94655,291836,80244,232386,170416,130112,144989,136816,196774,101365,266517,204361,145825,31006,51345,99464,209665,24771,194442,63772,165144,241354,130116,294291,42490,293276,240818,294467,289581,56673,272108,108202,14096,193669,263161,179695,107348,50161,161451,131860,60594,161163,220168,228812,137330,114433,22754,22630,211180,124716,143724,35479,72200,139893,194092,246355,290130,227025,120787,257122,112165,266594,218383,286920,232856,252095,185916,43808,114937,169272,179834,27095,234488,52740,236204,279214,111988,132706,26982,80976,158465,69007,27615,75043,133697,137070,43627,132804,72197,178445,114308,23450,110276,55534,56872,22929,81867,148687,282409,298917,204592,187891,153234,54781,99600,167964,129314,163883,289319,212273,128264,109518,62163,169286,100277,299068,271188,89240,32972,276427,101013,73392,75453,83245,102479,201,126529,227559,182842,7938,49731,67507,35967,223624,72287,226113,99372,87346,86870,82295,167980,124408,87636,73213,167971,240064,149341,6612,230523,26648,258653,207204,139629,275041,149674,243195,54837,82429,51628,276114,8826,78505,201125,84364,173319,256047,178362,177390,23844,64730,97190,229552,60956,125429,113261,231590,263961,235452,208739,82913,53750,1777,245402,93126,271448,160046,223979,226860,133748,83800,195727,8448,119145,83222,297692,90990,23228,253611,172658,120037,261298,35927,235889,112376,164264,210127,108903,137841,70644,165416,157952,38145,233173,192527,86477,14638,253271,126382,9208,187167,224702,268595,94044,215759,188333,92970,168753,226076,73085,207219,247926,71847,59971,239294,9121,100947,18365,126547,297304,59432,141140,225684,193282,118400,123497,254075,30384,16273,15364,256454,166462,63015,58570,179658,81061,170034,21450,121412,253642,276049,141653,256546,288781,916,170717,75450,121797,22695,78353,247732,56068,118927,74802,19433,250657,99993,235621,44023,161909,66690,98319,71533,80987,117460,261196,142467,232746,60031,70368,99516,43192,2761,244740,70319,227437,144986,175368,116990,179517,86663,32870,81910,97870,21047,282614,273691,36768,166178,300625,132462,252327,114779,292983,293027,129007,295649,152943,181641,188034,222283,144782,87391,110704,74827,199928,112705,251545,128767,68182,92420,111604,250450,50568,149551,17485,95320,276091,204039,169294,97824,110416,163135,67089,88872,145810,223766,254539,189167,213566,70487,175924,97035,13654,253933,149189,53219,202227,273313,77408,48275,212896,50133,19508,190028,288251,88163,24518,234386,159280,233061,226869,18092,22095,262328,246953,31504,274967,97100,181884,75892,61533,136667,204829,152853,133973,202970,158387,168188,60630,300653,274405,194159,188179,64926,187620,123433,273699,34315,278583,192572,110311,7170,285219,114679,173117,242721,124913,120951,56307,158540,8378,215873,228642,114192,209547,136217,267546,227533,115550,18943,24582,214762,155349,271808,49661,164235,181387,40124,190844,38045,113307,142221,82383,140997,156635,103281,130609,180757,7505,295396,192887,277149,255951,207798,32758,116252,29485,28504,291671,93205,59064,253978,173023,45751,234175,261610,241317,103829,113107,203546,282828,132809,108296,211066,84407,122502,295742,162059,246489,173778,77674,41977,262414,145319,110894,242361,235298,180695,101780,252164,202391,72498,123783,91116,210386,292912,201901,147480,238552,10844,137114,180664,299446,230548,207143,120701,57699,32775,299200,80185,288109,206968,61464,120192,176139,144007,212129,172418,193627,200775,266947,298305,241718,169033,140221,93519,38048,74755,222005,4231,19794,27069,167196,63745,211055,125412,231370,180890,4356,19098,240480,21785,131589,30793,79024,154883,38374,200588,60861,41662,95576,197595,188315,23225,292163,92874,198189,81444,165493,171974,179240,133966,92220,172929,149838,42380,101212,125270,49118,217836,191219,35957,151426,7045,285915,202325,17471,174877,4118,167339,132794,301056,113203,174110,126403,40401,143541,279752,22288,90253,61050,21342,3999,90931,78951,290163,104010,95240,300621,284217,45596,18277,153530,265077,43787,83744,212898,124784,273402,238279,207449,102138,67128,189810,279831,110961,184185,10094,141290,104426,268741,124541,84487,97972,215564,285757,24979,130664,276789,65279,267542,78231,209876,223498,186186,186812,70129,59903,109616,107378,266755,56120,253511,52792,69731,257204,162286,139253,89275,285665,203717,192763,164642,169487,226806,225570,152973,97178,82703,42877,136980,297016,147740,8301,201851,87547,213399,8797,49765,132346,137367,140720,203938,162631,221628,232725,28838,113994,44466,289499,6552,98392,237310,15351,222808,21436,200969,282726,239349,105153,158721,291568,11891,230031,26979,119528,78681,147159,148818,204609,69782,203934,13329,14897,136223,190442,86044,260303,77594,66507,41535,21621,31347,285475,36183,157393,96652,18195,103409,91361,172895,84999,242037,184116,294676,112600,95580,45840,93989,119727,130559,120824,283409,293349,105538,228831,93872,117970,29553,158182,193414,228454,21309,127014,116478,35452,118111,23951,295346,132954,251996,253904,120449,285497,255230,240714,25299,32544,257134,259014,284673,206832,103165,15649,206698,219517,165000,285508,214225,131846,140151,190247,183468,192312,39505,117220,33729,81944,162709,122447,199710,104285,274343,288434,144947,74430,284026,292322,157017,211943,154186,63931,229287,255108,202858,192729,99803,68087,8653,93919,216455,275979,238381,100909,105281,119473,283706,89385,176672,18208,137055,236387,34941,161900,182346,160024,4932,143539,205101,69451,42002,141852,7367,262446,135507,259457,111206,146694,103238,181426,141062,23808,226297,42953,264205,10107,174936,249452,130787,201442,24796,73880,226877,15639,134500,154275,224802,87404,144350,219853,61974,189606,191854,104675,79495,123359,221125,274061,299638,171676,195350,236942,128189,170147,174962,15687,119782,226591,178598,255555,178693,38265,196378,72260,272024,284487,188600,274526,44161,194859,124070,116011,216278,142091,46980,196022,30890,237442,125405,120620,195432,287063,848,41039,173707,287605,60450,205317,3220,66367,234991,11404,266461,221532,262161,185263,206402,9221,220813,68671,130641,170945,156068,164241,104283,199692,34540,96696,155232,270051,249712,201593,91392,276286,106615,237285,135913,59703,170941,6766,258567,7781,60239,6590,11476,244384,28949,192855,286961,107388,37896,121362,193709,250896,139606,169197,240463,139894,80889,72245,163727,186624,278303,278427,89877,176341,157333,265578,228857,161164,106965,54702,10927,74032,180270,43935,188892,34463,82674,14137,68201,48962,115141,257249,186120,131785,121223,273962,66569,248317,64853,21843,189069,168351,274075,220081,142592,232050,273442,226014,167360,163987,257430,168253,228860,122612,186749,277607,190781,245523,244185,278128,219190,152370,18648,2140,96465,113166,147823,246276,201457,133093,171743,137174,11738,88784,172793,191539,238894,131771,200780,1989,29869,211817,268085,24630,200044,227665,225604,217812,198578,300856,174528,73498,118215,293119,251326,233550,265090,77433,228770,74944,201685,213711,214187,218762,133077,176649,213421,227844,133086,60993,151716,294445,70534,274409,42404,93853,161428,26016,151383,57862,246220,218628,249429,24943,292231,222552,99932,216693,127738,45010,122695,123667,277213,236327,203867,71505,240101,175628,187796,69467,37096,65605,92318,218144,247307,299280,55655,207931,29609,141011,77078,74197,167309,217257,105330,292609,181912,217835,3365,210067,277829,47446,128399,181020,39759,265130,65168,188681,136793,90930,192154,163216,230413,135641,143105,262912,67884,108530,214580,286419,47786,174675,291849,113890,76355,32462,207013,85298,112724,208087,132304,74981,227972,93838,53131,229210,241086,61763,291936,200110,282692,174510,3753,241625,159917,75373,107775,182657,177560,46982,270673,284784,285693,44603,134595,238042,242487,121399,219996,131023,279607,179645,47415,25008,159404,44511,12276,300141,130340,225607,179260,278362,222704,53325,244989,182130,226255,281624,50400,201064,65436,257034,139148,234367,202738,229524,220070,183597,39861,158590,68311,241026,230689,201541,257865,298296,56317,230738,73620,156071,125689,184067,121540,214394,268187,219147,203187,280010,18443,27366,264289,134879,432,168595,48730,186278,8074,8030,172050,5408,148114,119416,113023,78774,156275,213666,190353,226230,101129,188352,49512,172290,232875,208637,189453,50607,250489,151506,283572,205737,24966,97018,131763,203233,190641,137922,233968,212185,155247,77291,46518,111890,87491,230570,125133,204022,287403,47124,151868,247838,98830,27744,223649,252782,88161,250924,281549,111029,12806,212894,276539,66671,141777,67996,74188,282965,278962,38729,54104,269553,26090,203957,119173,225165,239524,164390,96228,148204,167084,98087,142670,132869,240427,404,26652,106898,112878,236131,113437,177624,27358,266742,22474,108485,190746,293887,15838,186378,127940,58336,176144,180106,244750,142517,292679,85184,72415,186865,91510,164840,33511,73524,185507,282114,276475,86295,145708,29249,251396,136822,119670,260933,110213,263012,187750,158836,218674,160060,144422,197776,170448,120300,293552,5661,108170,23908,45106,93259,268299,184805,271572,272553,9386,207852,241993,47079,128034,255306,66882,39447,59740,197228,187950,97511,18229,168248,192761,89991,216650,178555,5315,138998,54568,127279,223383,259080,38643,155738,190163,58696,65759,120362,199277,48893,98666,228559,177274,209941,90671,8145,99156,153577,62505,290213,163943,120393,1611,70509,93914,180356,243358,268282,1857,220872,12948,94089,239593,180865,124918,157050,88928,128639,107430,100282,34110,2752,59339,132024,160836,207538,263009,226302,79052,296826,281263,273988,133861,237312,90002,175645,69687,120167,296701,281959,60577,279272,169468,270264,222033,146174,262683,100469,240196,259395,205481,103462,112742,277832,8894,208183,102868,219613,135564,129083,121817,167091,208837,128128,151219,258677,199845,175787,251939,83221,109838,265100,149631,294012,15142,98732,283586,126180,296939,133718,168263};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = barrett_4q2((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = barrett_4q2((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n)
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = barrett_2q2((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 5*256-->8*256 */
static void ntt_butterfly_1280_2048(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f;
	
	b = a[n2];
	c = a[N2_2048 + n2];
	d = a[N2_2048 * 2 + n2];
	e = a[N2_2048 * 3 + n2];
	f = a[N2_2048 * 4 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f);
	a[N2_2048 + n2] = (b + c * w_8[0][0] + d * w_8[0][1] + e * w_8[0][2] + f * w_8[0][3]) % Q;
	a[N2_2048 * 2 + n2] = (b + c * w_8[1][0] + d * w_8[1][1] + e * w_8[1][2] + f * w_8[1][3]) % Q;
	a[N2_2048 * 3 + n2] = (b + c * w_8[2][0] + d * w_8[2][1] + e * w_8[2][2] + f * w_8[2][3]) % Q;
	a[N2_2048 * 4 + n2] = (b + c * w_8[3][0] + d * w_8[3][1] + e * w_8[3][2] + f * w_8[3][3]) % Q;
	a[N2_2048 * 5 + n2] = (b + c * w_8[4][0] + d * w_8[4][1] + e * w_8[4][2] + f * w_8[4][3]) % Q;
	a[N2_2048 * 6 + n2] = (b + c * w_8[5][0] + d * w_8[5][1] + e * w_8[5][2] + f * w_8[5][3]) % Q;
	a[N2_2048 * 7 + n2] = (b + c * w_8[6][0] + d * w_8[6][1] + e * w_8[6][2] + f * w_8[6][3]) % Q;
}

/* 8*256-->3*256 */
static void ntt_butterfly_2048_768(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i;
	
	b = a[n2];
	c = a[N2_2048 + n2];
	d = a[N2_2048 * 2 + n2];
	e = a[N2_2048 * 3 + n2];
	f = a[N2_2048 * 4 + n2];
	g = a[N2_2048 * 5 + n2];
	h = a[N2_2048 * 6 + n2];
	i = a[N2_2048 * 7 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h + i);
	a[N2_2048 + n2] = (b + c * w_8[0][0] + d * w_8[0][1] + e * w_8[0][2] + f * w_8[0][3] + g * w_8[0][4] + h * w_8[0][5] + i * w_8[0][6]) % Q;
	a[N2_2048 * 2 + n2] = (b + c * w_8[1][0] + d * w_8[1][1] + e * w_8[1][2] + f * w_8[1][3] + g * w_8[1][4] + h * w_8[1][5] + i * w_8[1][6]) % Q;
}

/* 2*256-->7*256 */
static void ntt_butterfly_512_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_1792 + n2] = (b + c * w_7[0][0]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0]) % Q;
}

/* 5*256-->7*256 */
static void ntt_butterfly_1280_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2] + f * w_7[0][3]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2] + f * w_7[1][3]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0] + d * w_7[2][1] + e * w_7[2][2] + f * w_7[2][3]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0] + d * w_7[3][1] + e * w_7[3][2] + f * w_7[3][3]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0] + d * w_7[4][1] + e * w_7[4][2] + f * w_7[4][3]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0] + d * w_7[5][1] + e * w_7[5][2] + f * w_7[5][3]) % Q;
}

/* 7*256-->7*256 */
static void ntt_butterfly_1792_1792_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	g = a[N2_1792 * 5 + n2];
	h = a[N2_1792 * 6 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h);
	a[N2_1792 + n2] = (b + c * w_7_inv[0][0] + d * w_7_inv[0][1] + e * w_7_inv[0][2] + f * w_7_inv[0][3] + g * w_7_inv[0][4] + h * w_7_inv[0][5]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7_inv[1][0] + d * w_7_inv[1][1] + e * w_7_inv[1][2] + f * w_7_inv[1][3] + g * w_7_inv[1][4] + h * w_7_inv[1][5]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7_inv[2][0] + d * w_7_inv[2][1] + e * w_7_inv[2][2] + f * w_7_inv[2][3] + g * w_7_inv[2][4] + h * w_7_inv[2][5]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7_inv[3][0] + d * w_7_inv[3][1] + e * w_7_inv[3][2] + f * w_7_inv[3][3] + g * w_7_inv[3][4] + h * w_7_inv[3][5]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7_inv[4][0] + d * w_7_inv[4][1] + e * w_7_inv[4][2] + f * w_7_inv[4][3] + g * w_7_inv[4][4] + h * w_7_inv[4][5]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7_inv[5][0] + d * w_7_inv[5][1] + e * w_7_inv[5][2] + f * w_7_inv[5][3] + g * w_7_inv[5][4] + h * w_7_inv[5][5]) % Q;
}

/* 3*256-->3*256 */
static void ntt_butterfly_768_768_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_768 + n2];
	d = a[N2_768 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_768 + n2] = (b + c * w_3_inv[0] + d * w_3_inv[1]) % Q;
	a[N2_768 * 2 + n2] = (b + c * w_3_inv[1] + d * w_3_inv[0]) % Q;
}

/* 2*256-->3*256 */
static void ntt_butterfly_512_768(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_768 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_768 + n2] = (b + c * w_3[0]) % Q;
	a[N2_768 * 2 + n2] = (b + c * w_3[1]) % Q;
}

/* 3*256-->1*256 */
static void ntt_butterfly_768_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_8q(a[n2] + a[N2_768 + n2] + a[N2_768 * 2 + n2]);
}

/* 7*256-->8*256 */
static void ntt_butterfly_1792_2048(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h;
	
	b = a[n2];
	c = a[N2_2048 + n2];
	d = a[N2_2048 * 2 + n2];
	e = a[N2_2048 * 3 + n2];
	f = a[N2_2048 * 4 + n2];
	g = a[N2_2048 * 5 + n2];
	h = a[N2_2048 * 6 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h);
	a[N2_2048 + n2] = (b + c * w_8[0][0] + d * w_8[0][1] + e * w_8[0][2] + f * w_8[0][3] + g * w_8[0][4] + h * w_8[0][5]) % Q;
	a[N2_2048 * 2 + n2] = (b + c * w_8[1][0] + d * w_8[1][1] + e * w_8[1][2] + f * w_8[1][3] + g * w_8[1][4] + h * w_8[1][5]) % Q;
	a[N2_2048 * 3 + n2] = (b + c * w_8[2][0] + d * w_8[2][1] + e * w_8[2][2] + f * w_8[2][3] + g * w_8[2][4] + h * w_8[2][5]) % Q;
	a[N2_2048 * 4 + n2] = (b + c * w_8[3][0] + d * w_8[3][1] + e * w_8[3][2] + f * w_8[3][3] + g * w_8[3][4] + h * w_8[3][5]) % Q;
	a[N2_2048 * 5 + n2] = (b + c * w_8[4][0] + d * w_8[4][1] + e * w_8[4][2] + f * w_8[4][3] + g * w_8[4][4] + h * w_8[4][5]) % Q;
	a[N2_2048 * 6 + n2] = (b + c * w_8[5][0] + d * w_8[5][1] + e * w_8[5][2] + f * w_8[5][3] + g * w_8[5][4] + h * w_8[5][5]) % Q;
	a[N2_2048 * 7 + n2] = (b + c * w_8[6][0] + d * w_8[6][1] + e * w_8[6][2] + f * w_8[6][3] + g * w_8[6][4] + h * w_8[6][5]) % Q;
}

/* 8*256-->1*256 */
static void ntt_butterfly_2048_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_16q(a[n2] + a[N2_2048 + n2] + a[N2_2048 * 2 + n2] + a[N2_2048 * 3 + n2] + a[N2_2048 * 4 + n2] + a[N2_2048 * 5 + n2] + a[N2_2048 * 6 + n2] + a[N2_2048 * 7 + n2]);	
}

void ntt_1280_2048(uint32_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1280_2048);
}

void intt_2048_768(uint32_t *a)
{
	intt_core(a, N1_2048, N2_2048, 768, omega_256, omega_2048, ntt_butterfly_2048_768, INV_2048);
}

void ntt_512_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_512_1792);
}

void ntt_1280_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1280_1792);
}

void intt_1792_1792_inv(uint32_t *a)
{
	intt_core(a, N1_1792, N2_1792, 1792, omega_256_inv, omega_1792_inv, ntt_butterfly_1792_1792_inv, INV_1792);
}

void ntt_768_768_inv(uint32_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256_inv, omega_768_inv, ntt_butterfly_768_768_inv);
}

void ntt_512_768(uint32_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256, omega_768, ntt_butterfly_512_768);
}

void intt_768_256(uint32_t *a)
{
	intt_core(a, N1_768, N2_768, 256, omega_256, omega_768, ntt_butterfly_768_256, INV_768);
}

void ntt_1792_2048(uint32_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1792_2048);
}

void intt_2048_256(uint32_t *a)
{
	intt_core(a, N1_2048, N2_2048, 256, omega_256, omega_2048, ntt_butterfly_2048_256, INV_2048);
}
