/* ****************************** *
 * Titanium_CPA_std               *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 768=3*256 */
#define N1_768 3
#define N2_768 256

/* 1536=3*512 */
#define N1_1536 3
#define N2_1536 512

/* 1792=7*256 */
#define N1_1792 7
#define N2_1792 256

/* multiplication inverses of 768, 1536, 1792 */
#define INV_768 85905
#define INV_1536 85961
#define INV_1792 85969

/* omega_n: n-th root of unity mod Q */

/* [omega_3^1, omega_3^2] */
static const uint32_t w_3[2]={40648,45368};

/* [omega_3^-1, omega_3^-2] */
static const uint32_t w_3_inv[2]={45368,40648};

/* [omega_7^1,   omega_7^2,  omega_7^3,   omega_7^4,   omega_7^5,  omega_7^6]
 * [omega_7^2,   omega_7^4,  omega_7^6,   omega_7^8,  omega_7^10, omega_7^12]
 * [omega_7^3,   omega_7^6,  omega_7^9,  omega_7^12,  omega_7^15, omega_7^18]
 * [omega_7^4,   omega_7^8, omega_7^12,  omega_7^16,  omega_7^20, omega_7^24]
 * [omega_7^5,  omega_7^10, omega_7^15,  omega_7^20,  omega_7^25, omega_7^30]
 * [omega_7^6,  omega_7^12, omega_7^18,  omega_7^24,  omega_7^30, omega_7^36] */
static const uint32_t w_7[6][6]={{3429,59729,4264,84383,74136,32109},
{59729,84383,32109,3429,4264,74136},
{4264,32109,59729,74136,3429,84383},
{84383,3429,74136,59729,32109,4264},
{74136,4264,3429,32109,84383,59729},
{32109,74136,84383,4264,59729,3429}};

/* omega_256,512,768,1536,1792, respectively */
static const uint32_t omega_256[128]={1,12544,26843,48054,68257,2590,60551,21634,79278,20695,84791,18099,34993,7441,11459,7289,83162,55969,4382,2945,40787,3012,21065,81153,58054,9454,59550,23572,46739,2144,57032,6019,65427,28091,47872,21691,20133,2440,71325,37983,10589,18168,40359,53251,58539,72104,3821,19155,34839,54056,6453,4435,65658,1177,55381,25972,46389,84628,37835,46451,2186,67778,15204,19287,56324,70635,70340,68591,63470,80345,72508,82611,25585,8813,18427,20609,38211,32060,31165,72512,46770,46940,28995,33404,30969,22364,32579,4209,69275,41866,33319,82950,63168,76805,51520,21159,56051,786,53646,24433,8981,61411,57349,25685,58975,36200,9057,68568,33009,65075,85487,61006,52032,78429,36947,3572,78328,60258,44973,41826,47661,41434,33382,13052,33937,7595,50861,12295};
static const uint32_t omega_512[256]={1,112,12544,28656,26843,81838,48054,48994,68257,75288,2590,32029,60551,72386,21634,14532,79278,19385,20695,81398,84791,34722,18099,48697,34993,48451,7441,59239,11459,79170,7289,42215,83162,24308,55969,75304,4382,60699,2945,71789,40787,9243,3012,79293,21065,36821,81153,57351,58054,50773,9454,26644,59550,46291,23572,59554,46739,73748,2144,68094,57032,22326,6019,72009,65427,16379,28091,49580,47872,28610,21691,20916,20133,18454,2440,15229,71325,74836,37983,39263,10589,67747,18168,56425,40359,47324,53251,28939,58539,19076,72104,76067,3821,83884,19155,80952,34839,31203,54056,33082,6453,34600,4435,66635,65658,42251,1177,45807,55381,9448,25972,70303,46389,34548,84628,16466,37835,22687,46451,41492,2186,72798,67778,21640,15204,68525,19287,9719,56324,29047,70635,83573,70340,50533,68591,26679,63470,55246,80345,52872,72508,35298,82611,48613,25585,26959,8813,40869,18427,85433,20609,71766,38211,64799,32060,64023,31165,49800,72512,35746,46770,77220,46940,10243,28995,64811,33404,42517,30969,27848,22364,10275,32579,36134,4209,41323,69275,17270,41866,44074,33319,32997,82950,564,63168,21422,76805,460,51520,7101,21159,47349,56051,84488,786,2015,53646,73179,24433,69969,8981,59685,61411,82689,57349,57830,25685,38159,58975,67908,36200,11601,9057,68197,68568,24103,33009,84294,65075,62972,85487,26657,61006,37329,52032,64445,78429,10314,36947,9248,3572,55996,78328,85019,60258,39570,44973,47990,41826,39594,47661,4978,41434,81707,33382,40053,13052,85552,33937,16196,7595,76487,50861,19310,12295,768};
static const uint32_t omega_768[768]={1,71157,13961,12544,81016,82189,26843,59866,65071,48054,30694,35311,68257,13444,39651,2590,48216,31850,60551,35977,63452,21634,50306,26587,79278,17752,19419,20695,69092,77809,84791,68773,1197,18099,24019,48210,34993,62802,46730,7441,44602,61282,11459,32920,73496,7289,66880,3618,83162,18919,53233,55969,85050,4781,4382,84366,19015,2945,19953,85036,40787,66979,80784,3012,56537,74236,21065,75980,82359,81153,24760,47126,58054,68070,39720,9454,65338,37216,59550,29896,23245,23572,67321,73667,46739,45735,84234,2144,52467,84485,57032,29981,50400,6019,15340,78667,65427,4931,11824,28091,8241,26948,47872,68687,74919,21691,63456,48211,20133,76763,59274,2440,40774,2108,71325,11974,35533,37983,16174,71875,10589,58570,55823,18168,30883,65332,40359,61801,40649,53251,46540,78297,58539,381,15462,72104,48329,73010,3821,77177,14441,19155,72970,82119,34839,28783,47161,54056,40603,48675,6453,17375,30534,4435,70939,70812,65658,12951,54186,1177,57248,2850,55381,48996,53345,25972,14359,33437,46389,85715,14836,84628,82477,48013,37835,65029,70055,46451,24565,20248,2186,30466,68728,67778,77990,61658,15204,35219,59105,19287,3824,32597,56324,56787,57967,70635,29351,36347,70340,26184,46668,68591,39190,57707,63470,12205,43553,80345,75277,34865,72508,66079,36132,82611,35164,16235,25585,2040,49601,8813,42711,33983,18427,52908,68517,20609,56797,81401,38211,68774,72354,32060,36563,43209,31165,3628,20579,72512,6639,5959,46770,15160,923,46940,69470,51834,28995,79470,3193,33404,20667,55087,30969,77627,36767,22364,40648,68111,32579,65753,63540,4209,74636,12238,69275,24956,59144,41866,32201,5711,33319,79529,72640,82950,72627,18079,63168,27041,42164,76805,37273,72700,51520,50117,82583,21159,55412,18421,56051,70768,31362,786,18352,49187,53646,25996,1787,24433,3377,51708,8981,40724,56972,61411,72910,27532,57349,50296,3153,25685,64346,69429,58975,58713,81268,36200,18318,38325,9057,29585,85804,68568,36902,80672,33009,41211,45580,65075,74631,521,85487,48253,84149,61006,70020,50449,52032,11293,5187,78429,75410,36876,36947,14091,59135,3572,78586,64849,78328,27964,3087,60258,3090,15678,44973,53310,29970,41826,24482,49390,47661,21518,53726,41434,446,81766,33382,3519,5996,13052,15615,34966,33937,13851,12821,7595,78621,60851,50861,36919,86,12295,82425,46580,86016,14860,72056,73473,5001,3828,59174,26151,20946,37963,55323,50706,17760,72573,46366,83427,37801,54167,25466,50040,22565,64383,35711,59430,6739,68265,66598,65322,16925,8208,1226,17244,84820,67918,61998,37807,51024,23215,39287,78576,41415,24735,74558,53097,12521,78728,19137,82399,2855,67098,32784,30048,967,81236,81635,1651,67002,83072,66064,981,45230,19038,5233,83005,29480,11781,64952,10037,3658,4864,61257,38891,27963,17947,46297,76563,20679,48801,26467,56121,62772,62445,18696,12350,39278,40282,1783,83873,33550,1532,28985,56036,35617,79998,70677,7350,20590,81086,74193,57926,77776,59069,38145,17330,11098,64326,22561,37806,65884,9254,26743,83577,45243,83909,14692,74043,50484,48034,69843,14142,75428,27447,30194,67849,55134,20685,45658,24216,45368,32766,39477,7720,27478,85636,70555,13913,37688,13007,82196,8840,71576,66862,13047,3898,51178,57234,38856,31961,45414,37342,79564,68642,55483,81582,15078,15205,20359,73066,31831,84840,28769,83167,30636,37021,32672,60045,71658,52580,39628,302,71181,1389,3540,38004,48182,20988,15962,39566,61452,65769,83831,55551,17289,18239,8027,24359,70813,50798,26912,66730,82193,53420,29693,29230,28050,15382,56666,49670,15677,59833,39349,17426,46827,28310,22547,73812,42464,5672,10740,51152,13509,19938,49885,3406,50853,69782,60432,83977,36416,77204,43306,52034,67590,33109,17500,65408,29220,4616,47806,17243,13663,53957,49454,42808,54852,82389,65438,13505,79378,80058,39247,70857,85094,39077,16547,34183,57022,6547,82824,52613,65350,30930,55048,8390,49250,63653,45369,17906,53438,20264,22477,81808,11381,73779,16742,61061,26873,44151,53816,80306,52698,6488,13377,3067,13390,67938,22849,58976,43853,9212,48744,13317,34497,35900,3434,64858,30605,67596,29966,15249,54655,85231,67665,36830,32371,60021,84230,61584,82640,34309,77036,45293,29045,24606,13107,58485,28668,35721,82864,60332,21671,16588,27042,27304,4749,49817,67699,47692,76960,56432,213,17449,49115,5345,53008,44806,40437,20942,11386,85496,530,37764,1868,25011,15997,35568,33985,74724,80830,7588,10607,49141,49070,71926,26882,82445,7431,21168,7689,58053,82930,25759,82927,70339,41044,32707,56047,44191,61535,36627,38356,64499,32291,44583,85571,4251,52635,82498,80021,72965,70402,51051,52080,72166,73196,78422,7396,25166,35156,49098,85931,73722,3592,39437};
static const uint32_t omega_1536[1536]={1,30077,71157,112,13961,56020,12544,15326,81016,28656,82189,42007,26843,1349,59866,81838,65071,81683,48054,62524,30694,48994,35311,83065,68257,84067,13444,75288,39651,43439,2590,54045,48216,32029,31850,67138,60551,40503,35977,72386,63452,72642,21634,53230,50306,14532,26587,43167,79278,53166,17752,19385,19419,9833,20695,24503,69092,81398,77809,82791,84791,26891,68773,34722,1197,47063,18099,48047,24019,48697,48210,23601,34993,66466,62802,48451,46730,66447,7441,72740,44602,59239,61282,6438,11459,68241,32920,79170,73496,74326,7289,59937,66880,42215,3618,7081,83162,61148,18919,24308,53233,54520,55969,26923,85050,75304,4781,63730,4382,19370,84366,60699,19015,73139,2945,65272,19953,71789,85036,84311,40787,62162,66979,9243,80784,18169,3012,16023,56537,79293,74236,52903,21065,56800,75980,36821,82359,80094,81153,20389,24760,57351,47126,20576,58054,31075,68070,50773,39720,54344,9454,61773,65338,26644,37216,6411,59550,39376,29896,46291,23245,79706,23572,22930,67321,59554,73667,56473,46739,79089,45735,73748,84234,47317,2144,58355,52467,68094,84485,27148,57032,450,29981,22326,50400,3209,6019,53695,15340,72009,78667,83757,65427,36970,4931,16379,11824,36170,28091,34033,8241,49580,26948,62822,47872,7581,68687,28610,74919,37431,21691,47279,63456,20916,48211,53678,20133,66578,76763,18454,59274,81773,2440,15379,40774,15229,2108,7787,71325,64062,11974,74836,35533,50833,37983,22914,16174,39263,71875,5131,10589,50419,58570,67747,55823,22548,18168,58952,30883,56425,65332,18216,40359,5739,61801,47324,40649,40352,53251,79804,46540,28939,78297,51460,58539,81547,381,19076,15462,42672,72104,11404,48329,76067,73010,79794,3821,5505,77177,83884,14441,42124,19155,69086,72970,80952,82119,1025,34839,79526,28783,31203,47161,41067,54056,34995,40603,33082,48675,74652,6453,32529,17375,34600,30534,53626,4435,65145,70939,66635,70812,31604,65658,17380,12951,42251,54186,74240,1177,47642,57248,45807,2850,46518,55381,61149,48996,9448,53345,68481,25972,39467,14359,70303,33437,59902,46389,46213,85715,34548,14836,52193,84628,27309,82477,16466,48013,33605,37835,44402,65029,22687,70055,57820,46451,18613,24565,41492,20248,84753,2186,31334,30466,72798,68728,57529,67778,42023,77990,21640,61658,47163,15204,24336,35219,68525,59105,73763,19287,82468,3824,9719,32597,84220,56324,38150,56787,29047,57967,80903,70635,41029,29351,83573,36347,18666,70340,28065,26184,50533,46668,8030,68591,65796,39190,26679,57707,2413,63470,11909,12205,55246,43553,76705,80345,60984,75277,52872,34865,1358,72508,34115,66079,35298,36132,3386,82611,3985,35164,48613,16235,67603,25585,11963,2040,26959,49601,56446,8813,50224,42711,40869,33983,52697,18427,21348,52908,85433,68517,76540,20609,18391,56797,71766,81401,82023,38211,85127,68774,64799,72354,47175,32060,18050,36563,64023,43209,52257,31165,22456,3628,49800,20579,62268,72512,68406,6639,35746,5959,55432,46770,65289,15160,77220,923,63597,46940,17359,69470,10243,51834,39110,28995,42269,79470,64811,3193,40889,33404,13548,20667,42517,55087,78262,30969,62537,77627,27848,36767,6507,22364,75105,40648,10275,68111,79692,32579,58936,65753,36134,63540,52891,4209,63086,74636,41323,12238,15583,69275,80401,24956,17270,59144,42528,41866,819,32201,44074,5711,79815,33319,37513,79529,32997,72640,47497,82950,50082,72627,564,18079,48626,63168,46457,27041,21422,42164,17997,76805,77450,37273,460,72700,45760,51520,56802,50117,7101,82583,21999,21159,45477,55412,47349,18421,12920,56051,84761,70768,84488,31362,12452,786,71864,18352,2015,49187,77033,53646,3856,25996,73179,1787,72991,24433,28110,3377,69969,51708,34156,8981,28157,40724,59685,56972,2187,61411,15606,72910,82689,27532,80322,57349,72989,50296,57830,3153,42047,25685,9068,64346,38159,69429,67341,58975,34518,58713,67908,81268,38564,36200,70231,18318,11601,38325,73225,9057,77567,29585,68197,85804,44874,68568,62161,36902,24103,80672,4208,33009,3479,41211,84294,45580,56731,65075,29957,74631,62972,521,15023,85487,58352,48253,26657,84149,71282,61006,48835,70020,37329,50449,14693,52032,59183,11293,64445,5187,60578,78429,64842,75410,10314,36876,16254,36947,1296,14091,9248,59135,29886,3572,85828,78586,55996,64849,27898,78328,37660,27964,85019,3087,35356,60258,1676,3090,39570,15678,2012,44973,35596,53310,47990,29970,35547,41826,1977,24482,39594,49390,75457,47661,26592,21518,4978,53726,1540,41434,82139,446,81707,81766,49952,33382,39990,3519,40053,5996,50060,13052,69433,15615,85552,34966,28540,33937,45427,13851,16196,12821,3006,7595,59680,78621,76487,60851,31818,50861,19969,36919,19310,86,6112,12295,9632,82425,768,46580,27781,86016,55940,14860,85905,72056,29997,73473,70691,5001,57361,3828,44010,59174,84668,26151,4179,20946,4334,37963,23493,55323,37023,50706,2952,17760,1950,72573,10729,46366,42578,83427,31972,37801,53988,54167,18879,25466,45514,50040,13631,22565,13375,64383,32787,35711,71485,59430,42850,6739,32851,68265,66632,66598,76184,65322,61514,16925,4619,8208,3226,1226,59126,17244,51295,84820,38954,67918,37970,61998,37320,37807,62416,51024,19551,23215,37566,39287,19570,78576,13277,41415,26778,24735,79579,74558,17776,53097,6847,12521,11691,78728,26080,19137,43802,82399,78936,2855,24869,67098,61709,32784,31497,30048,59094,967,10713,81236,22287,81635,66647,1651,25318,67002,12878,83072,20745,66064,14228,981,1706,45230,23855,19038,76774,5233,67848,83005,69994,29480,6724,11781,33114,64952,29217,10037,49196,3658,5923,4864,65628,61257,28666,38891,65441,27963,54942,17947,35244,46297,31673,76563,24244,20679,59373,48801,79606,26467,46641,56121,39726,62772,6311,62445,63087,18696,26463,12350,29544,39278,6928,40282,12269,1783,38700,83873,27662,33550,17923,1532,58869,28985,85567,56036,63691,35617,82808,79998,32322,70677,14008,7350,2260,20590,49047,81086,69638,74193,49847,57926,51984,77776,36437,59069,23195,38145,78436,17330,57407,11098,48586,64326,38738,22561,65101,37806,32339,65884,19439,9254,67563,26743,4244,83577,70638,45243,70788,83909,78230,14692,21955,74043,11181,50484,35184,48034,63103,69843,46754,14142,80886,75428,35598,27447,18270,30194,63469,67849,27065,55134,29592,20685,67801,45658,80278,24216,38693,45368,45665,32766,6213,39477,57078,7720,34557,27478,4470,85636,66941,70555,43345,13913,74613,37688,9950,13007,6223,82196,80512,8840,2133,71576,43893,66862,16931,13047,5065,3898,84992,51178,6491,57234,54814,38856,44950,31961,51022,45414,52935,37342,11365,79564,53488,68642,51417,55483,32391,81582,20872,15078,19382,15205,54413,20359,68637,73066,43766,31831,11777,84840,38375,28769,40210,83167,39499,30636,24868,37021,76569,32672,17536,60045,46550,71658,15714,52580,26115,39628,39804,302,51469,71181,33824,1389,58708,3540,69551,38004,52412,48182,41615,20988,63330,15962,28197,39566,67404,61452,44525,65769,1264,83831,54683,55551,13219,17289,28488,18239,43994,8027,64377,24359,38854,70813,61681,50798,17492,26912,12254,66730,3549,82193,76298,53420,1797,29693,47867,29230,56970,28050,5114,15382,44988,56666,2444,49670,67351,15677,57952,59833,35484,39349,77987,17426,20221,46827,59338,28310,83604,22547,74108,73812,30771,42464,9312,5672,25033,10740,33145,51152,84659,13509,51902,19938,50719,49885,82631,3406,82032,50853,37404,69782,18414,60432,74054,83977,59058,36416,29571,77204,35793,43306,45148,52034,33320,67590,64669,33109,584,17500,9477,65408,67626,29220,14251,4616,3994,47806,890,17243,21218,13663,38842,53957,67967,49454,21994,42808,33760,54852,63561,82389,36217,65438,23749,13505,17611,79378,50271,80058,30585,39247,20728,70857,8797,85094,22420,39077,68658,16547,75774,34183,46907,57022,43748,6547,21206,82824,45128,52613,72469,65350,43500,30930,7755,55048,23480,8390,58169,49250,79510,63653,10912,45369,75742,17906,6325,53438,27081,20264,49883,22477,33126,81808,22931,11381,44694,73779,70434,16742,5616,61061,68747,26873,43489,44151,85198,53816,41943,80306,6202,52698,48504,6488,53020,13377,38520,3067,35935,13390,85453,67938,37391,22849,39560,58976,64595,43853,68020,9212,8567,48744,85557,13317,40257,34497,29215,35900,78916,3434,64018,64858,40540,30605,38668,67596,73097,29966,1256,15249,1529,54655,73565,85231,14153,67665,84002,36830,8984,32371,82161,60021,12838,84230,13026,61584,57907,82640,16048,34309,51861,77036,57860,45293,26332,29045,83830,24606,70411,13107,3328,58485,5695,28668,13028,35721,28187,82864,43970,60332,76949,21671,47858,16588,18676,27042,51499,27304,18109,4749,47453,49817,15786,67699,74416,47692,12792,76960,8450,56432,17820,213,41143,17449,23856,49115,61914,5345,81809,53008,82538,44806,1723,40437,29286,20942,56060,11386,23045,85496,70994,530,27665,37764,59360,1868,14735,25011,37182,15997,48688,35568,71324,33985,26834,74724,21572,80830,25439,7588,21175,10607,75703,49141,69763,49070,84721,71926,76769,26882,56131,82445,189,7431,30021,21168,58119,7689,48357,58053,998,82930,50661,25759,84341,82927,46447,70339,84005,41044,50421,32707,38027,56047,50470,44191,84040,61535,46423,36627,10560,38356,59425,64499,81039,32291,84477,44583,3878,85571,4310,4251,36065,52635,46027,82498,45964,80021,35957,72965,16584,70402,465,51051,57477,52080,40590,72166,69821,73196,83011,78422,26337,7396,9530,25166,54199,35156,66048,49098,66707,85931,79905,73722,76385,3592,85249,39437,58236};
static const uint32_t omega_1792[1792]={1,35007,5850,70490,73751,1002,68095,12544,11023,9899,57817,19709,10606,34870,26843,43193,50525,47121,16838,59382,12835,48054,77926,12344,63017,44137,66605,64433,68257,6556,12536,75035,49116,9999,31820,2590,6212,12508,41026,57350,14670,31200,60551,77943,5344,76450,38229,30117,81467,21634,47770,27893,71284,85818,984,40088,79278,32458,58653,39781,84254,42865,8490,20695,34691,39831,28247,77314,6293,9514,84791,3901,53328,26345,71158,61803,38037,18099,76488,78240,80383,7543,71628,85846,34993,31854,74607,33078,692,54067,5401,7441,27611,5248,70441,78748,58420,54765,11459,47942,27907,45280,81701,41657,40398,7289,39601,62235,22069,50806,78150,26365,83162,6769,71565,30830,10511,63868,73212,55969,11557,37948,85105,71940,83871,53836,4382,32363,1634,133,11013,3897,85334,2945,47249,24850,34029,3770,26312,34148,40787,34326,78809,43422,67547,10499,73869,3012,70259,72732,25924,42118,7429,37612,21065,84731,53906,46396,11778,32965,1683,81153,39612,17227,402,52043,29241,37387,58054,58736,20784,53702,44379,22616,17844,9454,48779,82986,38761,74169,11038,18902,59550,44855,84667,49900,16064,59319,43836,23572,23923,10949,85908,55002,50486,58120,46739,62816,61124,8976,2731,39230,63205,2144,48184,69935,84708,22898,83880,24831,57032,64654,63274,9151,21749,30776,12507,6019,51500,30197,43466,59549,9848,78817,65427,28330,58317,61758,11028,12900,1050,28091,35293,39880,23250,19896,19623,10599,47872,71910,65865,50370,40107,56275,57591,21691,64778,17275,46415,74792,58098,50738,20133,58650,20777,66704,3429,45288,17689,2440,2199,81195,47617,4876,36404,52973,71325,58816,68800,5600,6457,73540,11987,37983,20095,18639,56528,54611,39452,7212,10589,41870,13410,49101,996,30087,63461,18168,83495,51805,41224,21359,54749,53466,40359,18288,69502,65669,70358,11728,2955,53251,83350,50793,53144,36332,26962,80210,58539,5765,19473,6586,30542,78501,13391,72104,61880,67049,38464,85147,79945,71520,3821,5312,74447,23063,10879,43894,75587,19155,56570,62616,27101,43214,11519,83954,34839,59847,33877,15760,83299,71793,12845,54056,50409,29108,26374,54157,59419,17839,6453,19529,74604,14074,69159,14631,42199,4435,81377,53633,37372,49051,57003,81655,65658,29349,33395,1718,16143,72328,75901,1177,1096,4090,46342,13774,61133,65988,55381,71521,38828,11162,58920,10797,11881,25972,2114,30178,66469,34416,46810,53820,46389,24780,78032,24355,80998,32598,56664,84628,60899,45965,62753,6108,70511,34745,37835,79,13009,32065,63622,63190,79158,46451,44789,10647,7868,8642,8705,63721,2186,56189,57584,34693,23828,39947,46260,67778,11518,48947,28989,75374,46143,14758,15204,59249,1822,44157,78609,9399,15768,19287,32576,60663,41945,58425,57766,40709,56324,52594,50290,78108,18360,9496,56784,70635,74763,75099,53122,40331,70296,77736,70340,69738,69689,74686,46087,32757,31672,68591,582,74062,50037,81088,599,67062,63470,75180,50128,84096,16847,30377,65485,80345,53549,21362,73753,71016,79795,67507,72508,11903,21973,44797,32652,54668,56460,82611,71737,30844,70524,59751,27868,56279,25585,45091,2670,54228,50423,3104,22257,8813,59729,31867,13596,23111,56892,66643,18427,32506,18649,62530,27094,56216,56586,20609,34684,52833,73314,13969,6138,2500,38211,2110,62184,43069,10507,9857,49812,32060,60621,33940,70776,21764,39779,14240,31165,39544,45227,32687,75675,3159,55268,72512,65914,45373,68706,69605,58676,70789,46770,29812,70440,43741,52570,70292,23725,46940,45829,32736,70678,31758,68598,73597,28995,27365,81243,7613,27625,65261,66324,33404,58730,68793,18602,51524,10195,11832,30969,59532,16848,65384,71335,64818,41283,22364,55831,83560,4801,77406,44308,31612,32579,79667,59495,11844,20968,43715,2558,4209,83359,21788,19777,68623,2585,3211,69275,32644,32663,9660,34793,83848,22828,41866,45416,25701,63104,79151,59453,3839,33319,7713,1628,48142,61930,11042,72913,82950,68764,35603,53908,30393,23478,1911,63168,83157,3768,42315,22448,71841,58858,76805,79266,42459,74470,54071,59412,30841,51520,42201,74449,7060,22579,12840,51055,21159,20726,1687,49147,63012,41136,37355,56051,43570,1546,16129,12315,80018,46521,786,76079,39199,10192,78845,13419,20096,53646,62378,39084,27186,8214,78684,54414,24433,59000,58813,49796,74067,53038,24321,8981,5732,68480,71587,26831,53194,66342,61411,78013,47358,55865,69560,31667,65590,57349,65680,25350,76078,4192,4342,8355,25685,19094,71568,49834,28061,17287,36414,58975,43808,75580,32157,15620,85288,26946,36200,50956,82163,43695,76571,59243,49831,9057,85754,82995,9756,40802,43329,80542,68568,55591,25529,63090,19138,63570,49183,33009,79702,80502,44560,79642,44490,37628,65075,6297,63525,22174,27810,4264,30353,85487,25962,82129,57695,49705,71059,36790,61006,6966,567,65059,48304,55942,12555,52032,74249,59054,56817,21628,9762,78810,78429,73397,80989,61603,4014,52337,85276,36947,52017,65246,57321,31671,33584,80749,3572,62303,80086,18521,54518,52447,65281,78328,64387,6241,81524,38642,37152,3024,60258,56915,11634,66960,19453,80599,85576,44973,660,52064,76252,74220,76055,59201,41826,21408,49752,82065,53689,19373,32583,47661,82895,35753,57921,47723,16887,54385,41434,61384,79011,61442,45009,56674,4613,33382,62729,26110,16128,63325,74168,62048,13052,75077,57121,83665,67822,3520,48296,33937,51772,4214,343,51038,28159,7293,7595,85635,45978,1742,82158,40694,47321,50861,25144,4047,3330,20275,40658,77324,12295,68014,15538,53275,63348,19159,24564,86016,51010,80167,15527,12266,85015,17922,73473,74994,76118,28200,66308,75411,51147,59174,42824,35492,38896,69179,26635,73182,37963,8091,73673,23000,41880,19412,21584,17760,79461,73481,10982,36901,76018,54197,83427,79805,73509,44991,28667,71347,54817,25466,8074,80673,9567,47788,55900,4550,64383,38247,58124,14733,199,85033,45929,6739,53559,27364,46236,1763,43152,77527,65322,51326,46186,57770,8703,79724,76503,1226,82116,32689,59672,14859,24214,47980,67918,9529,7777,5634,78474,14389,171,51024,54163,11410,52939,85325,31950,80616,78576,58406,80769,15576,7269,27597,31252,74558,38075,58110,40737,4316,44360,45619,78728,46416,23782,63948,35211,7867,59652,2855,79248,14452,55187,75506,22149,12805,30048,74460,48069,912,14077,2146,32181,81635,53654,84383,85884,75004,82120,683,83072,38768,61167,51988,82247,59705,51869,45230,51691,7208,42595,18470,75518,12148,83005,15758,13285,60093,43899,78588,48405,64952,1286,32111,39621,74239,53052,84334,4864,46405,68790,85615,33974,56776,48630,27963,27281,65233,32315,41638,63401,68173,76563,37238,3031,47256,11848,74979,67115,26467,41162,1350,36117,69953,26698,42181,62445,62094,75068,109,31015,35531,27897,39278,23201,24893,77041,83286,46787,22812,83873,37833,16082,1309,63119,2137,61186,28985,21363,22743,76866,64268,55241,73510,79998,34517,55820,42551,26468,76169,7200,20590,57687,27700,24259,74989,73117,84967,57926,50724,46137,62767,66121,66394,75418,38145,14107,20152,35647,45910,29742,28426,64326,21239,68742,39602,11225,27919,35279,65884,27367,65240,19313,82588,40729,68328,83577,83818,4822,38400,81141,49613,33044,14692,27201,17217,80417,79560,12477,74030,48034,65922,67378,29489,31406,46565,78805,75428,44147,72607,36916,85021,55930,22556,67849,2522,34212,44793,64658,31268,32551,45658,67729,16515,20348,15659,74289,83062,32766,2667,35224,32873,49685,59055,5807,27478,80252,66544,79431,55475,7516,72626,13913,24137,18968,47553,870,6072,14497,82196,80705,11570,62954,75138,42123,10430,66862,29447,23401,58916,42803,74498,2063,51178,26170,52140,70257,2718,14224,73172,31961,35608,56909,59643,31860,26598,68178,79564,66488,11413,71943,16858,71386,43818,81582,4640,32384,48645,36966,29014,4362,20359,56668,52622,84299,69874,13689,10116,84840,84921,81927,39675,72243,24884,20029,30636,14496,47189,74855,27097,75220,74136,60045,83903,55839,19548,51601,39207,32197,39628,61237,7985,61662,5019,53419,29353,1389,25118,40052,23264,79909,15506,51272,48182,85938,73008,53952,22395,22827,6859,39566,41228,75370,78149,77375,77312,22296,83831,29828,28433,51324,62189,46070,39757,18239,74499,37070,57028,10643,39874,71259,70813,26768,84195,41860,7408,76618,70249,66730,53441,25354,44072,27592,28251,45308,29693,33423,35727,7909,67657,76521,29233,15382,11254,10918,32895,45686,15721,8281,15677,16279,16328,11331,39930,53260,54345,17426,85435,11955,35980,4929,85418,18955,22547,10837,35889,1921,69170,55640,20532,5672,32468,64655,12264,15001,6222,18510,13509,74114,64044,41220,53365,31349,29557,3406,14280,55173,15493,26266,58149,29738,60432,40926,83347,31789,35594,82913,63760,77204,26288,54150,72421,62906,29125,19374,67590,53511,67368,23487,58923,29801,29431,65408,51333,33184,12703,72048,79879,83517,47806,83907,23833,42948,75510,76160,36205,53957,25396,52077,15241,64253,46238,71777,54852,46473,40790,53330,10342,82858,30749,13505,20103,40644,17311,16412,27341,15228,39247,56205,15577,42276,33447,15725,62292,39077,40188,53281,15339,54259,17419,12420,57022,58652,4774,78404,58392,20756,19693,52613,27287,17224,67415,34493,75822,74185,55048,26485,69169,20633,14682,21199,44734,63653,30186,2457,81216,8611,41709,54405,53438,6350,26522,74173,65049,42302,83459,81808,2658,64229,66240,17394,83432,82806,16742,53373,53354,76357,51224,2169,63189,44151,40601,60316,22913,6866,26564,82178,52698,78304,84389,37875,24087,74975,13104,3067,17253,50414,32109,55624,62539,84106,22849,2860,82249,43702,63569,14176,27159,9212,6751,43558,11547,31946,26605,55176,34497,43816,11568,78957,63438,73177,34962,64858,65291,84330,36870,23005,44881,48662,29966,42447,84471,69888,73702,5999,39496,85231,9938,46818,75825,7172,72598,65921,32371,23639,46933,58831,77803,7333,31603,61584,27017,27204,36221,11950,32979,61696,77036,80285,17537,14430,59186,32823,19675,24606,8004,38659,30152,16457,54350,20427,28668,20337,60667,9939,81825,81675,77662,60332,66923,14449,36183,57956,68730,49603,27042,42209,10437,53860,70397,729,59071,49817,35061,3854,42322,9446,26774,36186,76960,263,3022,76261,45215,42688,5475,17449,30426,60488,22927,66879,22447,36834,53008,6315,5515,41457,6375,41527,48389,20942,79720,22492,63843,58207,81753,55664,530,60055,3888,28322,36312,14958,49227,25011,79051,85450,20958,37713,30075,73462,33985,11768,26963,29200,64389,76255,7207,7588,12620,5028,24414,82003,33680,741,49070,34000,20771,28696,54346,52433,5268,82445,23714,5931,67496,31499,33570,20736,7689,21630,79776,4493,47375,48865,82993,25759,29102,74383,19057,66564,5418,441,41044,85357,33953,9765,11797,9962,26816,44191,64609,36265,3952,32328,66644,53434,38356,3122,50264,28096,38294,69130,31632,44583,24633,7006,24575,41008,29343,81404,52635,23288,59907,69889,22692,11849,23969,72965,10940,28896,2352,18195,82497,37721,52080,34245,81803,85674,34979,57858,78724,78422,382,40039,84275,3859,45323,38696,35156,60873,81970,82687,65742,45359,8693,73722,18003,70479,32742,22669,66858,61453};

/* multiplication inverses of omega_256,512,768,1536, respectively */
static const uint32_t omega_256_inv[128]={1,73722,35156,78422,52080,72965,52635,44583,38356,44191,41044,25759,7689,82445,49070,7588,33985,25011,530,20942,53008,17449,76960,49817,27042,60332,28668,24606,77036,61584,32371,85231,29966,64858,34497,9212,22849,3067,52698,44151,16742,81808,53438,63653,55048,52613,57022,39077,39247,13505,54852,53957,47806,65408,67590,77204,60432,3406,13509,5672,22547,17426,15677,15382,29693,66730,70813,18239,83831,39566,48182,1389,39628,60045,30636,84840,20359,81582,79564,31961,51178,66862,82196,13913,27478,32766,45658,67849,75428,48034,14692,83577,65884,64326,38145,57926,20590,79998,28985,83873,39278,62445,26467,76563,27963,4864,64952,83005,45230,83072,81635,30048,2855,78728,74558,78576,51024,67918,1226,65322,6739,64383,25466,83427,17760,37963,59174,73473};
static const uint32_t omega_512_inv[256]={1,85249,73722,66707,35156,9530,78422,69821,52080,465,72965,45964,52635,4310,44583,81039,38356,46423,44191,38027,41044,46447,25759,998,7689,30021,82445,76769,49070,75703,7588,21572,33985,48688,25011,59360,530,23045,20942,1723,53008,61914,17449,17820,76960,74416,49817,18109,27042,47858,60332,28187,28668,3328,24606,26332,77036,16048,61584,12838,32371,84002,85231,1529,29966,38668,64858,78916,34497,85557,9212,64595,22849,85453,3067,53020,52698,41943,44151,68747,16742,44694,81808,49883,53438,75742,63653,58169,55048,43500,52613,21206,57022,75774,39077,8797,39247,50271,13505,36217,54852,21994,53957,21218,47806,14251,65408,584,67590,45148,77204,59058,60432,37404,3406,50719,13509,33145,5672,30771,22547,59338,17426,35484,15677,2444,15382,56970,29693,76298,66730,17492,70813,64377,18239,13219,83831,44525,39566,63330,48182,69551,1389,51469,39628,15714,60045,76569,30636,40210,84840,43766,20359,19382,81582,51417,79564,52935,31961,54814,51178,5065,66862,2133,82196,9950,13913,66941,27478,57078,32766,38693,45658,29592,67849,18270,75428,46754,48034,11181,14692,70788,83577,67563,65884,65101,64326,57407,38145,36437,57926,69638,20590,14008,79998,63691,28985,17923,83873,12269,39278,26463,62445,39726,26467,59373,76563,35244,27963,28666,4864,49196,64952,6724,83005,76774,45230,14228,83072,25318,81635,10713,30048,61709,2855,43802,78728,6847,74558,26778,78576,37566,51024,37320,67918,51295,1226,4619,65322,66632,6739,71485,64383,13631,25466,53988,83427,10729,17760,37023,37963,4179,59174,57361,73473,85905};
static const uint32_t omega_768_inv[768]={1,39437,3592,73722,85931,49098,35156,25166,7396,78422,73196,72166,52080,51051,70402,72965,80021,82498,52635,4251,85571,44583,32291,64499,38356,36627,61535,44191,56047,32707,41044,70339,82927,25759,82930,58053,7689,21168,7431,82445,26882,71926,49070,49141,10607,7588,80830,74724,33985,35568,15997,25011,1868,37764,530,85496,11386,20942,40437,44806,53008,5345,49115,17449,213,56432,76960,47692,67699,49817,4749,27304,27042,16588,21671,60332,82864,35721,28668,58485,13107,24606,29045,45293,77036,34309,82640,61584,84230,60021,32371,36830,67665,85231,54655,15249,29966,67596,30605,64858,3434,35900,34497,13317,48744,9212,43853,58976,22849,67938,13390,3067,13377,6488,52698,80306,53816,44151,26873,61061,16742,73779,11381,81808,22477,20264,53438,17906,45369,63653,49250,8390,55048,30930,65350,52613,82824,6547,57022,34183,16547,39077,85094,70857,39247,80058,79378,13505,65438,82389,54852,42808,49454,53957,13663,17243,47806,4616,29220,65408,17500,33109,67590,52034,43306,77204,36416,83977,60432,69782,50853,3406,49885,19938,13509,51152,10740,5672,42464,73812,22547,28310,46827,17426,39349,59833,15677,49670,56666,15382,28050,29230,29693,53420,82193,66730,26912,50798,70813,24359,8027,18239,17289,55551,83831,65769,61452,39566,15962,20988,48182,38004,3540,1389,71181,302,39628,52580,71658,60045,32672,37021,30636,83167,28769,84840,31831,73066,20359,15205,15078,81582,55483,68642,79564,37342,45414,31961,38856,57234,51178,3898,13047,66862,71576,8840,82196,13007,37688,13913,70555,85636,27478,7720,39477,32766,45368,24216,45658,20685,55134,67849,30194,27447,75428,14142,69843,48034,50484,74043,14692,83909,45243,83577,26743,9254,65884,37806,22561,64326,11098,17330,38145,59069,77776,57926,74193,81086,20590,7350,70677,79998,35617,56036,28985,1532,33550,83873,1783,40282,39278,12350,18696,62445,62772,56121,26467,48801,20679,76563,46297,17947,27963,38891,61257,4864,3658,10037,64952,11781,29480,83005,5233,19038,45230,981,66064,83072,67002,1651,81635,81236,967,30048,32784,67098,2855,82399,19137,78728,12521,53097,74558,24735,41415,78576,39287,23215,51024,37807,61998,67918,84820,17244,1226,8208,16925,65322,66598,68265,6739,59430,35711,64383,22565,50040,25466,54167,37801,83427,46366,72573,17760,50706,55323,37963,20946,26151,59174,3828,5001,73473,72056,14860,86016,46580,82425,12295,86,36919,50861,60851,78621,7595,12821,13851,33937,34966,15615,13052,5996,3519,33382,81766,446,41434,53726,21518,47661,49390,24482,41826,29970,53310,44973,15678,3090,60258,3087,27964,78328,64849,78586,3572,59135,14091,36947,36876,75410,78429,5187,11293,52032,50449,70020,61006,84149,48253,85487,521,74631,65075,45580,41211,33009,80672,36902,68568,85804,29585,9057,38325,18318,36200,81268,58713,58975,69429,64346,25685,3153,50296,57349,27532,72910,61411,56972,40724,8981,51708,3377,24433,1787,25996,53646,49187,18352,786,31362,70768,56051,18421,55412,21159,82583,50117,51520,72700,37273,76805,42164,27041,63168,18079,72627,82950,72640,79529,33319,5711,32201,41866,59144,24956,69275,12238,74636,4209,63540,65753,32579,68111,40648,22364,36767,77627,30969,55087,20667,33404,3193,79470,28995,51834,69470,46940,923,15160,46770,5959,6639,72512,20579,3628,31165,43209,36563,32060,72354,68774,38211,81401,56797,20609,68517,52908,18427,33983,42711,8813,49601,2040,25585,16235,35164,82611,36132,66079,72508,34865,75277,80345,43553,12205,63470,57707,39190,68591,46668,26184,70340,36347,29351,70635,57967,56787,56324,32597,3824,19287,59105,35219,15204,61658,77990,67778,68728,30466,2186,20248,24565,46451,70055,65029,37835,48013,82477,84628,14836,85715,46389,33437,14359,25972,53345,48996,55381,2850,57248,1177,54186,12951,65658,70812,70939,4435,30534,17375,6453,48675,40603,54056,47161,28783,34839,82119,72970,19155,14441,77177,3821,73010,48329,72104,15462,381,58539,78297,46540,53251,40649,61801,40359,65332,30883,18168,55823,58570,10589,71875,16174,37983,35533,11974,71325,2108,40774,2440,59274,76763,20133,48211,63456,21691,74919,68687,47872,26948,8241,28091,11824,4931,65427,78667,15340,6019,50400,29981,57032,84485,52467,2144,84234,45735,46739,73667,67321,23572,23245,29896,59550,37216,65338,9454,39720,68070,58054,47126,24760,81153,82359,75980,21065,74236,56537,3012,80784,66979,40787,85036,19953,2945,19015,84366,4382,4781,85050,55969,53233,18919,83162,3618,66880,7289,73496,32920,11459,61282,44602,7441,46730,62802,34993,48210,24019,18099,1197,68773,84791,77809,69092,20695,19419,17752,79278,26587,50306,21634,63452,35977,60551,31850,48216,2590,39651,13444,68257,35311,30694,48054,65071,59866,26843,82189,81016,12544,13961,71157};
static const uint32_t omega_1536_inv[1536]={1,58236,39437,85249,3592,76385,73722,79905,85931,66707,49098,66048,35156,54199,25166,9530,7396,26337,78422,83011,73196,69821,72166,40590,52080,57477,51051,465,70402,16584,72965,35957,80021,45964,82498,46027,52635,36065,4251,4310,85571,3878,44583,84477,32291,81039,64499,59425,38356,10560,36627,46423,61535,84040,44191,50470,56047,38027,32707,50421,41044,84005,70339,46447,82927,84341,25759,50661,82930,998,58053,48357,7689,58119,21168,30021,7431,189,82445,56131,26882,76769,71926,84721,49070,69763,49141,75703,10607,21175,7588,25439,80830,21572,74724,26834,33985,71324,35568,48688,15997,37182,25011,14735,1868,59360,37764,27665,530,70994,85496,23045,11386,56060,20942,29286,40437,1723,44806,82538,53008,81809,5345,61914,49115,23856,17449,41143,213,17820,56432,8450,76960,12792,47692,74416,67699,15786,49817,47453,4749,18109,27304,51499,27042,18676,16588,47858,21671,76949,60332,43970,82864,28187,35721,13028,28668,5695,58485,3328,13107,70411,24606,83830,29045,26332,45293,57860,77036,51861,34309,16048,82640,57907,61584,13026,84230,12838,60021,82161,32371,8984,36830,84002,67665,14153,85231,73565,54655,1529,15249,1256,29966,73097,67596,38668,30605,40540,64858,64018,3434,78916,35900,29215,34497,40257,13317,85557,48744,8567,9212,68020,43853,64595,58976,39560,22849,37391,67938,85453,13390,35935,3067,38520,13377,53020,6488,48504,52698,6202,80306,41943,53816,85198,44151,43489,26873,68747,61061,5616,16742,70434,73779,44694,11381,22931,81808,33126,22477,49883,20264,27081,53438,6325,17906,75742,45369,10912,63653,79510,49250,58169,8390,23480,55048,7755,30930,43500,65350,72469,52613,45128,82824,21206,6547,43748,57022,46907,34183,75774,16547,68658,39077,22420,85094,8797,70857,20728,39247,30585,80058,50271,79378,17611,13505,23749,65438,36217,82389,63561,54852,33760,42808,21994,49454,67967,53957,38842,13663,21218,17243,890,47806,3994,4616,14251,29220,67626,65408,9477,17500,584,33109,64669,67590,33320,52034,45148,43306,35793,77204,29571,36416,59058,83977,74054,60432,18414,69782,37404,50853,82032,3406,82631,49885,50719,19938,51902,13509,84659,51152,33145,10740,25033,5672,9312,42464,30771,73812,74108,22547,83604,28310,59338,46827,20221,17426,77987,39349,35484,59833,57952,15677,67351,49670,2444,56666,44988,15382,5114,28050,56970,29230,47867,29693,1797,53420,76298,82193,3549,66730,12254,26912,17492,50798,61681,70813,38854,24359,64377,8027,43994,18239,28488,17289,13219,55551,54683,83831,1264,65769,44525,61452,67404,39566,28197,15962,63330,20988,41615,48182,52412,38004,69551,3540,58708,1389,33824,71181,51469,302,39804,39628,26115,52580,15714,71658,46550,60045,17536,32672,76569,37021,24868,30636,39499,83167,40210,28769,38375,84840,11777,31831,43766,73066,68637,20359,54413,15205,19382,15078,20872,81582,32391,55483,51417,68642,53488,79564,11365,37342,52935,45414,51022,31961,44950,38856,54814,57234,6491,51178,84992,3898,5065,13047,16931,66862,43893,71576,2133,8840,80512,82196,6223,13007,9950,37688,74613,13913,43345,70555,66941,85636,4470,27478,34557,7720,57078,39477,6213,32766,45665,45368,38693,24216,80278,45658,67801,20685,29592,55134,27065,67849,63469,30194,18270,27447,35598,75428,80886,14142,46754,69843,63103,48034,35184,50484,11181,74043,21955,14692,78230,83909,70788,45243,70638,83577,4244,26743,67563,9254,19439,65884,32339,37806,65101,22561,38738,64326,48586,11098,57407,17330,78436,38145,23195,59069,36437,77776,51984,57926,49847,74193,69638,81086,49047,20590,2260,7350,14008,70677,32322,79998,82808,35617,63691,56036,85567,28985,58869,1532,17923,33550,27662,83873,38700,1783,12269,40282,6928,39278,29544,12350,26463,18696,63087,62445,6311,62772,39726,56121,46641,26467,79606,48801,59373,20679,24244,76563,31673,46297,35244,17947,54942,27963,65441,38891,28666,61257,65628,4864,5923,3658,49196,10037,29217,64952,33114,11781,6724,29480,69994,83005,67848,5233,76774,19038,23855,45230,1706,981,14228,66064,20745,83072,12878,67002,25318,1651,66647,81635,22287,81236,10713,967,59094,30048,31497,32784,61709,67098,24869,2855,78936,82399,43802,19137,26080,78728,11691,12521,6847,53097,17776,74558,79579,24735,26778,41415,13277,78576,19570,39287,37566,23215,19551,51024,62416,37807,37320,61998,37970,67918,38954,84820,51295,17244,59126,1226,3226,8208,4619,16925,61514,65322,76184,66598,66632,68265,32851,6739,42850,59430,71485,35711,32787,64383,13375,22565,13631,50040,45514,25466,18879,54167,53988,37801,31972,83427,42578,46366,10729,72573,1950,17760,2952,50706,37023,55323,23493,37963,4334,20946,4179,26151,84668,59174,44010,3828,57361,5001,70691,73473,29997,72056,85905,14860,55940,86016,27781,46580,768,82425,9632,12295,6112,86,19310,36919,19969,50861,31818,60851,76487,78621,59680,7595,3006,12821,16196,13851,45427,33937,28540,34966,85552,15615,69433,13052,50060,5996,40053,3519,39990,33382,49952,81766,81707,446,82139,41434,1540,53726,4978,21518,26592,47661,75457,49390,39594,24482,1977,41826,35547,29970,47990,53310,35596,44973,2012,15678,39570,3090,1676,60258,35356,3087,85019,27964,37660,78328,27898,64849,55996,78586,85828,3572,29886,59135,9248,14091,1296,36947,16254,36876,10314,75410,64842,78429,60578,5187,64445,11293,59183,52032,14693,50449,37329,70020,48835,61006,71282,84149,26657,48253,58352,85487,15023,521,62972,74631,29957,65075,56731,45580,84294,41211,3479,33009,4208,80672,24103,36902,62161,68568,44874,85804,68197,29585,77567,9057,73225,38325,11601,18318,70231,36200,38564,81268,67908,58713,34518,58975,67341,69429,38159,64346,9068,25685,42047,3153,57830,50296,72989,57349,80322,27532,82689,72910,15606,61411,2187,56972,59685,40724,28157,8981,34156,51708,69969,3377,28110,24433,72991,1787,73179,25996,3856,53646,77033,49187,2015,18352,71864,786,12452,31362,84488,70768,84761,56051,12920,18421,47349,55412,45477,21159,21999,82583,7101,50117,56802,51520,45760,72700,460,37273,77450,76805,17997,42164,21422,27041,46457,63168,48626,18079,564,72627,50082,82950,47497,72640,32997,79529,37513,33319,79815,5711,44074,32201,819,41866,42528,59144,17270,24956,80401,69275,15583,12238,41323,74636,63086,4209,52891,63540,36134,65753,58936,32579,79692,68111,10275,40648,75105,22364,6507,36767,27848,77627,62537,30969,78262,55087,42517,20667,13548,33404,40889,3193,64811,79470,42269,28995,39110,51834,10243,69470,17359,46940,63597,923,77220,15160,65289,46770,55432,5959,35746,6639,68406,72512,62268,20579,49800,3628,22456,31165,52257,43209,64023,36563,18050,32060,47175,72354,64799,68774,85127,38211,82023,81401,71766,56797,18391,20609,76540,68517,85433,52908,21348,18427,52697,33983,40869,42711,50224,8813,56446,49601,26959,2040,11963,25585,67603,16235,48613,35164,3985,82611,3386,36132,35298,66079,34115,72508,1358,34865,52872,75277,60984,80345,76705,43553,55246,12205,11909,63470,2413,57707,26679,39190,65796,68591,8030,46668,50533,26184,28065,70340,18666,36347,83573,29351,41029,70635,80903,57967,29047,56787,38150,56324,84220,32597,9719,3824,82468,19287,73763,59105,68525,35219,24336,15204,47163,61658,21640,77990,42023,67778,57529,68728,72798,30466,31334,2186,84753,20248,41492,24565,18613,46451,57820,70055,22687,65029,44402,37835,33605,48013,16466,82477,27309,84628,52193,14836,34548,85715,46213,46389,59902,33437,70303,14359,39467,25972,68481,53345,9448,48996,61149,55381,46518,2850,45807,57248,47642,1177,74240,54186,42251,12951,17380,65658,31604,70812,66635,70939,65145,4435,53626,30534,34600,17375,32529,6453,74652,48675,33082,40603,34995,54056,41067,47161,31203,28783,79526,34839,1025,82119,80952,72970,69086,19155,42124,14441,83884,77177,5505,3821,79794,73010,76067,48329,11404,72104,42672,15462,19076,381,81547,58539,51460,78297,28939,46540,79804,53251,40352,40649,47324,61801,5739,40359,18216,65332,56425,30883,58952,18168,22548,55823,67747,58570,50419,10589,5131,71875,39263,16174,22914,37983,50833,35533,74836,11974,64062,71325,7787,2108,15229,40774,15379,2440,81773,59274,18454,76763,66578,20133,53678,48211,20916,63456,47279,21691,37431,74919,28610,68687,7581,47872,62822,26948,49580,8241,34033,28091,36170,11824,16379,4931,36970,65427,83757,78667,72009,15340,53695,6019,3209,50400,22326,29981,450,57032,27148,84485,68094,52467,58355,2144,47317,84234,73748,45735,79089,46739,56473,73667,59554,67321,22930,23572,79706,23245,46291,29896,39376,59550,6411,37216,26644,65338,61773,9454,54344,39720,50773,68070,31075,58054,20576,47126,57351,24760,20389,81153,80094,82359,36821,75980,56800,21065,52903,74236,79293,56537,16023,3012,18169,80784,9243,66979,62162,40787,84311,85036,71789,19953,65272,2945,73139,19015,60699,84366,19370,4382,63730,4781,75304,85050,26923,55969,54520,53233,24308,18919,61148,83162,7081,3618,42215,66880,59937,7289,74326,73496,79170,32920,68241,11459,6438,61282,59239,44602,72740,7441,66447,46730,48451,62802,66466,34993,23601,48210,48697,24019,48047,18099,47063,1197,34722,68773,26891,84791,82791,77809,81398,69092,24503,20695,9833,19419,19385,17752,53166,79278,43167,26587,14532,50306,53230,21634,72642,63452,72386,35977,40503,60551,67138,31850,32029,48216,54045,2590,43439,39651,75288,13444,84067,68257,83065,35311,48994,30694,62524,48054,81683,65071,81838,59866,1349,26843,42007,82189,28656,81016,15326,12544,56020,13961,112,71157,30077};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* bit reverse step of dimension 512 */
static void bit_reverse_512(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[256];a[256]=t;
t=a[2];a[2]=a[128];a[128]=t;
t=a[3];a[3]=a[384];a[384]=t;
t=a[4];a[4]=a[64];a[64]=t;
t=a[5];a[5]=a[320];a[320]=t;
t=a[6];a[6]=a[192];a[192]=t;
t=a[7];a[7]=a[448];a[448]=t;
t=a[8];a[8]=a[32];a[32]=t;
t=a[9];a[9]=a[288];a[288]=t;
t=a[10];a[10]=a[160];a[160]=t;
t=a[11];a[11]=a[416];a[416]=t;
t=a[12];a[12]=a[96];a[96]=t;
t=a[13];a[13]=a[352];a[352]=t;
t=a[14];a[14]=a[224];a[224]=t;
t=a[15];a[15]=a[480];a[480]=t;
t=a[17];a[17]=a[272];a[272]=t;
t=a[18];a[18]=a[144];a[144]=t;
t=a[19];a[19]=a[400];a[400]=t;
t=a[20];a[20]=a[80];a[80]=t;
t=a[21];a[21]=a[336];a[336]=t;
t=a[22];a[22]=a[208];a[208]=t;
t=a[23];a[23]=a[464];a[464]=t;
t=a[24];a[24]=a[48];a[48]=t;
t=a[25];a[25]=a[304];a[304]=t;
t=a[26];a[26]=a[176];a[176]=t;
t=a[27];a[27]=a[432];a[432]=t;
t=a[28];a[28]=a[112];a[112]=t;
t=a[29];a[29]=a[368];a[368]=t;
t=a[30];a[30]=a[240];a[240]=t;
t=a[31];a[31]=a[496];a[496]=t;
t=a[33];a[33]=a[264];a[264]=t;
t=a[34];a[34]=a[136];a[136]=t;
t=a[35];a[35]=a[392];a[392]=t;
t=a[36];a[36]=a[72];a[72]=t;
t=a[37];a[37]=a[328];a[328]=t;
t=a[38];a[38]=a[200];a[200]=t;
t=a[39];a[39]=a[456];a[456]=t;
t=a[41];a[41]=a[296];a[296]=t;
t=a[42];a[42]=a[168];a[168]=t;
t=a[43];a[43]=a[424];a[424]=t;
t=a[44];a[44]=a[104];a[104]=t;
t=a[45];a[45]=a[360];a[360]=t;
t=a[46];a[46]=a[232];a[232]=t;
t=a[47];a[47]=a[488];a[488]=t;
t=a[49];a[49]=a[280];a[280]=t;
t=a[50];a[50]=a[152];a[152]=t;
t=a[51];a[51]=a[408];a[408]=t;
t=a[52];a[52]=a[88];a[88]=t;
t=a[53];a[53]=a[344];a[344]=t;
t=a[54];a[54]=a[216];a[216]=t;
t=a[55];a[55]=a[472];a[472]=t;
t=a[57];a[57]=a[312];a[312]=t;
t=a[58];a[58]=a[184];a[184]=t;
t=a[59];a[59]=a[440];a[440]=t;
t=a[60];a[60]=a[120];a[120]=t;
t=a[61];a[61]=a[376];a[376]=t;
t=a[62];a[62]=a[248];a[248]=t;
t=a[63];a[63]=a[504];a[504]=t;
t=a[65];a[65]=a[260];a[260]=t;
t=a[66];a[66]=a[132];a[132]=t;
t=a[67];a[67]=a[388];a[388]=t;
t=a[69];a[69]=a[324];a[324]=t;
t=a[70];a[70]=a[196];a[196]=t;
t=a[71];a[71]=a[452];a[452]=t;
t=a[73];a[73]=a[292];a[292]=t;
t=a[74];a[74]=a[164];a[164]=t;
t=a[75];a[75]=a[420];a[420]=t;
t=a[76];a[76]=a[100];a[100]=t;
t=a[77];a[77]=a[356];a[356]=t;
t=a[78];a[78]=a[228];a[228]=t;
t=a[79];a[79]=a[484];a[484]=t;
t=a[81];a[81]=a[276];a[276]=t;
t=a[82];a[82]=a[148];a[148]=t;
t=a[83];a[83]=a[404];a[404]=t;
t=a[85];a[85]=a[340];a[340]=t;
t=a[86];a[86]=a[212];a[212]=t;
t=a[87];a[87]=a[468];a[468]=t;
t=a[89];a[89]=a[308];a[308]=t;
t=a[90];a[90]=a[180];a[180]=t;
t=a[91];a[91]=a[436];a[436]=t;
t=a[92];a[92]=a[116];a[116]=t;
t=a[93];a[93]=a[372];a[372]=t;
t=a[94];a[94]=a[244];a[244]=t;
t=a[95];a[95]=a[500];a[500]=t;
t=a[97];a[97]=a[268];a[268]=t;
t=a[98];a[98]=a[140];a[140]=t;
t=a[99];a[99]=a[396];a[396]=t;
t=a[101];a[101]=a[332];a[332]=t;
t=a[102];a[102]=a[204];a[204]=t;
t=a[103];a[103]=a[460];a[460]=t;
t=a[105];a[105]=a[300];a[300]=t;
t=a[106];a[106]=a[172];a[172]=t;
t=a[107];a[107]=a[428];a[428]=t;
t=a[109];a[109]=a[364];a[364]=t;
t=a[110];a[110]=a[236];a[236]=t;
t=a[111];a[111]=a[492];a[492]=t;
t=a[113];a[113]=a[284];a[284]=t;
t=a[114];a[114]=a[156];a[156]=t;
t=a[115];a[115]=a[412];a[412]=t;
t=a[117];a[117]=a[348];a[348]=t;
t=a[118];a[118]=a[220];a[220]=t;
t=a[119];a[119]=a[476];a[476]=t;
t=a[121];a[121]=a[316];a[316]=t;
t=a[122];a[122]=a[188];a[188]=t;
t=a[123];a[123]=a[444];a[444]=t;
t=a[125];a[125]=a[380];a[380]=t;
t=a[126];a[126]=a[252];a[252]=t;
t=a[127];a[127]=a[508];a[508]=t;
t=a[129];a[129]=a[258];a[258]=t;
t=a[131];a[131]=a[386];a[386]=t;
t=a[133];a[133]=a[322];a[322]=t;
t=a[134];a[134]=a[194];a[194]=t;
t=a[135];a[135]=a[450];a[450]=t;
t=a[137];a[137]=a[290];a[290]=t;
t=a[138];a[138]=a[162];a[162]=t;
t=a[139];a[139]=a[418];a[418]=t;
t=a[141];a[141]=a[354];a[354]=t;
t=a[142];a[142]=a[226];a[226]=t;
t=a[143];a[143]=a[482];a[482]=t;
t=a[145];a[145]=a[274];a[274]=t;
t=a[147];a[147]=a[402];a[402]=t;
t=a[149];a[149]=a[338];a[338]=t;
t=a[150];a[150]=a[210];a[210]=t;
t=a[151];a[151]=a[466];a[466]=t;
t=a[153];a[153]=a[306];a[306]=t;
t=a[154];a[154]=a[178];a[178]=t;
t=a[155];a[155]=a[434];a[434]=t;
t=a[157];a[157]=a[370];a[370]=t;
t=a[158];a[158]=a[242];a[242]=t;
t=a[159];a[159]=a[498];a[498]=t;
t=a[161];a[161]=a[266];a[266]=t;
t=a[163];a[163]=a[394];a[394]=t;
t=a[165];a[165]=a[330];a[330]=t;
t=a[166];a[166]=a[202];a[202]=t;
t=a[167];a[167]=a[458];a[458]=t;
t=a[169];a[169]=a[298];a[298]=t;
t=a[171];a[171]=a[426];a[426]=t;
t=a[173];a[173]=a[362];a[362]=t;
t=a[174];a[174]=a[234];a[234]=t;
t=a[175];a[175]=a[490];a[490]=t;
t=a[177];a[177]=a[282];a[282]=t;
t=a[179];a[179]=a[410];a[410]=t;
t=a[181];a[181]=a[346];a[346]=t;
t=a[182];a[182]=a[218];a[218]=t;
t=a[183];a[183]=a[474];a[474]=t;
t=a[185];a[185]=a[314];a[314]=t;
t=a[187];a[187]=a[442];a[442]=t;
t=a[189];a[189]=a[378];a[378]=t;
t=a[190];a[190]=a[250];a[250]=t;
t=a[191];a[191]=a[506];a[506]=t;
t=a[193];a[193]=a[262];a[262]=t;
t=a[195];a[195]=a[390];a[390]=t;
t=a[197];a[197]=a[326];a[326]=t;
t=a[199];a[199]=a[454];a[454]=t;
t=a[201];a[201]=a[294];a[294]=t;
t=a[203];a[203]=a[422];a[422]=t;
t=a[205];a[205]=a[358];a[358]=t;
t=a[206];a[206]=a[230];a[230]=t;
t=a[207];a[207]=a[486];a[486]=t;
t=a[209];a[209]=a[278];a[278]=t;
t=a[211];a[211]=a[406];a[406]=t;
t=a[213];a[213]=a[342];a[342]=t;
t=a[215];a[215]=a[470];a[470]=t;
t=a[217];a[217]=a[310];a[310]=t;
t=a[219];a[219]=a[438];a[438]=t;
t=a[221];a[221]=a[374];a[374]=t;
t=a[222];a[222]=a[246];a[246]=t;
t=a[223];a[223]=a[502];a[502]=t;
t=a[225];a[225]=a[270];a[270]=t;
t=a[227];a[227]=a[398];a[398]=t;
t=a[229];a[229]=a[334];a[334]=t;
t=a[231];a[231]=a[462];a[462]=t;
t=a[233];a[233]=a[302];a[302]=t;
t=a[235];a[235]=a[430];a[430]=t;
t=a[237];a[237]=a[366];a[366]=t;
t=a[239];a[239]=a[494];a[494]=t;
t=a[241];a[241]=a[286];a[286]=t;
t=a[243];a[243]=a[414];a[414]=t;
t=a[245];a[245]=a[350];a[350]=t;
t=a[247];a[247]=a[478];a[478]=t;
t=a[249];a[249]=a[318];a[318]=t;
t=a[251];a[251]=a[446];a[446]=t;
t=a[253];a[253]=a[382];a[382]=t;
t=a[255];a[255]=a[510];a[510]=t;
t=a[259];a[259]=a[385];a[385]=t;
t=a[261];a[261]=a[321];a[321]=t;
t=a[263];a[263]=a[449];a[449]=t;
t=a[265];a[265]=a[289];a[289]=t;
t=a[267];a[267]=a[417];a[417]=t;
t=a[269];a[269]=a[353];a[353]=t;
t=a[271];a[271]=a[481];a[481]=t;
t=a[275];a[275]=a[401];a[401]=t;
t=a[277];a[277]=a[337];a[337]=t;
t=a[279];a[279]=a[465];a[465]=t;
t=a[281];a[281]=a[305];a[305]=t;
t=a[283];a[283]=a[433];a[433]=t;
t=a[285];a[285]=a[369];a[369]=t;
t=a[287];a[287]=a[497];a[497]=t;
t=a[291];a[291]=a[393];a[393]=t;
t=a[293];a[293]=a[329];a[329]=t;
t=a[295];a[295]=a[457];a[457]=t;
t=a[299];a[299]=a[425];a[425]=t;
t=a[301];a[301]=a[361];a[361]=t;
t=a[303];a[303]=a[489];a[489]=t;
t=a[307];a[307]=a[409];a[409]=t;
t=a[309];a[309]=a[345];a[345]=t;
t=a[311];a[311]=a[473];a[473]=t;
t=a[315];a[315]=a[441];a[441]=t;
t=a[317];a[317]=a[377];a[377]=t;
t=a[319];a[319]=a[505];a[505]=t;
t=a[323];a[323]=a[389];a[389]=t;
t=a[327];a[327]=a[453];a[453]=t;
t=a[331];a[331]=a[421];a[421]=t;
t=a[333];a[333]=a[357];a[357]=t;
t=a[335];a[335]=a[485];a[485]=t;
t=a[339];a[339]=a[405];a[405]=t;
t=a[343];a[343]=a[469];a[469]=t;
t=a[347];a[347]=a[437];a[437]=t;
t=a[349];a[349]=a[373];a[373]=t;
t=a[351];a[351]=a[501];a[501]=t;
t=a[355];a[355]=a[397];a[397]=t;
t=a[359];a[359]=a[461];a[461]=t;
t=a[363];a[363]=a[429];a[429]=t;
t=a[367];a[367]=a[493];a[493]=t;
t=a[371];a[371]=a[413];a[413]=t;
t=a[375];a[375]=a[477];a[477]=t;
t=a[379];a[379]=a[445];a[445]=t;
t=a[383];a[383]=a[509];a[509]=t;
t=a[391];a[391]=a[451];a[451]=t;
t=a[395];a[395]=a[419];a[419]=t;
t=a[399];a[399]=a[483];a[483]=t;
t=a[407];a[407]=a[467];a[467]=t;
t=a[411];a[411]=a[435];a[435]=t;
t=a[415];a[415]=a[499];a[499]=t;
t=a[423];a[423]=a[459];a[459]=t;
t=a[431];a[431]=a[491];a[491]=t;
t=a[439];a[439]=a[475];a[475]=t;
t=a[447];a[447]=a[507];a[507]=t;
t=a[463];a[463]=a[487];a[487]=t;
t=a[479];a[479]=a[503];a[503]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = barrett_4q2((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = barrett_4q2((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), void (*bit_reverse)(uint32_t *))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n, void (*bit_reverse)(uint32_t *))
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = barrett_2q2((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 4 --> 256 * 7 */
static void ntt_butterfly_1024_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	
	a[n2] = barrett_8q(b + c + d + e);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0] + d * w_7[2][1] + e * w_7[2][2]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0] + d * w_7[3][1] + e * w_7[3][2]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0] + d * w_7[4][1] + e * w_7[4][2]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0] + d * w_7[5][1] + e * w_7[5][2]) % Q;
}

/* 256 * 7 --> 256 * 3 */
static void ntt_butterfly_1792_768(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	g = a[N2_1792 * 5 + n2];
	h = a[N2_1792 * 6 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2] + f * w_7[0][3] + g * w_7[0][4] + h * w_7[0][5]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2] + f * w_7[1][3] + g * w_7[1][4] + h * w_7[1][5]) % Q;
}

/* 512 * 1 --> 512 * 3 */
static void ntt_butterfly_512_1536(uint32_t *a, uint32_t n2)
{
	a[N2_1536 + n2] = a[n2];
	a[N2_1536 * 2 + n2] = a[n2];
}

/* 512 * 2 --> 512 * 3 */
static void ntt_butterfly_1024_1536(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_1536 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_1536 + n2] = (b + c * w_3[0]) % Q;
	a[N2_1536 * 2 + n2] = (b + c * w_3[1]) % Q;
}

/* 512 * 3 --> 512 * 3 */
static void ntt_butterfly_1536_1536_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_1536 + n2];
	d = a[N2_1536 * 2 + n2];

	a[n2] = barrett_8q(b + c + d);
	a[N2_1536 + n2] = (b + c * w_3_inv[0] + d * w_3_inv[1]) % Q;
	a[N2_1536 * 2 + n2] = (b + c * w_3_inv[1] + d * w_3_inv[0]) % Q;
}

/* 256 * 3 --> 256 * 3 */
static void ntt_butterfly_768_768_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_768 + n2];
	d = a[N2_768 * 2 + n2];

	a[n2] = barrett_8q(b + c + d);
	a[N2_768 + n2] = (b + c * w_3_inv[0] + d * w_3_inv[1]) % Q;
	a[N2_768 * 2 + n2] = (b + c * w_3_inv[1] + d * w_3_inv[0]) % Q;	
}

/* 256 * 3 --> 256 * 1 */
static void ntt_butterfly_768_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_8q(a[n2] + a[N2_768 + n2] + a[N2_768 * 2 + n2]);
}

/* 256 * 6 --> 256 * 7 */
static void ntt_butterfly_1536_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	g = a[N2_1792 * 5 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2] + f * w_7[0][3] + g * w_7[0][4]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2] + f * w_7[1][3] + g * w_7[1][4]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0] + d * w_7[2][1] + e * w_7[2][2] + f * w_7[2][3] + g * w_7[2][4]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0] + d * w_7[3][1] + e * w_7[3][2] + f * w_7[3][3] + g * w_7[3][4]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0] + d * w_7[4][1] + e * w_7[4][2] + f * w_7[4][3] + g * w_7[4][4]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0] + d * w_7[5][1] + e * w_7[5][2] + f * w_7[5][3] + g * w_7[5][4]) % Q;
}

/* 256 * 7 --> 256 * 1 */
static void ntt_butterfly_1792_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_16q(a[n2] + a[N2_1792 + n2] + a[N2_1792 * 2 + n2] + a[N2_1792 * 3 + n2] + a[N2_1792 * 4 + n2] + a[N2_1792 * 5 + n2] + a[N2_1792 * 6 + n2]);	
}

void ntt_1024_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1024_1792, bit_reverse_256);
}

void intt_1792_768(uint32_t *a)
{
	intt_core(a, N1_1792, N2_1792, 768, omega_256, omega_1792, ntt_butterfly_1792_768, INV_1792, bit_reverse_256);
}

void ntt_512_1536(uint32_t *a)
{
	ntt_core(a, N1_1536, N2_1536, omega_512, omega_1536, ntt_butterfly_512_1536, bit_reverse_512);
}

void ntt_1024_1536(uint32_t *a)
{
	ntt_core(a, N1_1536, N2_1536, omega_512, omega_1536, ntt_butterfly_1024_1536, bit_reverse_512);
}

void intt_1536_1536_inv(uint32_t *a)
{
	intt_core(a, N1_1536, N2_1536, 1536, omega_512_inv, omega_1536_inv, ntt_butterfly_1536_1536_inv, INV_1536, bit_reverse_512);
}

void ntt_768_768_inv(uint32_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256_inv, omega_768_inv, ntt_butterfly_768_768_inv, bit_reverse_256);
}

void intt_768_256(uint32_t *a)
{
	intt_core(a, N1_768, N2_768, 256, omega_256, omega_768, ntt_butterfly_768_256, INV_768, bit_reverse_256);
}

void ntt_1536_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1536_1792, bit_reverse_256);
}

void intt_1792_256(uint32_t *a)
{
	intt_core(a, N1_1792, N2_1792, 256, omega_256, omega_1792, ntt_butterfly_1792_256, INV_1792, bit_reverse_256);
}
