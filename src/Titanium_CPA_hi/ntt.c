/* ****************************** *
 * Titanium_CPA_hi                *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 1024=4*256 */
#define N1_1024 4
#define N2_1024 256

/* 2304=9*256 */
#define N1_2304 9
#define N2_2304 256

/* 2560=10*256 */
#define N1_2560 10
#define N2_2560 256

/* multiplication inverses of 1024, 2304, 2560 (in Montgomery form) */
#define INV_1024 507899
#define INV_2304 307653
#define INV_2560 498072

/* omega_n: n-th root of unity mod Q (in Montgomery form) */

static const uint32_t w_4[3][3]={{547990,431810,189291},
{431810,305471,431810},
{189291,431810,547990}};

static const uint32_t w_9[8][8]={{710110,36948,520240,13561,666660,648851,13610,33673},
{36948,13561,648851,33673,710110,520240,666660,13610},
{520240,648851,305471,520240,648851,305471,520240,648851},
{13561,33673,520240,13610,36948,648851,710110,666660},
{666660,710110,648851,36948,13610,520240,33673,13561},
{648851,520240,305471,648851,520240,305471,648851,520240},
{13610,666660,520240,710110,33673,648851,13561,36948},
{33673,13610,648851,666660,13561,520240,36948,710110}};

static const uint32_t w_10[9][9]={{396826,143206,316348,264497,431810,340455,594075,420933,472784},
{143206,264497,340455,420933,305471,143206,264497,340455,420933},
{316348,340455,472784,143206,431810,420933,396826,264497,594075},
{264497,420933,143206,340455,305471,264497,420933,143206,340455},
{431810,305471,431810,305471,431810,305471,431810,305471,431810},
{340455,143206,420933,264497,305471,340455,143206,420933,264497},
{594075,264497,396826,420933,431810,143206,472784,340455,316348},
{420933,340455,264497,143206,305471,420933,340455,264497,143206},
{472784,420933,594075,340455,431810,264497,316348,143206,396826}};

/* omega_256,1024,2304,2560, respectively (in Montgomery form) */
static const uint32_t omega_256[128]={305471,182135,540110,311183,587782,705227,153614,570435,71826,78501,385642,393889,420794,352119,668675,45363,130291,568995,570539,154592,412974,367284,47650,234751,671892,181018,260846,100382,402135,205869,400745,262305,510034,309168,643073,399541,324980,182486,635125,426268,710144,734752,355160,267267,177026,713596,192539,199377,111634,169124,68007,342824,91313,656840,112155,87503,148509,236679,221259,369957,601084,33603,639589,576004,547990,60198,68995,391820,688323,482439,140649,163297,605869,396264,425145,454462,490476,255643,397559,250570,429553,332776,261649,384969,581400,475300,428381,23920,604155,251566,201346,728659,709689,556971,642883,163263,493740,698093,175934,581834,735618,392136,429379,279373,28155,670896,409225,602244,389623,230133,144386,712782,196946,573142,108,312805,602550,661503,462796,175442,303715,202511,81986,451009,53578,528727,567547,609174};
static const uint32_t omega_1024[1024]={305471,454761,16768,338010,182135,544108,697221,88392,540110,572132,162540,586608,311183,529100,386247,649992,587782,84574,719401,730722,705227,355480,232665,465742,153614,238362,514716,393176,570435,242037,93612,519758,71826,543682,714136,674979,78501,34611,282002,581856,385642,364218,263003,157630,393889,301556,470025,23357,420794,86489,271261,113569,352119,447462,207936,674020,668675,477652,386837,173120,45363,31609,366587,582577,130291,612343,329489,518744,568995,18840,155357,236651,570539,417901,355393,85548,154592,417598,580301,705261,412974,133927,125290,265743,367284,286642,318005,268606,47650,212521,317164,321037,234751,306763,427690,688410,671892,19351,282177,140500,181018,129823,558236,257396,260846,196548,586218,388974,100382,171332,708260,323316,402135,237203,29409,332792,205869,127847,165944,444524,400745,98556,32690,719996,262305,451874,295818,351720,510034,586005,28791,25035,309168,70859,383047,399759,643073,684249,271170,696969,399541,274435,319836,415703,324980,266835,2013,454859,182486,400368,198330,650456,635125,515239,540288,135849,426268,495651,594625,596872,710144,560036,352072,367985,734752,147147,361880,733131,355160,428826,397543,582222,267267,732525,67695,193690,177026,14880,94526,590770,713596,499120,562456,20606,192539,442528,711914,603982,199377,209090,413591,439993,111634,29158,645632,587832,169124,660937,663752,262950,68007,721282,225088,186812,342824,212518,312091,589966,91313,318554,459684,231470,656840,371254,364383,542018,112155,172888,390332,184917,87503,511373,638411,173617,148509,453179,290730,595284,236679,617887,119740,465346,221259,347502,12925,475026,369957,382999,318591,522251,601084,459826,471592,461311,33603,52036,256437,113739,639589,691053,717519,497384,576004,74563,10982,138537,547990,626154,90898,354070,60198,50040,567606,619165,68995,180147,131524,485503,391820,489282,146580,140364,688323,524775,445482,546161,482439,371563,149621,121728,140649,432977,44074,63753,163297,392133,281284,104999,605869,441170,627379,687811,396264,631276,642109,528687,425145,71220,256217,479000,454462,248440,599151,140247,490476,691072,12367,268729,255643,245647,299874,574887,397559,609278,307541,268726,250570,514576,156436,586678,429553,152338,292489,620629,332776,178813,87573,629743,261649,79859,119146,198173,384969,700737,135700,174309,581400,351827,690971,578857,475300,96010,151090,393964,428381,382329,660183,126019,23920,635546,489869,401916,604155,491920,183752,329331,251566,724250,83009,284829,201346,589545,116683,456926,728659,165818,231458,636548,709689,527912,589182,240131,556971,330124,117967,416327,642883,362959,345877,214174,163263,334639,380022,445451,493740,312248,118172,25701,698093,88382,523200,731281,175934,380151,663590,726289,581834,348440,124521,439926,735618,136991,145547,605404,392136,286357,573351,12026,429379,595385,407470,411316,279373,559903,127169,494008,28155,424121,551479,627805,670896,546958,355604,442349,409225,429897,734042,421099,602244,209543,442333,382169,389623,460560,238224,281358,230133,607816,47142,90774,144386,116715,511038,71926,712782,597208,541039,668509,196946,521955,100548,452038,573142,395888,732741,432951,108,182628,640490,2801,312805,322778,229658,541872,602550,726989,290972,267225,661503,146296,397401,342100,462796,332895,380042,479271,175442,285460,531086,58168,303715,434489,389023,183241,202511,347717,376490,371087,81986,29498,483291,337733,451009,307665,478410,194053,53578,652116,493061,638621,528727,492785,171905,202641,567547,519396,196965,554084,609174,131677,6945,684780,431810,282520,720513,399271,555146,193173,40060,648889,197171,165149,574741,150673,426098,208181,351034,87289,149499,652707,17880,6559,32054,381801,504616,271539,583667,498919,222565,344105,166846,495244,643669,217523,665455,193599,23145,62302,658780,702670,455279,155425,351639,373063,474278,579651,343392,435725,267256,713924,316487,650792,466020,623712,385162,289819,529345,63261,68606,259629,350444,564161,691918,705672,370694,154704,606990,124938,407792,218537,168286,718441,581924,500630,166742,319380,381888,651733,582689,319683,156980,32020,324307,603354,611991,471538,369997,450639,419276,468675,689631,524760,420117,416244,502530,430518,309591,48871,65389,717930,455104,596781,556263,607458,179045,479885,476435,540733,151063,348307,636899,565949,29021,413965,335146,500078,707872,404489,531412,609434,571337,292757,336536,638725,704591,17285,474976,285407,441463,385561,227247,151276,708490,712246,428113,666422,354234,337522,94208,53032,466111,40312,337740,462846,417445,321578,412301,470446,735268,282422,554795,336913,538951,86825,102156,222042,196993,601432,311013,241630,142656,140409,27137,177245,385209,369296,2529,590134,375401,4150,382121,308455,339738,155059,470014,4756,669586,543591,560255,722401,642755,146511,23685,238161,174825,716675,544742,294753,25367,133299,537904,528191,323690,297288,625647,708123,91649,149449,568157,76344,73529,474331,669274,15999,512193,550469,394457,524763,425190,147315,645968,418727,277597,505811,80441,366027,372898,195263,625126,564393,346949,552364,649778,225908,98870,563664,588772,284102,446551,141997,500602,119394,617541,271935,516022,389779,724356,262255,367324,354282,418690,215030,136197,277455,265689,275970,703678,685245,480844,623542,97692,46228,19762,239897,161277,662718,726299,598744,189291,111127,646383,383211,677083,687241,169675,118116,668286,557134,605757,251778,345461,247999,590701,596917,48958,212506,291799,191120,254842,365718,587660,615553,596632,304304,693207,673528,573984,345148,455997,632282,131412,296111,109902,49470,341017,106005,95172,208594,312136,666061,481064,258281,282819,488841,138130,597034,246805,46209,724914,468552,481638,491634,437407,162394,339722,128003,429740,468555,486711,222705,580845,150603,307728,584943,444792,116652,404505,558468,649708,107538,475632,657422,618135,539108,352312,36544,601581,562972,155881,385454,46310,158424,261981,641271,586191,343317,308900,354952,77098,611262,713361,101735,247412,335365,133126,245361,553529,407950,485715,13031,654272,452452,535935,147736,620598,280355,8622,571463,505823,100733,27592,209369,148099,497150,180310,407157,619314,320954,94398,374322,391404,523107,574018,402642,357259,291830,243541,425033,619109,711580,39188,648899,214081,6000,561347,357130,73691,10992,155447,388841,612760,297355,1663,600290,591734,131877,345145,450924,163930,725255,307902,141896,329811,325965,457908,177378,610112,243273,709126,313160,185802,109476,66385,190323,381677,294932,328056,307384,3239,316182,135037,527738,294948,355112,347658,276721,499057,455923,507148,129465,690139,646507,592895,620566,226243,665355,24499,140073,196242,68772,540335,215326,636733,285243,164139,341393,4540,304330,737173,554653,96791,734480,424476,414503,507623,195409,134731,10292,446309,470056,75778,590985,339880,395181,274485,404386,357239,258010,561839,451821,206195,679113,433566,302792,348258,554040,534770,389564,360791,366194,655295,707783,253990,399548,286272,429616,258871,543228,683703,85165,244220,98660,208554,244496,565376,534640,169734,217885,540316,183197,128107,605604,730336,52501};
static const uint32_t omega_2304[2304]={305471,521055,352996,199493,545347,130984,698728,594304,246740,182135,246783,416657,147236,126135,57117,383536,139147,245589,540110,322345,391726,570547,437518,381856,561080,414170,591477,311183,708501,74733,614670,730754,528511,467565,581812,682505,587782,65240,449518,211847,94211,679218,355228,576325,247647,705227,650362,15457,252444,325949,141355,491525,23634,612942,153614,259540,688921,191158,60398,583366,310649,7908,367934,570435,563951,589703,220440,511730,366835,474737,622007,196297,71826,242793,36346,639776,524612,583568,675076,620471,666325,78501,521474,426379,86792,29166,555949,446374,21934,188514,385642,566056,273877,731133,383734,481758,575929,299706,44547,393889,571053,248118,324937,520155,605363,105484,230556,388319,420794,592004,236317,105730,97678,418930,10401,693698,440081,352119,577302,415238,518101,462062,59690,408339,492286,487723,668675,361624,70621,306252,356943,345282,152354,23029,262396,45363,420667,636627,307429,140772,260967,361688,419677,398134,130291,605511,175395,350873,417147,607853,414886,72855,693992,568995,83001,734201,159143,186185,217053,471057,457874,74049,570539,393886,554691,220771,105161,680757,638843,596997,188742,154592,432585,19390,321877,51097,728101,67388,368214,622993,412974,704022,713821,336054,695231,690972,318097,78845,185807,367284,711740,45495,403314,365333,392920,447094,262409,116265,47650,360188,348768,732973,97160,542882,695213,592800,154015,234751,412138,568164,711694,531892,475514,436079,643641,223173,671892,212398,150241,295223,661819,570331,734016,624715,220109,181018,52913,310631,647017,203852,726341,53001,53302,220394,260846,439035,545483,135447,709657,481309,338926,138937,574811,100382,420926,574651,702304,191221,404000,420372,502259,321671,402135,570596,704764,337003,710110,2847,44637,147468,654182,205869,667844,253036,605593,622623,606837,34589,641751,237047,400745,362346,322004,6474,656989,32346,204925,680235,3698,262305,286330,82662,359857,18056,419051,670335,567892,702768,510034,701504,251707,730037,304398,567161,402299,727771,479411,309168,40625,384450,700417,221457,160200,52815,513420,736723,643073,74425,409400,380732,329032,735855,332687,26357,718564,399541,431259,160196,30999,231197,197928,119928,119065,573230,324980,17396,505816,552243,140437,645720,502824,454057,637280,182486,686575,667132,56193,505007,563643,384433,607699,312251,635125,225612,703140,327079,406127,224534,721976,576564,76591,426268,218679,491889,534328,490400,523413,679751,313086,28248,710144,188283,600330,672180,308588,563710,12570,726928,305375,734752,215173,539471,523644,465063,206962,730818,140286,559447,355160,205453,610823,393084,604269,37056,88430,115446,4510,267267,69681,340459,389828,540789,339206,191495,423834,214701,177026,398975,293419,407456,100090,302920,616240,446162,340248,713596,583466,118768,427954,566751,378002,185232,180358,139678,192539,219562,146804,719131,542835,438875,410124,643023,539006,199377,649964,56608,556574,168719,66738,509519,104537,226585,111634,595011,416313,482903,185230,169450,367207,291782,326630,169124,63765,514959,283057,663745,15520,596046,162955,332965,68007,57835,613103,294427,6840,441310,419556,475481,256097,342824,17480,226671,580678,395917,572550,302665,700032,333510,91313,356427,480142,609637,560169,606543,642956,173588,80148,656840,694262,567013,332388,607454,450583,122109,217743,547912,112155,487421,496129,66296,310694,253338,40858,180670,366764,87503,220555,401659,186335,297872,363845,387459,154040,371101,148509,433548,110625,252892,557498,47248,379523,370675,36948,236679,605516,202665,150691,537680,340183,359086,236708,26401,221259,554870,459756,16543,277240,640910,73919,598800,437651,369957,544662,81399,106984,301465,53480,453925,654633,453780,601084,360810,54751,13149,198389,422379,389222,184789,713360,33603,425074,342132,666998,62638,266549,577395,185179,628577,639589,241995,107740,1003,309395,541402,733384,126911,603016,576004,708756,728222,727322,242408,148399,570889,90943,550290,547990,537567,461162,312057,314330,177495,7777,390741,359324,60198,229847,207838,347555,15519,590592,645360,13946,121541,68995,285420,280489,666212,199480,474445,504001,237886,552965,391820,345942,65589,141121,689851,102411,427877,146793,659137,688323,616071,261717,28502,620898,46059,530246,345602,423072,482439,603698,609227,535872,64004,343903,4098,232062,491952,140649,327406,715023,256233,347287,28409,113676,672864,352719,163297,723671,236441,44745,736500,164112,7714,47139,522318,605869,653365,173637,347394,611987,106011,155690,522829,443739,396264,253245,270917,70194,189237,642479,521154,155661,364663,425145,729366,331169,594557,152040,522316,594961,143613,272880,454462,634307,187926,127814,367011,697360,506042,310285,234495,490476,200636,143740,228257,383350,599265,24637,185056,695016,255643,78551,56893,636402,554841,301590,735230,610342,718834,397559,680646,33449,322439,167121,198618,196783,510627,249321,250570,427087,261819,584810,76134,145633,230745,681844,669093,429553,440325,208333,98161,104088,726863,688146,387994,122806,332776,511763,546817,38273,90419,641518,440827,734398,496300,261649,394911,246793,471197,484153,367201,259058,271936,466853,384969,581919,528802,580117,285347,619628,492289,504085,696022,581400,647300,272772,602711,387096,386081,11238,97729,697084,475300,6204,658971,520240,331672,388795,67774,261615,209475,428381,683766,92466,9360,177051,535325,29790,272840,236302,23920,698224,57331,76130,123817,685803,143049,145948,474193,604155,152581,523806,611330,209138,64945,315150,226089,355574,251566,698304,493651,559623,577783,89488,724811,555753,114671,201346,329675,556372,541573,191456,211128,596471,269062,274958,728659,161596,293789,213593,32242,374990,715247,3367,668874,709689,655837,384867,25611,336285,480543,584848,283386,246268,556971,122114,245013,347730,232688,219751,440329,230149,380384,642883,512727,643506,224164,178558,644412,4521,327261,661474,163263,538235,418029,257314,344813,543552,662988,310528,85255,493740,307748,406036,465501,383971,299794,524499,704547,628047,698093,80138,602300,357345,325947,130447,719054,122877,720010,175934,341455,661045,35340,314019,693144,367689,708767,50935,581834,65212,296806,448129,9051,703608,667708,248573,594664,735618,514651,77787,313723,553322,127055,651111,414098,198789,392136,594844,242776,680909,730570,262256,19084,127515,210827,429379,228610,96769,622211,571632,456860,441941,174625,574979,279373,477796,348330,555964,528184,158669,550113,319913,398656,28155,202922,77807,422803,489875,609187,317712,190898,116920,670896,678462,655690,320410,160170,626476,239950,13525,37250,409225,163563,699873,203605,116484,504795,144676,172234,68242,602244,51921,61230,697408,30553,10556,64506,132687,402237,389623,160000,436577,410609,339089,290658,94582,490809,542256,230133,293120,251272,569390,25488,402724,96597,421404,232539,144386,65136,619583,246859,93880,348506,41306,412219,272657,712782,567596,562946,269400,643848,614870,346992,631322,127918,196946,662348,506373,640997,548417,654582,175626,136185,311023,573142,582309,444019,448822,102268,385236,563575,13561,233594,108,589032,247211,539126,116576,269282,276,30742,304081,312805,707517,606245,492226,160483,121735,389790,333537,238571,602550,246283,638781,258849,606612,282001,65288,711310,649399,661503,321429,556829,84927,179390,21173,461706,329909,358046,462796,376521,217949,196874,269660,587326,527340,716460,720821,175442,607211,599823,118845,110631,285616,612192,486800,58319,303715,528484,320307,335689,179083,558638,366560,449449,572802,202511,48056,362669,609084,493231,480786,435608,286650,353380,81986,359358,245634,48259,732550,1961,373360,672599,381971,451009,233670,414612,53021,162382,156947,5697,105636,322283,53578,251136,564927,14559,515719,4411,464602,641792,460661,528727,171067,338953,286195,83653,603804,450070,273331,702373,567547,295700,314253,494818,288912,156551,57756,182237,65810,609174,246810,563915,393359,629557,86261,82216,139216,621915,431810,216226,384285,537788,191934,606297,38553,142977,490541,555146,490498,320624,590045,611146,680164,353745,598134,491692,197171,414936,345555,166734,299763,355425,176201,323111,145804,426098,28780,662548,122611,6527,208770,269716,155469,54776,149499,672041,287763,525434,643070,58063,382053,160956,489634,32054,86919,721824,484837,411332,595926,245756,713647,124339,583667,477741,48360,546123,676883,153915,426632,729373,369347,166846,173330,147578,516841,225551,370446,262544,115274,540984,665455,494488,700935,97505,212669,153713,62205,116810,70956,658780,215807,310902,650489,708115,181332,290907,715347,548767,351639,171225,463404,6148,353547,255523,161352,437575,692734,343392,166228,489163,412344,217126,131918,631797,506725,348962,316487,145277,500964,631551,639603,318351,726880,43583,297200,385162,159979,322043,219180,275219,677591,328942,244995,249558,68606,375657,666660,431029,380338,391999,584927,714252,474885,691918,316614,100654,429852,596509,476314,375593,317604,339147,606990,131770,561886,386408,320134,129428,322395,664426,43289,168286,654280,3080,578138,551096,520228,266224,279407,663232,166742,343395,182590,516510,632120,56524,98438,140284,548539,582689,304696,717891,415404,686184,9180,669893,369067,114288,324307,33259,23460,401227,42050,46309,419184,658436,551474,369997,25541,691786,333967,371948,344361,290187,474872,621016,689631,377093,388513,4308,640121,194399,42068,144481,583266,502530,325143,169117,25587,205389,261767,301202,93640,514108,65389,524883,587040,442058,75462,166950,3265,112566,517172,556263,684368,426650,90264,533429,10940,684280,683979,516887,476435,298246,191798,601834,27624,255972,398355,598344,162470,636899,316355,162630,34977,546060,333281,316909,235022,415610,335146,166685,32517,400278,27171,734434,692644,589813,83099,531412,69437,484245,131688,114658,130444,702692,95530,500234,336536,374935,415277,730807,80292,704935,532356,57046,733583,474976,450951,654619,377424,719225,318230,66946,169389,34513,227247,35777,485574,7244,432883,170120,334982,9510,257870,428113,696656,352831,36864,515824,577081,684466,223861,558,94208,662856,327881,356549,408249,1426,404594,710924,18717,337740,306022,577085,706282,506084,539353,617353,618216,164051,412301,719885,231465,185038,596844,91561,234457,283224,100001,554795,50706,70149,681088,232274,173638,352848,129582,425030,102156,511669,34141,410202,331154,512747,15305,160717,660690,311013,518602,245392,202953,246881,213868,57530,424195,709033,27137,548998,136951,65101,428693,173571,724711,10353,431906,2529,522108,197810,213637,272218,530319,6463,596995,177834,382121,531828,126458,344197,133012,700225,648851,621835,732771,470014,667600,396822,347453,196492,398075,545786,313447,522580,560255,338306,443862,329825,637191,434361,121041,291119,397033,23685,153815,618513,309327,170530,359279,552049,556923,597603,544742,517719,590477,18150,194446,298406,327157,94258,198275,537904,87317,680673,180707,568562,670543,227762,632744,510696,625647,142270,320968,254378,552051,567831,370074,445499,410651,568157,673516,222322,454224,73536,721761,141235,574326,404316,669274,679446,124178,442854,730441,295971,317725,261800,481184,394457,719801,510610,156603,341364,164731,434616,37249,403771,645968,380854,257139,127644,177112,130738,94325,563693,657133,80441,43019,170268,404893,129827,286698,615172,519538,189369,625126,249860,241152,670985,426587,483943,696423,556611,370517,649778,516726,335622,550946,439409,373436,349822,583241,366180,588772,303733,626656,484389,179783,690033,357758,366606,700333,500602,131765,534616,586590,199601,397098,378195,500573,710880,516022,182411,277525,720738,460041,96371,663362,138481,299630,367324,192619,655882,630297,435816,683801,283356,82648,283501,136197,376471,682530,724132,538892,314902,348059,552492,23921,703678,312207,395149,70283,674643,470732,159886,552102,108704,97692,495286,629541,736278,427886,195879,3897,610370,134265,161277,28525,9059,9959,494873,588882,166392,646338,186991,189291,199714,276119,425224,422951,559786,729504,346540,377957,677083,507434,529443,389726,721762,146689,91921,723335,615740,668286,451861,456792,71069,537801,262836,233280,499395,184316,345461,391339,671692,596160,47430,634870,309404,590488,78144,48958,121210,475564,708779,116383,691222,207035,391679,314209,254842,133583,128054,201409,673277,393378,733183,505219,245329,596632,409875,22258,481048,389994,708872,623605,64417,384562,573984,13610,500840,692536,781,573169,729567,690142,214963,131412,83916,563644,389887,125294,631270,581591,214452,293542,341017,484036,466364,667087,548044,94802,216127,581620,372618,312136,7915,406112,142724,585241,214965,142320,593668,464401,282819,102974,549355,609467,370270,39921,231239,426996,502786,246805,536645,593541,509024,353931,138016,712644,552225,42265,481638,658730,680388,100879,182440,435691,2051,126939,18447,339722,56635,703832,414842,570160,538663,540498,226654,487960,486711,310194,475462,152471,661147,591648,506536,55437,68188,307728,296956,528948,639120,633193,10418,49135,349287,614475,404505,225518,190464,699008,646862,95763,296454,2883,240981,475632,342370,490488,266084,253128,370080,478223,465345,270428,352312,155362,208479,157164,451934,117653,244992,233196,41259,155881,89981,464509,134570,350185,351200,726043,639552,40197,261981,731077,78310,217041,405609,348486,669507,475666,527806,308900,53515,644815,727921,560230,201956,707491,464441,500979,713361,39057,679950,661151,613464,51478,594232,591333,263088,133126,584700,213475,125951,528143,672336,422131,511192,381707,485715,38977,243630,177658,159498,647793,12470,181528,622610,535935,407606,180909,195708,545825,526153,140810,468219,462323,8622,575685,443492,523688,705039,362291,22034,733914,68407,27592,81444,352414,711670,400996,256738,152433,453895,491013,180310,615167,492268,389551,504593,517530,296952,507132,356897,94398,224554,93775,513117,558723,92869,732760,410020,75807,574018,199046,319252,479967,392468,193729,74293,426753,652026,243541,429533,331245,271780,353310,437487,212782,32734,109234,39188,657143,134981,379936,411334,606834,18227,614404,17271,561347,395826,76236,701941,423262,44137,369592,28514,686346,155447,672069,440475,289152,728230,33673,69573,488708,142617,1663,222630,659494,423558,183959,610226,86170,323183,538492,345145,142437,494505,56372,6711,475025,718197,609766,526454,307902,508671,640512,115070,165649,280421,295340,562656,162302,457908,259485,388951,181317,209097,578612,187168,417368,338625,709126,534359,659474,314478,247406,128094,419569,546383,620361,66385,58819,81591,416871,577111,110805,497331,723756,700031,328056,573718,37408,533676,620797,232486,592605,565047,669039,135037,685360,676051,39873,706728,726725,672775,604594,335044,347658,577281,300704,326672,398192,446623,642699,246472,195025,507148,444161,486009,167891,711793,334557,640684,315877,504742,592895,672145,117698,490422,643401,388775,695975,325062,464624,24499,169685,174335,467881,93433,122411,390289,105959,609363,540335,74933,230908,96284,188864,82699,561655,601096,426258,164139,154972,293262,288459,635013,352045,173706,723720,503687,737173,148249,490070,198155,620705,467999,737005,706539,433200,424476,29764,131036,245055,576798,615546,347491,403744,498710,134731,490998,98500,478432,130669,455280,671993,25971,87882,75778,415852,180452,652354,557891,716108,275575,407372,379235,274485,360760,519332,540407,467621,149955,209941,20821,16460,561839,130070,137458,618436,626650,451665,125089,250481,678962,433566,208797,416974,401592,558198,178643,370721,287832,164479,534770,689225,374612,128197,244050,256495,301673,450631,383901,655295,377923,491647,689022,4731,735320,363921,64682,355310,286272,503611,322669,684260,574899,580334,731584,631645,414998,683703,486145,172354,722722,221562,732870,272679,95489,276620,208554,566214,398328,451086,653628,133477,287211,463950,34908,169734,441581,423028,242463,448369,580730,679525,555044,671471,128107,490471,173366,343922,107724,651020,655065,598065,115366};
static const uint32_t omega_2560[2560]={305471,168287,247895,533965,166483,16768,492281,335136,269868,6433,182135,408572,129740,624329,617604,697221,288441,324955,276163,29480,540110,465388,31245,341609,476745,162540,268901,34984,110748,378411,311183,309952,322662,442982,401537,386247,144630,618526,456515,551691,587782,19295,691387,145041,98605,719401,736822,47862,40072,13894,705227,595682,482154,596017,505048,232665,329461,630322,527577,196503,153614,129875,523513,42015,736504,514716,19646,134353,417984,348197,570435,237931,416437,17989,104745,93612,690697,86882,582901,354781,71826,707209,273358,321970,457314,714136,244960,377403,719878,36541,78501,228024,76118,707814,94620,282002,360293,89781,569739,397245,385642,323368,658494,553536,438765,263003,736734,288342,595495,255893,393889,374175,492673,135239,7554,470025,429570,658004,619087,398017,420794,243120,713833,536772,538783,271261,20200,698214,54788,416560,352119,710817,735612,405338,120008,207936,479375,683405,442470,527208,668675,547241,415718,642309,679918,386837,140934,396752,191289,393715,45363,300654,395904,698952,585006,366587,517714,473225,197087,367391,130291,191005,365503,731943,310857,329489,352729,719492,18965,118625,568995,84500,657805,90491,640269,155357,728775,120765,418130,217321,570539,154804,497309,201169,606741,355393,8010,162259,500593,610469,154592,71264,433312,687047,409658,580301,221113,261869,551395,257235,412974,567026,304273,90817,620732,125290,452265,503337,685752,530237,367284,690795,221228,148682,470679,318005,32286,580015,265392,39471,47650,351308,246037,48252,649947,317164,654871,266324,173591,432104,234751,661291,551010,572054,170306,427690,232411,688446,205952,136909,671892,67225,478608,98385,583320,282177,284219,736289,566048,362884,181018,712981,452136,386680,301870,558236,396826,458246,110975,629414,260846,397851,539299,608,81166,586218,673901,609475,55850,262451,100382,85954,303799,313721,478998,708260,149309,231821,692142,427726,402135,92587,609644,197249,393868,29409,533057,637033,218116,140685,205869,564802,550636,119532,503331,165944,15146,300002,434978,21805,400745,338724,719751,584674,603597,32690,682453,295979,637627,69438,262305,231258,85850,386926,232849,295818,206264,624809,177227,616765,510034,146447,9821,508308,37295,28791,77065,666892,660880,333650,309168,722456,230329,211634,628658,383047,377113,171858,208030,21422,643073,267753,357082,352324,284659,271170,776,627451,263146,345954,399541,478727,577497,108717,633562,319836,390706,359125,399508,568907,324980,475947,332490,328931,671131,2013,397268,657917,454681,670648,182486,588819,402683,136640,468638,198330,657016,302872,367014,155146,635125,70116,18129,191342,315906,540288,649218,566658,371559,201652,426268,163842,263244,480300,702603,594625,86395,171075,202938,263258,710144,429920,505856,437541,390635,352072,571153,18497,124056,205071,734752,610666,18398,394596,184801,361880,444731,45683,498590,588027,355160,711761,434786,345412,138015,397543,643698,101386,559522,233816,267267,277651,654970,733065,193861,67695,400686,634006,447016,168828,177026,160660,580589,104343,655964,94526,2674,400625,264498,2584,713596,648224,467916,562746,606003,562456,57983,733945,904,411713,192539,60981,450243,63638,361120,711914,418832,577815,379144,653988,199377,677949,606610,311227,189712,413591,690623,557206,128360,508011,111634,705262,433011,169087,5454,645632,44284,702296,294138,641662,169124,507573,504262,704950,682392,663752,193195,614206,733503,538514,68007,151305,139341,259275,200254,225088,324442,69439,594700,685747,342824,306682,143206,622448,596897,312091,576683,121314,57297,530804,91313,337708,681129,361756,515487,459684,336897,216349,411677,22815,656840,46551,3298,639144,12449,364383,39167,7067,58199,277727,112155,622022,554579,604680,223347,390332,643884,732533,307161,107715,87503,561516,213827,399984,273512,638411,406925,474958,421161,580720,148509,474262,580475,549925,453888,290730,303118,297993,630009,444563,236679,84381,178693,565094,288884,119740,337077,327688,381506,566713,221259,130993,551499,174108,493846,12925,68988,352598,675326,200667,369957,21744,31237,631573,527238,318591,173572,14847,446832,202471,601084,63428,599865,378473,275805,471592,34868,628821,4638,730720,33603,399316,155233,62250,534766,256437,582924,627056,203139,719363,639589,472024,596994,114042,425256,717519,383720,682805,71340,627778,576004,33095,380005,43774,18195,10982,83659,543109,514081,548468,547990,178595,430748,723103,3842,90898,265330,74849,623291,639102,60198,445151,305474,428191,136800,567606,663032,485120,734890,32473,68995,467520,170344,524923,545530,131524,105804,416880,550055,165659,391820,532093,188207,35634,144165,146580,718777,498303,299911,415554,688323,609103,268118,29892,352584,445482,473350,458726,407879,548958,482439,219343,272957,479436,315632,149621,719721,197477,239985,433561,140649,36145,423380,146944,59192,44074,203760,697978,498635,62901,163297,479095,510211,735163,90745,281284,579727,382162,382657,504519,605869,258386,350780,214355,431666,627379,660979,63110,329438,358047,396264,184349,524664,717102,383833,642109,556208,174600,355804,225370,425145,685724,70549,175369,131052,256217,446843,172411,439496,678299,454462,129681,182330,344869,281375,599151,452925,174299,575125,558447,490476,508895,510976,655393,515479,12367,387390,372400,316348,2678,255643,607892,293199,392620,289652,299874,650716,92412,685718,288022,397559,63770,400,247420,424474,307541,342764,269569,153263,686909,250570,529704,148189,276326,388352,156436,327133,222531,475420,633203,429553,168256,265584,453145,310380,292489,322090,531540,694022,116038,332776,284652,156248,505758,303195,87573,236174,324974,693420,554680,261649,415314,539871,649331,525962,119146,485755,206068,356117,308384,384969,17676,21731,133788,621464,135700,624482,601650,192343,529570,581400,569123,606043,587198,542799,690971,477549,512398,723962,203400,475300,558977,449667,297178,310211,151090,190673,602513,246919,520085,428381,622965,658639,90265,721661,660183,160569,561165,33580,127041,23920,50096,168535,106383,443244,489869,22843,379247,238466,563041,604155,451569,662651,654957,98335,183752,413438,706577,324803,624512,251566,555955,128699,385923,91676,83009,509692,8631,140874,359639,201346,458176,436317,518267,704691,116683,178780,729500,16253,358048,728659,638838,44357,636858,294190,231458,209560,599163,17979,467200,709689,332800,152041,4769,37605,589182,147984,702484,115513,560998,556971,167321,608841,179786,393296,117967,88261,366824,406262,544092,642883,518869,266049,187810,48118,345877,609961,135281,697086,389257,163263,236880,540486,108138,607198,380022,533522,371698,693135,194073,493740,168543,553700,392751,333818,118172,399384,639663,1700,314254,698093,385448,719466,224067,98407,523200,696282,39399,445483,68464,175934,664853,468714,392796,545973,663590,166718,715088,391451,266984,581834,321477,262961,47202,369110,124521,677017,472490,664054,306269,735618,187865,635099,275218,735192,145547,190407,659163,266929,732134,392136,137730,36936,138508,591896,573351,714517,75123,276677,568599,429379,576725,73565,713810,264497,407470,259107,391250,548160,652389,279373,171823,370701,334489,496355,127169,545463,716770,620843,157085,28155,273492,626040,164517,496445,551479,161737,251438,34412,199306,670896,40974,498098,726069,142715,355604,101660,212908,163313,636448,409225,423061,281403,321558,644840,734042,540136,260286,51463,387404,602244,43665,651190,606789,90171,442333,700515,335286,731291,349931,389623,168468,691629,221002,230074,238224,487080,472686,195465,175112,230133,680223,22534,151251,622036,47142,331997,134578,4197,126163,144386,615056,153349,518920,260731,511038,620015,677119,461854,573229,712782,660821,628932,36433,306610,541039,339604,526794,191411,395450,196946,685680,190789,84440,620692,100548,704730,546311,209107,429552,573142,548376,196171,390624,382132,732741,140907,269459,453863,90946,108,509172,424266,473795,181020,640490,623833,163347,141382,378950,312805,502231,222820,691045,7225,229658,570732,163592,477247,399324,602550,11757,378715,351766,603061,290972,379079,429462,148832,194821,661503,239774,339911,90000,373425,397401,629592,444676,195983,569249,462796,344894,481159,164880,241746,380042,545893,614106,671648,63755,175442,65614,256269,36639,212847,531086,192016,216712,156978,588659,303715,409219,640534,503593,254276,389023,534619,54918,128331,453209,202511,625826,548244,556891,117837,376490,265734,177287,653878,499977,81986,356148,290695,465789,611060,483291,303979,425060,448827,514877,451009,316263,503062,699971,146251,478410,639465,542780,273714,689630,53578,36755,432055,167578,509760,493061,80324,139127,643002,260700,528727,539195,83735,294,403038,171905,347694,1256,187074,182690,567547,221033,212385,319044,343183,196965,365656,715989,543260,570618,609174,275171,595528,165713,646406,6945,56464,126144,464410,89856,431810,568994,489386,203316,570798,720513,245000,402145,467413,730848,555146,328709,607541,112952,119677,40060,448840,412326,461118,707801,197171,271893,706036,395672,260536,574741,468380,702297,626533,358870,426098,427329,414619,294299,335744,351034,592651,118755,280766,185590,149499,717986,45894,592240,638676,17880,459,689419,697209,723387,32054,141599,255127,141264,232233,504616,407820,106959,209704,540778,583667,607406,213768,695266,777,222565,717635,602928,319297,389084,166846,499350,320844,719292,632536,643669,46584,650399,154380,382500,665455,30072,463923,415311,279967,23145,492321,359878,17403,700740,658780,509257,661163,29467,642661,455279,376988,647500,167542,340036,351639,413913,78787,183745,298516,474278,547,448939,141786,481388,343392,363106,244608,602042,729727,267256,307711,79277,118194,339264,316487,494161,23448,200509,198498,466020,717081,39067,682493,320721,385162,26464,1669,331943,617273,529345,257906,53876,294811,210073,68606,190040,321563,94972,57363,350444,596347,340529,545992,343566,691918,436627,341377,38329,152275,370694,219567,264056,540194,369890,606990,546276,371778,5338,426424,407792,384552,17789,718316,618656,168286,652781,79476,646790,97012,581924,8506,616516,319151,519960,166742,582477,239972,536112,130540,381888,729271,575022,236688,126812,582689,666017,303969,50234,327623,156980,516168,475412,185886,480046,324307,170255,433008,646464,116549,611991,285016,233944,51529,207044,369997,46486,516053,588599,266602,419276,704995,157266,471889,697810,689631,385973,491244,689029,87334,420117,82410,470957,563690,305177,502530,75990,186271,165227,566975,309591,504870,48835,531329,600372,65389,670056,258673,638896,153961,455104,453062,992,171233,374397,556263,24300,285145,350601,435411,179045,340455,279035,626306,107867,476435,339430,197982,736673,656115,151063,63380,127806,681431,474830,636899,651327,433482,423560,258283,29021,587972,505460,45139,309555,335146,644694,127637,540032,343413,707872,204224,100248,519165,596596,531412,172479,186645,617749,233950,571337,722135,437279,302303,715476,336536,398557,17530,152607,133684,704591,54828,441302,99654,667843,474976,506023,651431,350355,504432,441463,531017,112472,560054,120516,227247,590834,727460,228973,699986,708490,660216,70389,76401,403631,428113,14825,506952,525647,108623,354234,360168,565423,529251,715859,94208,469528,380199,384957,452622,466111,736505,109830,474135,391327,337740,258554,159784,628564,103719,417445,346575,378156,337773,168374,412301,261334,404791,408350,66150,735268,340013,79364,282600,66633,554795,148462,334598,600641,268643,538951,80265,434409,370267,582135,102156,667165,719152,545939,421375,196993,88063,170623,365722,535629,311013,573439,474037,256981,34678,142656,650886,566206,534343,474023,27137,307361,231425,299740,346646,385209,166128,718784,613225,532210,2529,126615,718883,342685,552480,375401,292550,691598,238691,149254,382121,25520,302495,391869,599266,339738,93583,635895,177759,503465,470014,459630,82311,4216,543420,669586,336595,103275,290265,568453,560255,576621,156692,632938,81317,642755,734607,336656,472783,734697,23685,89057,269365,174535,131278,174825,679298,3336,736377,325568,544742,676300,287038,673643,376161,25367,318449,159466,358137,83293,537904,59332,130671,426054,547569,323690,46658,180075,608921,229270,625647,32019,304270,568194,731827,91649,692997,34985,443143,95619,568157,229708,233019,32331,54889,73529,544086,123075,3778,198767,669274,585976,597940,478006,537027,512193,412839,667842,142581,51534,394457,430599,594075,114833,140384,425190,160598,615967,679984,206477,645968,399573,56152,375525,221794,277597,400384,520932,325604,714466,80441,690730,733983,98137,724832,372898,698114,730214,679082,459554,625126,115259,182702,132601,513934,346949,93397,4748,430120,629566,649778,175765,523454,337297,463769,98870,330356,262323,316120,156561,588772,263019,156806,187356,283393,446551,434163,439288,107272,292718,500602,652900,558588,172187,448397,617541,400204,409593,355775,170568,516022,606288,185782,563173,243435,724356,668293,384683,61955,536614,367324,715537,706044,105708,210043,418690,563709,722434,290449,534810,136197,673853,137416,358808,461476,265689,702413,108460,732643,6561,703678,337965,582048,675031,202515,480844,154357,110225,534142,17918,97692,265257,140287,623239,312025,19762,353561,54476,665941,109503,161277,704186,357276,693507,719086,726299,653622,194172,223200,188813,189291,558686,306533,14178,733439,646383,471951,662432,113990,98179,677083,292130,431807,309090,600481,169675,74249,252161,2391,704808,668286,269761,566937,212358,191751,605757,631477,320401,187226,571622,345461,205188,549074,701647,593116,590701,18504,238978,437370,321727,48958,128178,469163,707389,384697,291799,263931,278555,329402,188323,254842,517938,464324,257845,421649,587660,17560,539804,497296,303720,596632,701136,313901,590337,678089,693207,533521,39303,238646,674380,573984,258186,227070,2118,646536,455997,157554,355119,354624,232762,131412,478895,386501,522926,305615,109902,76302,674171,407843,379234,341017,552932,212617,20179,353448,95172,181073,562681,381477,511911,312136,51557,666732,561912,606229,481064,290438,564870,297785,58982,282819,607600,554951,392412,455906,138130,284356,562982,162156,178834,246805,228386,226305,81888,221802,724914,349891,364881,420933,734603,481638,129389,444082,344661,447629,437407,86565,644869,51563,449259,339722,673511,736881,489861,312807,429740,394517,467712,584018,50372,486711,207577,589092,460955,348929,580845,410148,514750,261861,104078,307728,569025,471697,284136,426901,444792,415191,205741,43259,621243,404505,452629,581033,231523,434086,649708,501107,412307,43861,182601,475632,321967,197410,87950,211319,618135,251526,531213,381164,428897,352312,719605,715550,603493,115817,601581,112799,135631,544938,207711,155881,168158,131238,150083,194482,46310,259732,224883,13319,533881,261981,178304,287614,440103,427070,586191,546608,134768,490362,217196,308900,114316,78642,647016,15620,77098,576712,176116,703701,610240,713361,687185,568746,630898,294037,247412,714438,358034,498815,174240,133126,285712,74630,82324,638946,553529,323843,30704,412478,112769,485715,181326,608582,351358,645605,654272,227589,728650,596407,377642,535935,279105,300964,219014,32590,620598,558501,7781,721028,379233,8622,98443,692924,100423,443091,505823,527721,138118,719302,270081,27592,404481,585240,732512,699676,148099,589297,34797,621768,176283,180310,569960,128440,557495,343985,619314,649020,370457,331019,193189,94398,218412,471232,549471,689163,391404,127320,602000,40195,348024,574018,500401,196795,629143,130083,357259,203759,365583,44146,543208,243541,568738,183581,344530,403463,619109,337897,97618,735581,423027,39188,351833,17815,513214,638874,214081,40999,697882,291798,668817,561347,72428,268567,344485,191308,73691,570563,22193,345830,470297,155447,415804,474320,690079,368171,612760,60264,264791,73227,431012,1663,549416,102182,462063,2089,591734,546874,78118,470352,5147,345145,599551,700345,598773,145385,163930,22764,662158,460604,168682,307902,160556,663716,23471,472784,329811,478174,346031,189121,84892,457908,565458,366580,402792,240926,610112,191818,20511,116438,580196,709126,463789,111241,572764,240836,185802,575544,485843,702869,537975,66385,696307,239183,11212,594566,381677,635621,524373,573968,100833,328056,314220,455878,415723,92441,3239,197145,476995,685818,349877,135037,693616,86091,130492,647110,294948,36766,401995,5990,387350,347658,568813,45652,516279,507207,499057,250201,264595,541816,562169,507148,57058,714747,586030,115245,690139,405284,602703,733084,611118,592895,122225,583932,218361,476550,226243,117266,60162,275427,164052,24499,76460,108349,700848,430671,196242,397677,210487,545870,341831,540335,51601,546492,652841,116589,636733,32551,190970,528174,307729,164139,188905,541110,346657,355149,4540,596374,467822,283418,646335,737173,228109,313015,263486,556261,96791,113448,573934,595899,358331,424476,235050,514461,46236,730056,507623,166549,573689,260034,337957,134731,725524,358566,385515,134220,446309,358202,307819,588449,542460,75778,497507,397370,647281,363856,339880,107689,292605,541298,168032,274485,392387,256122,572401,495535,357239,191388,123175,65633,673526,561839,671667,481012,700642,524434,206195,545265,520569,580303,148622,433566,328062,96747,233688,483005,348258,202662,682363,608950,284072,534770,111455,189037,180390,619444,360791,471547,559994,83403,237304,655295,381133,446586,271492,126221,253990,433302,312221,288454,222404,286272,421018,234219,37310,591030,258871,97816,194501,463567,47651,683703,700526,305226,569703,227521,244220,656957,598154,94279,476581,208554,198086,653546,736987,334243,565376,389587,736025,550207,554591,169734,516248,524896,418237,394098,540316,371625,21292,194021,166663,128107,462110,141753,571568,90875,730336,680817,611137,272871,647425};

/* multiplication inverses of omega */

/* (in Montgomery form) */
static const uint32_t w_4_inv[3][3]={{189291,431810,547990},
{431810,305471,431810},
{547990,431810,189291}};

static const uint32_t w_9_inv[8][8]={{33673,13610,648851,666660,13561,520240,36948,710110},
{13610,666660,520240,710110,33673,648851,13561,36948},
{648851,520240,305471,648851,520240,305471,648851,520240},
{666660,710110,648851,36948,13610,520240,33673,13561},
{13561,33673,520240,13610,36948,648851,710110,666660},
{520240,648851,305471,520240,648851,305471,520240,648851},
{36948,13561,648851,33673,710110,520240,666660,13610},
{710110,36948,520240,13561,666660,648851,13610,33673}};

static const uint32_t omega_256_inv[128]={305471,128107,169734,208554,683703,286272,655295,534770,433566,561839,274485,75778,134731,424476,737173,164139,540335,24499,592895,507148,347658,135037,328056,66385,709126,457908,307902,345145,1663,155447,561347,39188,243541,574018,94398,180310,27592,8622,535935,485715,133126,713361,308900,261981,155881,352312,475632,404505,307728,486711,339722,481638,246805,282819,312136,341017,131412,573984,596632,254842,48958,345461,668286,677083,189291,161277,97692,703678,136197,367324,516022,500602,588772,649778,625126,80441,645968,394457,669274,568157,625647,537904,544742,23685,560255,470014,382121,2529,27137,311013,102156,554795,412301,337740,94208,428113,227247,474976,336536,531412,335146,636899,476435,556263,65389,502530,689631,369997,324307,582689,166742,168286,606990,691918,68606,385162,316487,343392,351639,658780,665455,166846,583667,32054,149499,426098,197171,555146};
static const uint32_t omega_1024_inv[1024]={305471,52501,730336,605604,128107,183197,540316,217885,169734,534640,565376,244496,208554,98660,244220,85165,683703,543228,258871,429616,286272,399548,253990,707783,655295,366194,360791,389564,534770,554040,348258,302792,433566,679113,206195,451821,561839,258010,357239,404386,274485,395181,339880,590985,75778,470056,446309,10292,134731,195409,507623,414503,424476,734480,96791,554653,737173,304330,4540,341393,164139,285243,636733,215326,540335,68772,196242,140073,24499,665355,226243,620566,592895,646507,690139,129465,507148,455923,499057,276721,347658,355112,294948,527738,135037,316182,3239,307384,328056,294932,381677,190323,66385,109476,185802,313160,709126,243273,610112,177378,457908,325965,329811,141896,307902,725255,163930,450924,345145,131877,591734,600290,1663,297355,612760,388841,155447,10992,73691,357130,561347,6000,214081,648899,39188,711580,619109,425033,243541,291830,357259,402642,574018,523107,391404,374322,94398,320954,619314,407157,180310,497150,148099,209369,27592,100733,505823,571463,8622,280355,620598,147736,535935,452452,654272,13031,485715,407950,553529,245361,133126,335365,247412,101735,713361,611262,77098,354952,308900,343317,586191,641271,261981,158424,46310,385454,155881,562972,601581,36544,352312,539108,618135,657422,475632,107538,649708,558468,404505,116652,444792,584943,307728,150603,580845,222705,486711,468555,429740,128003,339722,162394,437407,491634,481638,468552,724914,46209,246805,597034,138130,488841,282819,258281,481064,666061,312136,208594,95172,106005,341017,49470,109902,296111,131412,632282,455997,345148,573984,673528,693207,304304,596632,615553,587660,365718,254842,191120,291799,212506,48958,596917,590701,247999,345461,251778,605757,557134,668286,118116,169675,687241,677083,383211,646383,111127,189291,598744,726299,662718,161277,239897,19762,46228,97692,623542,480844,685245,703678,275970,265689,277455,136197,215030,418690,354282,367324,262255,724356,389779,516022,271935,617541,119394,500602,141997,446551,284102,588772,563664,98870,225908,649778,552364,346949,564393,625126,195263,372898,366027,80441,505811,277597,418727,645968,147315,425190,524763,394457,550469,512193,15999,669274,474331,73529,76344,568157,149449,91649,708123,625647,297288,323690,528191,537904,133299,25367,294753,544742,716675,174825,238161,23685,146511,642755,722401,560255,543591,669586,4756,470014,155059,339738,308455,382121,4150,375401,590134,2529,369296,385209,177245,27137,140409,142656,241630,311013,601432,196993,222042,102156,86825,538951,336913,554795,282422,735268,470446,412301,321578,417445,462846,337740,40312,466111,53032,94208,337522,354234,666422,428113,712246,708490,151276,227247,385561,441463,285407,474976,17285,704591,638725,336536,292757,571337,609434,531412,404489,707872,500078,335146,413965,29021,565949,636899,348307,151063,540733,476435,479885,179045,607458,556263,596781,455104,717930,65389,48871,309591,430518,502530,416244,420117,524760,689631,468675,419276,450639,369997,471538,611991,603354,324307,32020,156980,319683,582689,651733,381888,319380,166742,500630,581924,718441,168286,218537,407792,124938,606990,154704,370694,705672,691918,564161,350444,259629,68606,63261,529345,289819,385162,623712,466020,650792,316487,713924,267256,435725,343392,579651,474278,373063,351639,155425,455279,702670,658780,62302,23145,193599,665455,217523,643669,495244,166846,344105,222565,498919,583667,271539,504616,381801,32054,6559,17880,652707,149499,87289,351034,208181,426098,150673,574741,165149,197171,648889,40060,193173,555146,399271,720513,282520,431810,684780,6945,131677,609174,554084,196965,519396,567547,202641,171905,492785,528727,638621,493061,652116,53578,194053,478410,307665,451009,337733,483291,29498,81986,371087,376490,347717,202511,183241,389023,434489,303715,58168,531086,285460,175442,479271,380042,332895,462796,342100,397401,146296,661503,267225,290972,726989,602550,541872,229658,322778,312805,2801,640490,182628,108,432951,732741,395888,573142,452038,100548,521955,196946,668509,541039,597208,712782,71926,511038,116715,144386,90774,47142,607816,230133,281358,238224,460560,389623,382169,442333,209543,602244,421099,734042,429897,409225,442349,355604,546958,670896,627805,551479,424121,28155,494008,127169,559903,279373,411316,407470,595385,429379,12026,573351,286357,392136,605404,145547,136991,735618,439926,124521,348440,581834,726289,663590,380151,175934,731281,523200,88382,698093,25701,118172,312248,493740,445451,380022,334639,163263,214174,345877,362959,642883,416327,117967,330124,556971,240131,589182,527912,709689,636548,231458,165818,728659,456926,116683,589545,201346,284829,83009,724250,251566,329331,183752,491920,604155,401916,489869,635546,23920,126019,660183,382329,428381,393964,151090,96010,475300,578857,690971,351827,581400,174309,135700,700737,384969,198173,119146,79859,261649,629743,87573,178813,332776,620629,292489,152338,429553,586678,156436,514576,250570,268726,307541,609278,397559,574887,299874,245647,255643,268729,12367,691072,490476,140247,599151,248440,454462,479000,256217,71220,425145,528687,642109,631276,396264,687811,627379,441170,605869,104999,281284,392133,163297,63753,44074,432977,140649,121728,149621,371563,482439,546161,445482,524775,688323,140364,146580,489282,391820,485503,131524,180147,68995,619165,567606,50040,60198,354070,90898,626154,547990,138537,10982,74563,576004,497384,717519,691053,639589,113739,256437,52036,33603,461311,471592,459826,601084,522251,318591,382999,369957,475026,12925,347502,221259,465346,119740,617887,236679,595284,290730,453179,148509,173617,638411,511373,87503,184917,390332,172888,112155,542018,364383,371254,656840,231470,459684,318554,91313,589966,312091,212518,342824,186812,225088,721282,68007,262950,663752,660937,169124,587832,645632,29158,111634,439993,413591,209090,199377,603982,711914,442528,192539,20606,562456,499120,713596,590770,94526,14880,177026,193690,67695,732525,267267,582222,397543,428826,355160,733131,361880,147147,734752,367985,352072,560036,710144,596872,594625,495651,426268,135849,540288,515239,635125,650456,198330,400368,182486,454859,2013,266835,324980,415703,319836,274435,399541,696969,271170,684249,643073,399759,383047,70859,309168,25035,28791,586005,510034,351720,295818,451874,262305,719996,32690,98556,400745,444524,165944,127847,205869,332792,29409,237203,402135,323316,708260,171332,100382,388974,586218,196548,260846,257396,558236,129823,181018,140500,282177,19351,671892,688410,427690,306763,234751,321037,317164,212521,47650,268606,318005,286642,367284,265743,125290,133927,412974,705261,580301,417598,154592,85548,355393,417901,570539,236651,155357,18840,568995,518744,329489,612343,130291,582577,366587,31609,45363,173120,386837,477652,668675,674020,207936,447462,352119,113569,271261,86489,420794,23357,470025,301556,393889,157630,263003,364218,385642,581856,282002,34611,78501,674979,714136,543682,71826,519758,93612,242037,570435,393176,514716,238362,153614,465742,232665,355480,705227,730722,719401,84574,587782,649992,386247,529100,311183,586608,162540,572132,540110,88392,697221,544108,182135,338010,16768,454761};
static const uint32_t omega_2304_inv[2304]={305471,115366,598065,655065,651020,107724,343922,173366,490471,128107,671471,555044,679525,580730,448369,242463,423028,441581,169734,34908,463950,287211,133477,653628,451086,398328,566214,208554,276620,95489,272679,732870,221562,722722,172354,486145,683703,414998,631645,731584,580334,574899,684260,322669,503611,286272,355310,64682,363921,735320,4731,689022,491647,377923,655295,383901,450631,301673,256495,244050,128197,374612,689225,534770,164479,287832,370721,178643,558198,401592,416974,208797,433566,678962,250481,125089,451665,626650,618436,137458,130070,561839,16460,20821,209941,149955,467621,540407,519332,360760,274485,379235,407372,275575,716108,557891,652354,180452,415852,75778,87882,25971,671993,455280,130669,478432,98500,490998,134731,498710,403744,347491,615546,576798,245055,131036,29764,424476,433200,706539,737005,467999,620705,198155,490070,148249,737173,503687,723720,173706,352045,635013,288459,293262,154972,164139,426258,601096,561655,82699,188864,96284,230908,74933,540335,609363,105959,390289,122411,93433,467881,174335,169685,24499,464624,325062,695975,388775,643401,490422,117698,672145,592895,504742,315877,640684,334557,711793,167891,486009,444161,507148,195025,246472,642699,446623,398192,326672,300704,577281,347658,335044,604594,672775,726725,706728,39873,676051,685360,135037,669039,565047,592605,232486,620797,533676,37408,573718,328056,700031,723756,497331,110805,577111,416871,81591,58819,66385,620361,546383,419569,128094,247406,314478,659474,534359,709126,338625,417368,187168,578612,209097,181317,388951,259485,457908,162302,562656,295340,280421,165649,115070,640512,508671,307902,526454,609766,718197,475025,6711,56372,494505,142437,345145,538492,323183,86170,610226,183959,423558,659494,222630,1663,142617,488708,69573,33673,728230,289152,440475,672069,155447,686346,28514,369592,44137,423262,701941,76236,395826,561347,17271,614404,18227,606834,411334,379936,134981,657143,39188,109234,32734,212782,437487,353310,271780,331245,429533,243541,652026,426753,74293,193729,392468,479967,319252,199046,574018,75807,410020,732760,92869,558723,513117,93775,224554,94398,356897,507132,296952,517530,504593,389551,492268,615167,180310,491013,453895,152433,256738,400996,711670,352414,81444,27592,68407,733914,22034,362291,705039,523688,443492,575685,8622,462323,468219,140810,526153,545825,195708,180909,407606,535935,622610,181528,12470,647793,159498,177658,243630,38977,485715,381707,511192,422131,672336,528143,125951,213475,584700,133126,263088,591333,594232,51478,613464,661151,679950,39057,713361,500979,464441,707491,201956,560230,727921,644815,53515,308900,527806,475666,669507,348486,405609,217041,78310,731077,261981,40197,639552,726043,351200,350185,134570,464509,89981,155881,41259,233196,244992,117653,451934,157164,208479,155362,352312,270428,465345,478223,370080,253128,266084,490488,342370,475632,240981,2883,296454,95763,646862,699008,190464,225518,404505,614475,349287,49135,10418,633193,639120,528948,296956,307728,68188,55437,506536,591648,661147,152471,475462,310194,486711,487960,226654,540498,538663,570160,414842,703832,56635,339722,18447,126939,2051,435691,182440,100879,680388,658730,481638,42265,552225,712644,138016,353931,509024,593541,536645,246805,502786,426996,231239,39921,370270,609467,549355,102974,282819,464401,593668,142320,214965,585241,142724,406112,7915,312136,372618,581620,216127,94802,548044,667087,466364,484036,341017,293542,214452,581591,631270,125294,389887,563644,83916,131412,214963,690142,729567,573169,781,692536,500840,13610,573984,384562,64417,623605,708872,389994,481048,22258,409875,596632,245329,505219,733183,393378,673277,201409,128054,133583,254842,314209,391679,207035,691222,116383,708779,475564,121210,48958,78144,590488,309404,634870,47430,596160,671692,391339,345461,184316,499395,233280,262836,537801,71069,456792,451861,668286,615740,723335,91921,146689,721762,389726,529443,507434,677083,377957,346540,729504,559786,422951,425224,276119,199714,189291,186991,646338,166392,588882,494873,9959,9059,28525,161277,134265,610370,3897,195879,427886,736278,629541,495286,97692,108704,552102,159886,470732,674643,70283,395149,312207,703678,23921,552492,348059,314902,538892,724132,682530,376471,136197,283501,82648,283356,683801,435816,630297,655882,192619,367324,299630,138481,663362,96371,460041,720738,277525,182411,516022,710880,500573,378195,397098,199601,586590,534616,131765,500602,700333,366606,357758,690033,179783,484389,626656,303733,588772,366180,583241,349822,373436,439409,550946,335622,516726,649778,370517,556611,696423,483943,426587,670985,241152,249860,625126,189369,519538,615172,286698,129827,404893,170268,43019,80441,657133,563693,94325,130738,177112,127644,257139,380854,645968,403771,37249,434616,164731,341364,156603,510610,719801,394457,481184,261800,317725,295971,730441,442854,124178,679446,669274,404316,574326,141235,721761,73536,454224,222322,673516,568157,410651,445499,370074,567831,552051,254378,320968,142270,625647,510696,632744,227762,670543,568562,180707,680673,87317,537904,198275,94258,327157,298406,194446,18150,590477,517719,544742,597603,556923,552049,359279,170530,309327,618513,153815,23685,397033,291119,121041,434361,637191,329825,443862,338306,560255,522580,313447,545786,398075,196492,347453,396822,667600,470014,732771,621835,648851,700225,133012,344197,126458,531828,382121,177834,596995,6463,530319,272218,213637,197810,522108,2529,431906,10353,724711,173571,428693,65101,136951,548998,27137,709033,424195,57530,213868,246881,202953,245392,518602,311013,660690,160717,15305,512747,331154,410202,34141,511669,102156,425030,129582,352848,173638,232274,681088,70149,50706,554795,100001,283224,234457,91561,596844,185038,231465,719885,412301,164051,618216,617353,539353,506084,706282,577085,306022,337740,18717,710924,404594,1426,408249,356549,327881,662856,94208,558,223861,684466,577081,515824,36864,352831,696656,428113,257870,9510,334982,170120,432883,7244,485574,35777,227247,34513,169389,66946,318230,719225,377424,654619,450951,474976,733583,57046,532356,704935,80292,730807,415277,374935,336536,500234,95530,702692,130444,114658,131688,484245,69437,531412,83099,589813,692644,734434,27171,400278,32517,166685,335146,415610,235022,316909,333281,546060,34977,162630,316355,636899,162470,598344,398355,255972,27624,601834,191798,298246,476435,516887,683979,684280,10940,533429,90264,426650,684368,556263,517172,112566,3265,166950,75462,442058,587040,524883,65389,514108,93640,301202,261767,205389,25587,169117,325143,502530,583266,144481,42068,194399,640121,4308,388513,377093,689631,621016,474872,290187,344361,371948,333967,691786,25541,369997,551474,658436,419184,46309,42050,401227,23460,33259,324307,114288,369067,669893,9180,686184,415404,717891,304696,582689,548539,140284,98438,56524,632120,516510,182590,343395,166742,663232,279407,266224,520228,551096,578138,3080,654280,168286,43289,664426,322395,129428,320134,386408,561886,131770,606990,339147,317604,375593,476314,596509,429852,100654,316614,691918,474885,714252,584927,391999,380338,431029,666660,375657,68606,249558,244995,328942,677591,275219,219180,322043,159979,385162,297200,43583,726880,318351,639603,631551,500964,145277,316487,348962,506725,631797,131918,217126,412344,489163,166228,343392,692734,437575,161352,255523,353547,6148,463404,171225,351639,548767,715347,290907,181332,708115,650489,310902,215807,658780,70956,116810,62205,153713,212669,97505,700935,494488,665455,540984,115274,262544,370446,225551,516841,147578,173330,166846,369347,729373,426632,153915,676883,546123,48360,477741,583667,124339,713647,245756,595926,411332,484837,721824,86919,32054,489634,160956,382053,58063,643070,525434,287763,672041,149499,54776,155469,269716,208770,6527,122611,662548,28780,426098,145804,323111,176201,355425,299763,166734,345555,414936,197171,491692,598134,353745,680164,611146,590045,320624,490498,555146,490541,142977,38553,606297,191934,537788,384285,216226,431810,621915,139216,82216,86261,629557,393359,563915,246810,609174,65810,182237,57756,156551,288912,494818,314253,295700,567547,702373,273331,450070,603804,83653,286195,338953,171067,528727,460661,641792,464602,4411,515719,14559,564927,251136,53578,322283,105636,5697,156947,162382,53021,414612,233670,451009,381971,672599,373360,1961,732550,48259,245634,359358,81986,353380,286650,435608,480786,493231,609084,362669,48056,202511,572802,449449,366560,558638,179083,335689,320307,528484,303715,58319,486800,612192,285616,110631,118845,599823,607211,175442,720821,716460,527340,587326,269660,196874,217949,376521,462796,358046,329909,461706,21173,179390,84927,556829,321429,661503,649399,711310,65288,282001,606612,258849,638781,246283,602550,238571,333537,389790,121735,160483,492226,606245,707517,312805,304081,30742,276,269282,116576,539126,247211,589032,108,233594,13561,563575,385236,102268,448822,444019,582309,573142,311023,136185,175626,654582,548417,640997,506373,662348,196946,127918,631322,346992,614870,643848,269400,562946,567596,712782,272657,412219,41306,348506,93880,246859,619583,65136,144386,232539,421404,96597,402724,25488,569390,251272,293120,230133,542256,490809,94582,290658,339089,410609,436577,160000,389623,402237,132687,64506,10556,30553,697408,61230,51921,602244,68242,172234,144676,504795,116484,203605,699873,163563,409225,37250,13525,239950,626476,160170,320410,655690,678462,670896,116920,190898,317712,609187,489875,422803,77807,202922,28155,398656,319913,550113,158669,528184,555964,348330,477796,279373,574979,174625,441941,456860,571632,622211,96769,228610,429379,210827,127515,19084,262256,730570,680909,242776,594844,392136,198789,414098,651111,127055,553322,313723,77787,514651,735618,594664,248573,667708,703608,9051,448129,296806,65212,581834,50935,708767,367689,693144,314019,35340,661045,341455,175934,720010,122877,719054,130447,325947,357345,602300,80138,698093,628047,704547,524499,299794,383971,465501,406036,307748,493740,85255,310528,662988,543552,344813,257314,418029,538235,163263,661474,327261,4521,644412,178558,224164,643506,512727,642883,380384,230149,440329,219751,232688,347730,245013,122114,556971,246268,283386,584848,480543,336285,25611,384867,655837,709689,668874,3367,715247,374990,32242,213593,293789,161596,728659,274958,269062,596471,211128,191456,541573,556372,329675,201346,114671,555753,724811,89488,577783,559623,493651,698304,251566,355574,226089,315150,64945,209138,611330,523806,152581,604155,474193,145948,143049,685803,123817,76130,57331,698224,23920,236302,272840,29790,535325,177051,9360,92466,683766,428381,209475,261615,67774,388795,331672,520240,658971,6204,475300,697084,97729,11238,386081,387096,602711,272772,647300,581400,696022,504085,492289,619628,285347,580117,528802,581919,384969,466853,271936,259058,367201,484153,471197,246793,394911,261649,496300,734398,440827,641518,90419,38273,546817,511763,332776,122806,387994,688146,726863,104088,98161,208333,440325,429553,669093,681844,230745,145633,76134,584810,261819,427087,250570,249321,510627,196783,198618,167121,322439,33449,680646,397559,718834,610342,735230,301590,554841,636402,56893,78551,255643,695016,185056,24637,599265,383350,228257,143740,200636,490476,234495,310285,506042,697360,367011,127814,187926,634307,454462,272880,143613,594961,522316,152040,594557,331169,729366,425145,364663,155661,521154,642479,189237,70194,270917,253245,396264,443739,522829,155690,106011,611987,347394,173637,653365,605869,522318,47139,7714,164112,736500,44745,236441,723671,163297,352719,672864,113676,28409,347287,256233,715023,327406,140649,491952,232062,4098,343903,64004,535872,609227,603698,482439,423072,345602,530246,46059,620898,28502,261717,616071,688323,659137,146793,427877,102411,689851,141121,65589,345942,391820,552965,237886,504001,474445,199480,666212,280489,285420,68995,121541,13946,645360,590592,15519,347555,207838,229847,60198,359324,390741,7777,177495,314330,312057,461162,537567,547990,550290,90943,570889,148399,242408,727322,728222,708756,576004,603016,126911,733384,541402,309395,1003,107740,241995,639589,628577,185179,577395,266549,62638,666998,342132,425074,33603,713360,184789,389222,422379,198389,13149,54751,360810,601084,453780,654633,453925,53480,301465,106984,81399,544662,369957,437651,598800,73919,640910,277240,16543,459756,554870,221259,26401,236708,359086,340183,537680,150691,202665,605516,236679,36948,370675,379523,47248,557498,252892,110625,433548,148509,371101,154040,387459,363845,297872,186335,401659,220555,87503,366764,180670,40858,253338,310694,66296,496129,487421,112155,547912,217743,122109,450583,607454,332388,567013,694262,656840,80148,173588,642956,606543,560169,609637,480142,356427,91313,333510,700032,302665,572550,395917,580678,226671,17480,342824,256097,475481,419556,441310,6840,294427,613103,57835,68007,332965,162955,596046,15520,663745,283057,514959,63765,169124,326630,291782,367207,169450,185230,482903,416313,595011,111634,226585,104537,509519,66738,168719,556574,56608,649964,199377,539006,643023,410124,438875,542835,719131,146804,219562,192539,139678,180358,185232,378002,566751,427954,118768,583466,713596,340248,446162,616240,302920,100090,407456,293419,398975,177026,214701,423834,191495,339206,540789,389828,340459,69681,267267,4510,115446,88430,37056,604269,393084,610823,205453,355160,559447,140286,730818,206962,465063,523644,539471,215173,734752,305375,726928,12570,563710,308588,672180,600330,188283,710144,28248,313086,679751,523413,490400,534328,491889,218679,426268,76591,576564,721976,224534,406127,327079,703140,225612,635125,312251,607699,384433,563643,505007,56193,667132,686575,182486,637280,454057,502824,645720,140437,552243,505816,17396,324980,573230,119065,119928,197928,231197,30999,160196,431259,399541,718564,26357,332687,735855,329032,380732,409400,74425,643073,736723,513420,52815,160200,221457,700417,384450,40625,309168,479411,727771,402299,567161,304398,730037,251707,701504,510034,702768,567892,670335,419051,18056,359857,82662,286330,262305,3698,680235,204925,32346,656989,6474,322004,362346,400745,237047,641751,34589,606837,622623,605593,253036,667844,205869,654182,147468,44637,2847,710110,337003,704764,570596,402135,321671,502259,420372,404000,191221,702304,574651,420926,100382,574811,138937,338926,481309,709657,135447,545483,439035,260846,220394,53302,53001,726341,203852,647017,310631,52913,181018,220109,624715,734016,570331,661819,295223,150241,212398,671892,223173,643641,436079,475514,531892,711694,568164,412138,234751,154015,592800,695213,542882,97160,732973,348768,360188,47650,116265,262409,447094,392920,365333,403314,45495,711740,367284,185807,78845,318097,690972,695231,336054,713821,704022,412974,622993,368214,67388,728101,51097,321877,19390,432585,154592,188742,596997,638843,680757,105161,220771,554691,393886,570539,74049,457874,471057,217053,186185,159143,734201,83001,568995,693992,72855,414886,607853,417147,350873,175395,605511,130291,398134,419677,361688,260967,140772,307429,636627,420667,45363,262396,23029,152354,345282,356943,306252,70621,361624,668675,487723,492286,408339,59690,462062,518101,415238,577302,352119,440081,693698,10401,418930,97678,105730,236317,592004,420794,388319,230556,105484,605363,520155,324937,248118,571053,393889,44547,299706,575929,481758,383734,731133,273877,566056,385642,188514,21934,446374,555949,29166,86792,426379,521474,78501,666325,620471,675076,583568,524612,639776,36346,242793,71826,196297,622007,474737,366835,511730,220440,589703,563951,570435,367934,7908,310649,583366,60398,191158,688921,259540,153614,612942,23634,491525,141355,325949,252444,15457,650362,705227,247647,576325,355228,679218,94211,211847,449518,65240,587782,682505,581812,467565,528511,730754,614670,74733,708501,311183,591477,414170,561080,381856,437518,570547,391726,322345,540110,245589,139147,383536,57117,126135,147236,416657,246783,182135,246740,594304,698728,130984,545347,199493,352996,521055};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 2;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;
	
	uint32_t q_level = Q << 2;
	
	/* first iteration */
	u = a[0];
	v = a[d];
	
	a[0] = u + v;
	a[d] = Q2 + u - v;

	for (j = 1; j < d; j++)
	{
		/* Gentleman-Sande's butterfly
		 * (u, v) <-- (u + v, (u - v) * omega) % Q */
		u = a[j];
		v = a[j + d];
		
		a[j] = u + v;
		a[j + d] = montgomery((Q2 + u - v) * omega[j]);
	} 
	
	d >>= 1;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = u + v;
			a[j1 + d] = q_level + u - v;

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = u + v;
				a[j + d] = montgomery((q_level + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
		
		q_level <<= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = u + v;
		a[j + 2] = q_level + u - v;
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = u + v;
		a[j + 3] = montgomery((q_level + u - v) * omega[num_of_problems]);
	}
	
	q_level <<= 1;
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_short(u + v);				
		a[j + 1] = barrett_short(q_level + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n)
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = montgomery((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 6 --> 256 * 10 */
static void ntt_butterfly_1536_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g);
	a[N2_2560 + n2] = b + montgomery(c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4]);
	a[N2_2560 * 2 + n2] = b + montgomery(c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4]);
	a[N2_2560 * 3 + n2] = b + montgomery(c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4]);
	a[N2_2560 * 4 + n2] = b + montgomery(c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4]);
	a[N2_2560 * 5 + n2] = b + montgomery(c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4]);
	a[N2_2560 * 6 + n2] = b + montgomery(c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4]);
	a[N2_2560 * 7 + n2] = b + montgomery(c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4]);
	a[N2_2560 * 8 + n2] = b + montgomery(c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4]);
	a[N2_2560 * 9 + n2] = b + montgomery(c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4]);
}

/* 256 * 10 --> 256 * 4 */
static void ntt_butterfly_2560_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	k = a[N2_2560 * 9 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j + k);
	a[N2_2560 + n2] = b + montgomery(c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7] + k * w_10[0][8]);
	a[N2_2560 * 2 + n2] = b + montgomery(c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7] + k * w_10[1][8]);
	a[N2_2560 * 3 + n2] = b + montgomery(c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7] + k * w_10[2][8]);
}

/* 256 * 3 --> 256 * 9 */
static void ntt_butterfly_768_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	
	a[n2] = barrett_short(b + c + d);
	a[N2_2304 + n2] = b + montgomery(c * w_9[0][0] + d * w_9[0][1]);
	a[N2_2304 * 2 + n2] = b + montgomery(c * w_9[1][0] + d * w_9[1][1]);
	a[N2_2304 * 3 + n2] = b + montgomery(c * w_9[2][0] + d * w_9[2][1]);
	a[N2_2304 * 4 + n2] = b + montgomery(c * w_9[3][0] + d * w_9[3][1]);
	a[N2_2304 * 5 + n2] = b + montgomery(c * w_9[4][0] + d * w_9[4][1]);
	a[N2_2304 * 6 + n2] = b + montgomery(c * w_9[5][0] + d * w_9[5][1]);
	a[N2_2304 * 7 + n2] = b + montgomery(c * w_9[6][0] + d * w_9[6][1]);
	a[N2_2304 * 8 + n2] = b + montgomery(c * w_9[7][0] + d * w_9[7][1]);
}

/* 256 * 6 --> 256 * 9 */
static void ntt_butterfly_1536_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g);
	a[N2_2304 + n2] = b + montgomery(c * w_9[0][0] + d * w_9[0][1] + e * w_9[0][2] + f * w_9[0][3] + g * w_9[0][4]);
	a[N2_2304 * 2 + n2] = b + montgomery(c * w_9[1][0] + d * w_9[1][1] + e * w_9[1][2] + f * w_9[1][3] + g * w_9[1][4]);
	a[N2_2304 * 3 + n2] = b + montgomery(c * w_9[2][0] + d * w_9[2][1] + e * w_9[2][2] + f * w_9[2][3] + g * w_9[2][4]);
	a[N2_2304 * 4 + n2] = b + montgomery(c * w_9[3][0] + d * w_9[3][1] + e * w_9[3][2] + f * w_9[3][3] + g * w_9[3][4]);
	a[N2_2304 * 5 + n2] = b + montgomery(c * w_9[4][0] + d * w_9[4][1] + e * w_9[4][2] + f * w_9[4][3] + g * w_9[4][4]);
	a[N2_2304 * 6 + n2] = b + montgomery(c * w_9[5][0] + d * w_9[5][1] + e * w_9[5][2] + f * w_9[5][3] + g * w_9[5][4]);
	a[N2_2304 * 7 + n2] = b + montgomery(c * w_9[6][0] + d * w_9[6][1] + e * w_9[6][2] + f * w_9[6][3] + g * w_9[6][4]);
	a[N2_2304 * 8 + n2] = b + montgomery(c * w_9[7][0] + d * w_9[7][1] + e * w_9[7][2] + f * w_9[7][3] + g * w_9[7][4]);
}

/* 256 * 9 --> 256 * 9 */
static void ntt_butterfly_2304_2304_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	h = a[N2_2304 * 6 + n2];
	i = a[N2_2304 * 7 + n2];
	j = a[N2_2304 * 8 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j);
	a[N2_2304 + n2] = b + montgomery(c * w_9_inv[0][0] + d * w_9_inv[0][1] + e * w_9_inv[0][2] + f * w_9_inv[0][3] + g * w_9_inv[0][4] + h * w_9_inv[0][5] + i * w_9_inv[0][6] + j * w_9_inv[0][7]);
	a[N2_2304 * 2 + n2] = b + montgomery(c * w_9_inv[1][0] + d * w_9_inv[1][1] + e * w_9_inv[1][2] + f * w_9_inv[1][3] + g * w_9_inv[1][4] + h * w_9_inv[1][5] + i * w_9_inv[1][6] + j * w_9_inv[1][7]);
	a[N2_2304 * 3 + n2] = b + montgomery(c * w_9_inv[2][0] + d * w_9_inv[2][1] + e * w_9_inv[2][2] + f * w_9_inv[2][3] + g * w_9_inv[2][4] + h * w_9_inv[2][5] + i * w_9_inv[2][6] + j * w_9_inv[2][7]);
	a[N2_2304 * 4 + n2] = b + montgomery(c * w_9_inv[3][0] + d * w_9_inv[3][1] + e * w_9_inv[3][2] + f * w_9_inv[3][3] + g * w_9_inv[3][4] + h * w_9_inv[3][5] + i * w_9_inv[3][6] + j * w_9_inv[3][7]);
	a[N2_2304 * 5 + n2] = b + montgomery(c * w_9_inv[4][0] + d * w_9_inv[4][1] + e * w_9_inv[4][2] + f * w_9_inv[4][3] + g * w_9_inv[4][4] + h * w_9_inv[4][5] + i * w_9_inv[4][6] + j * w_9_inv[4][7]);
	a[N2_2304 * 6 + n2] = b + montgomery(c * w_9_inv[5][0] + d * w_9_inv[5][1] + e * w_9_inv[5][2] + f * w_9_inv[5][3] + g * w_9_inv[5][4] + h * w_9_inv[5][5] + i * w_9_inv[5][6] + j * w_9_inv[5][7]);
	a[N2_2304 * 7 + n2] = b + montgomery(c * w_9_inv[6][0] + d * w_9_inv[6][1] + e * w_9_inv[6][2] + f * w_9_inv[6][3] + g * w_9_inv[6][4] + h * w_9_inv[6][5] + i * w_9_inv[6][6] + j * w_9_inv[6][7]);
	a[N2_2304 * 8 + n2] = b + montgomery(c * w_9_inv[7][0] + d * w_9_inv[7][1] + e * w_9_inv[7][2] + f * w_9_inv[7][3] + g * w_9_inv[7][4] + h * w_9_inv[7][5] + i * w_9_inv[7][6] + j * w_9_inv[7][7]);
}

/* 256 * 4 --> 256 * 4 */
static void ntt_butterfly_1024_1024_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	e = a[N2_1024 * 3 + n2];
	
	a[n2] = barrett_short(b + c + d + e);
	a[N2_1024 + n2] = b + montgomery(c * w_4_inv[0][0] + d * w_4_inv[0][1] + e * w_4_inv[0][2]);
	a[N2_1024 * 2 + n2] = b + montgomery(c * w_4_inv[1][0] + d * w_4_inv[1][1] + e * w_4_inv[1][2]);
	a[N2_1024 * 3 + n2] = b + montgomery(c * w_4_inv[2][0] + d * w_4_inv[2][1] + e * w_4_inv[2][2]);
}

/* 256 * 3 --> 256 * 4 */
static void ntt_butterfly_768_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	
	a[n2] = barrett_short(b + c + d);
	a[N2_1024 + n2] = b + montgomery(c * w_4[0][0] + d * w_4[0][1]);
	a[N2_1024 * 2 + n2] = b + montgomery(c * w_4[1][0] + d * w_4[1][1]);
	a[N2_1024 * 3 + n2] = b + montgomery(c * w_4[2][0] + d * w_4[2][1]);
}

/* 256 * 4 --> 256 * 1 */
static void ntt_butterfly_1024_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_short(a[n2] + a[N2_1024 + n2] + a[N2_1024 * 2 + n2] + a[N2_1024 * 3 + n2]);
}

/* 256 * 9 --> 256 * 10 */
static void ntt_butterfly_2304_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j);
	a[N2_2560 + n2] = b + montgomery(c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7]);
	a[N2_2560 * 2 + n2] = b + montgomery(c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7]);
	a[N2_2560 * 3 + n2] = b + montgomery(c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7]);
	a[N2_2560 * 4 + n2] = b + montgomery(c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4] + h * w_10[3][5] + i * w_10[3][6] + j * w_10[3][7]);
	a[N2_2560 * 5 + n2] = b + montgomery(c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4] + h * w_10[4][5] + i * w_10[4][6] + j * w_10[4][7]);
	a[N2_2560 * 6 + n2] = b + montgomery(c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4] + h * w_10[5][5] + i * w_10[5][6] + j * w_10[5][7]);
	a[N2_2560 * 7 + n2] = b + montgomery(c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4] + h * w_10[6][5] + i * w_10[6][6] + j * w_10[6][7]);
	a[N2_2560 * 8 + n2] = b + montgomery(c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4] + h * w_10[7][5] + i * w_10[7][6] + j * w_10[7][7]);
	a[N2_2560 * 9 + n2] = b + montgomery(c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4] + h * w_10[8][5] + i * w_10[8][6] + j * w_10[8][7]);
}

/* 256 * 10 --> 256 * 1 */
static void ntt_butterfly_2560_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_short(a[n2] + a[N2_2560 + n2] + a[N2_2560 * 2 + n2] + a[N2_2560 * 3 + n2] + a[N2_2560 * 4 + n2] + a[N2_2560 * 5 + n2] + a[N2_2560 * 6 + n2] + a[N2_2560 * 7 + n2] + a[N2_2560 * 8 + n2] + a[N2_2560 * 9 + n2]);	
}

void ntt_1536_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_1536_2560);
}

void intt_2560_1024(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 1024, omega_256, omega_2560, ntt_butterfly_2560_1024, INV_2560);
}

void ntt_768_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_768_2304);
}

void ntt_1536_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_1536_2304);
}

void intt_2304_2304_inv(uint32_t *a)
{
	intt_core(a, N1_2304, N2_2304, 2304, omega_256_inv, omega_2304_inv, ntt_butterfly_2304_2304_inv, INV_2304);
}

void ntt_1024_1024_inv(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256_inv, omega_1024_inv, ntt_butterfly_1024_1024_inv);
}

void ntt_768_1024(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256, omega_1024, ntt_butterfly_768_1024);
}

void intt_1024_256(uint32_t *a)
{
	intt_core(a, N1_1024, N2_1024, 256, omega_256, omega_1024, ntt_butterfly_1024_256, INV_1024);
}

void ntt_2304_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_2304_2560);
}

void intt_2560_256(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 256, omega_256, omega_2560, ntt_butterfly_2560_256, INV_2560);
}
