/* ****************************** *
 * Titanium_CPA_hi                *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 1024=4*256 */
#define N1_1024 4
#define N2_1024 256

/* 2304=9*256 */
#define N1_2304 9
#define N2_2304 256

/* 2560=10*256 */
#define N1_2560 10
#define N2_2560 256

/* multiplication inverses of 1024, 2304, 2560 */
#define INV_1024 736561
#define INV_2304 736961
#define INV_2560 736993

/* omega_n: n-th root of unity mod Q */

static const uint32_t w_4[3][3]={{511371,737280,225910},
{737280,1,737280},
{225910,737280,511371}};

static const uint32_t w_9[8][8]={{17175,68225,224866,195672,139802,512414,524434,529254},
{68225,195672,512414,529254,17175,224866,139802,524434},
{224866,512414,1,224866,512414,1,224866,512414},
{195672,529254,224866,524434,68225,512414,17175,139802},
{139802,17175,512414,68225,524434,224866,529254,195672},
{512414,224866,1,512414,224866,1,512414,224866},
{524434,139802,224866,17175,529254,512414,195672,68225},
{529254,524434,512414,139802,195672,224866,68225,17175}};

static const uint32_t w_10[9][9]={{364663,153285,408940,620317,737280,372618,583996,328341,116964},
{153285,620317,372618,328341,1,153285,620317,372618,328341},
{408940,372618,116964,153285,737280,328341,364663,620317,583996},
{620317,328341,153285,372618,1,620317,328341,153285,372618},
{737280,1,737280,1,737280,1,737280,1,737280},
{372618,153285,328341,620317,1,372618,153285,328341,620317},
{583996,620317,364663,328341,737280,153285,116964,372618,408940},
{328341,372618,620317,153285,1,328341,372618,620317,153285},
{116964,328341,583996,372618,737280,620317,408940,153285,364663}};

/* omega_256,1024,2304,2560, respectively */
static const uint32_t omega_256[128]={1,241830,619980,722926,386579,643332,364626,172542,150946,488870,423750,39029,448989,374281,72265,73407,500173,727573,554345,396244,12231,588639,40295,634154,64696,330860,665118,262980,68902,20060,538101,342892,315571,53182,610577,570040,395506,700974,157619,312351,666599,94644,344437,141454,194263,550532,636985,488658,28179,576568,543125,257724,82866,187200,48038,430104,133245,509526,585455,512220,319071,59594,722594,462648,511371,706800,115208,376212,347122,647724,60065,345969,509952,385695,677102,102089,328585,513494,227033,286163,129068,460586,259867,16013,223978,251075,165057,78251,385184,227899,323139,291180,562933,311707,494370,433826,4404,385556,240377,186746,112087,600526,14886,475538,476003,122960,136789,97243,697195,510489,486949,355350,503545,8266,197989,651730,43811,86160,511740,731069,330718,240184,699540,632750,421917,607801,175670,144880};
static const uint32_t omega_1024[1024]={1,1691,647638,293573,241830,480856,643834,496538,619980,709879,111921,514475,722926,55968,269920,57781,386579,474123,317546,229718,643332,384937,646625,55152,364626,215650,447336,732151,172542,542527,235593,256023,150946,150460,65915,132834,488870,187169,209230,650331,423750,661399,707713,135620,39029,380030,458979,513877,448989,578250,186144,687798,374281,322073,512065,334021,72265,548750,436752,529351,73407,268029,546505,326862,500173,131236,735776,404169,727573,541235,262664,321662,554345,313244,327846,689555,396244,597456,223126,555475,12231,38753,650595,132893,588639,59199,572574,172681,40295,308993,512215,587671,634154,347840,584483,404213,64696,283348,646099,640248,330860,625262,57088,689278,665118,361013,4315,661136,262980,118737,243835,184906,68902,22884,358232,462611,20060,6534,727060,411033,538101,124037,358763,623251,342892,327506,114615,646343,315571,576398,3536,81128,53182,719761,602201,136830,610577,292307,312867,427620,570040,311373,113109,311540,395506,86779,24370,659215,700974,536467,310067,116506,157619,375288,550348,189846,312351,292345,377125,707591,666599,653541,690893,446959,94644,53027,457656,488527,344437,728258,225008,51532,141454,319670,134997,460098,194263,408688,259111,211787,550532,500990,38221,488264,636985,711375,429814,593689,488658,565958,44240,344459,28179,464705,611890,300747,576568,291006,324719,562765,543125,509530,471022,234722,257724,78213,284884,294351,82866,43016,486518,633623,187200,261651,83241,677141,48038,131348,187887,686087,430104,346798,297023,177532,133245,446590,207946,690930,509526,464258,593294,557994,585455,573303,668139,308557,512220,596126,185939,341143,319071,596650,334742,554195,59594,503238,153184,248513,722594,231837,540156,649918,462648,82627,376148,530046,511371,635029,352903,298644,706800,66299,44897,718165,115208,174544,241504,666871,376212,638270,672467,254395,347122,107626,624440,141648,647724,438999,642623,660580,60065,562418,693629,649849,345969,369746,26198,63958,509952,447343,6707,282322,385695,453841,672891,234098,677102,719370,678301,535036,102089,108745,304826,101347,328585,464642,505357,50008,513494,538617,259312,551678,227033,526683,722786,556509,286163,245297,445305,246854,129068,18812,108009,534812,460586,282190,162483,490221,259867,15621,610276,520597,16013,535867,32748,80793,223978,521645,313619,224690,251075,631250,598143,647562,165057,419169,287738,696779,78251,349142,574322,179425,385184,327021,31761,623619,227899,516527,506453,428782,323139,102828,621113,413939,291180,618953,447784,15157,562933,89932,195126,393459,311707,677903,599299,390515,494370,640297,413719,656441,433826,5171,634070,205796,4404,74354,394844,441899,385556,218792,599491,715187,240377,235676,396376,83387,186746,231218,230708,105579,112087,57900,587808,128540,600526,253529,357278,323959,14886,104672,52912,263191,475538,498468,197205,222643,476003,547502,538227,337103,122960,12118,584951,458320,136789,541246,281265,72870,97243,24250,456295,398919,697195,44426,658985,312044,510489,618129,528962,152889,486949,625163,626960,716563,355350,12835,322836,327736,503545,672321,7509,163942,8266,706748,715648,282647,197989,73825,237586,677062,651730,577616,588612,13542,43811,356301,146414,596939,86160,452203,114876,350413,511740,521727,452281,246774,731069,554723,215161,357718,330718,385140,252617,289648,240184,646594,2731,194435,699540,323416,571235,120275,632750,185519,368204,367800,421917,510920,609669,231441,607801,21777,698138,164477,175670,671008,736350,637522,144880,214788,464256,589912,737280,735590,89643,443708,495451,256425,93447,240743,117301,27402,625360,222806,14355,681313,467361,679500,350702,263158,419735,507563,93949,352344,90656,682129,372655,521631,289945,5130,564739,194754,501688,481258,586335,586821,671366,604447,248411,550112,528051,86950,313531,75882,29568,601661,698252,357251,278302,223404,288292,159031,551137,49483,363000,415208,225216,403260,665016,188531,300529,207930,663874,469252,190776,410419,237108,606045,1505,333112,9708,196046,474617,415619,182936,424037,409435,47726,341037,139825,514155,181806,725050,698528,86686,604388,148642,678082,164707,564600,696986,428288,225066,149610,103127,389441,152798,333068,672585,453933,91182,97033,406421,112019,680193,48003,72163,376268,732966,76145,474301,618544,493446,552375,668379,714397,379049,274670,717221,730747,10221,326248,199180,613244,378518,114030,394389,409775,622666,90938,421710,160883,733745,656153,684099,17520,135080,600451,126704,444974,424414,309661,167241,425908,624172,425741,341775,650502,712911,78066,36307,200814,427214,620775,579662,361993,186933,547435,424930,444936,360156,29690,70682,83740,46388,290322,642637,684254,279625,248754,392844,9023,512273,685749,595827,417611,602284,277183,543018,328593,478170,525494,186749,236291,699060,249017,100296,25906,307467,143592,248623,171323,693041,392822,709102,272576,125391,436534,160713,446275,412562,174516,194156,227751,266259,502559,479557,659068,452397,442930,654415,694265,250763,103658,550081,475630,654040,60140,689243,605933,549394,51194,307177,390483,440258,559749,604036,290691,529335,46351,227755,273023,143987,179287,151826,163978,69142,428724,225061,141155,551342,396138,418210,140631,402539,183086,677687,234043,584097,488768,14687,505444,197125,87363,274633,654654,361133,207235,225910,102252,384378,438637,30481,670982,692384,19116,622073,562737,495777,70410,361069,99011,64814,482886,390159,629655,112841,595633,89557,298282,94658,76701,677216,174863,43652,87432,391312,367535,711083,673323,227329,289938,730574,454959,351586,283440,64390,503183,60179,17911,58980,202245,635192,628536,432455,635934,408696,272639,231924,687273,223787,198664,477969,185603,510248,210598,14495,180772,451118,491984,291976,490427,608213,718469,629272,202469,276695,455091,574798,247060,477414,721660,127005,216684,721268,201414,704533,656488,513303,215636,423662,512591,486206,106031,139138,89719,572224,318112,449543,40502,659030,388139,162959,557856,352097,410260,705520,113662,509382,220754,230828,308499,414142,634453,116168,323342,446101,118328,289497,722124,174348,647349,542155,343822,425574,59378,137982,346766,242911,96984,323562,80840,303455,732110,103211,531485,732877,662927,342437,295382,351725,518489,137790,22094,496904,501605,340905,653894,550535,506063,506573,631702,625194,679381,149473,608741,136755,483752,380003,413322,722395,632609,684369,474090,261743,238813,540076,514638,261278,189779,199054,400178,614321,725163,152330,278961,600492,196035,456016,664411,640038,713031,280986,338362,40086,692855,78296,425237,226792,119152,208319,584392,250332,112118,110321,20718,381931,724446,414445,409545,233736,64960,729772,573339,729015,30533,21633,454634,539292,663456,499695,60219,85551,159665,148669,723739,693470,380980,590867,140342,651121,285078,622405,386868,225541,215554,285000,490507,6212,182558,522120,379563,406563,352141,484664,447633,497097,90687,734550,542846,37741,413865,166046,617006,104531,551762,369077,369481,315364,226361,127612,505840,129480,715504,39143,572804,561611,66273,931,99759,592401,522493,273025,147369};
static const uint32_t omega_2304[2304]={1,5454,254876,319019,683747,726121,327683,13938,77909,241830,682392,708761,18211,527140,362941,618010,515089,254796,619980,200254,272155,186717,169457,405385,601352,347920,531667,722926,596897,380623,471827,233768,211823,700596,460442,71582,386579,515487,213645,315850,357484,346772,168723,88554,54461,643332,12449,66994,431181,472065,57258,415269,687175,253127,364626,223347,146326,323962,363472,564960,194541,79255,210104,172542,273512,214985,251400,530221,209252,686701,617055,467486,150946,453888,452835,608021,593877,129725,467671,422655,419964,488870,288884,3839,294038,97077,90200,184373,656339,173651,423750,493846,148591,143495,366589,607615,591396,606690,707413,39029,527238,160152,528304,75868,169431,263581,610105,163517,448989,275805,187230,18235,658036,581717,164375,704835,724237,374281,534766,667409,92389,326683,458186,301135,465503,394879,72265,425256,597479,605727,616178,108014,20837,103724,216169,73407,18195,439876,708611,674673,634352,433356,538019,714527,500173,3842,310400,124424,309976,23771,622859,419419,465564,727573,136800,716109,281029,662248,698254,220951,349600,109734,554345,545530,391785,155052,729582,34671,351698,493011,18187,396244,144165,334364,325343,522636,128398,603023,614182,281045,12231,352584,164288,230337,668455,636306,31257,163767,337927,588639,315632,643074,79879,664276,699751,275498,724695,660370,40295,59192,641371,376370,131676,49210,21056,560869,657,634154,90745,207679,217650,40690,1679,309894,313824,366895,64696,431666,168131,546191,310474,528020,1494,38185,347748,330860,383833,284423,3818,179504,642929,26330,571306,153418,665118,131052,332319,231128,558883,228228,225184,580671,357739,262980,281375,337489,411630,9375,258861,672060,391389,207111,68902,515479,170013,488685,17175,37763,258003,416214,680238,20060,289652,506106,659341,326377,263824,460865,166781,556101,538101,424474,18856,358565,344298,683866,637866,429406,375868,342892,388352,600776,155540,442010,550951,466679,173254,470355,315571,310380,15344,373423,278920,218977,642619,547433,448813,53182,303195,641528,495367,334034,85,463590,283311,574499,610577,525962,573658,447449,724017,648963,495402,524924,73373,570040,621464,183899,282986,276511,351349,64127,277464,388044,395506,542799,242531,81960,217554,254387,601137,649872,292121,700974,310211,568180,61677,186222,418851,316816,465081,305134,157619,721661,333116,154280,205499,124426,320884,533523,523616,312351,443244,645658,164676,134646,27408,552470,641214,257373,666599,98335,315803,101146,164096,657731,392809,578981,725132,94644,91676,124386,102724,660417,296633,241868,152363,72115,344437,704691,676142,536187,307452,266214,224867,326315,662957,141454,294190,188804,492740,14715,629262,689174,96458,400579,194263,37605,133552,696261,410344,368341,578370,341862,668980,550532,393296,285955,249255,627887,562734,587714,431649,75413,636985,48118,700817,191214,365822,110802,480969,696409,480255,488658,607198,528921,491862,387070,244277,19991,650607,614406,28179,333818,296583,706449,679621,341347,72013,525410,512174,576568,98407,708491,20193,277753,489688,326570,579165,254106,543125,545973,596064,261127,497047,649382,568785,412223,294473,257724,369110,348810,224760,480018,670622,658628,124080,645643,82866,735192,403090,618199,71333,503095,457529,404262,374758,187200,591896,384566,595800,295833,302354,478400,693422,409339,48038,264497,445002,649137,707117,636488,286604,102496,154186,430104,496355,561619,404752,98094,475951,607634,695022,288367,133245,496445,315198,487881,55845,81577,340515,695252,68225,509526,142715,536155,132924,220273,338193,564841,282796,714813,585455,644840,126990,296601,67340,106422,185441,582963,324530,512220,90171,26207,637745,506753,501674,80205,230437,476574,319071,230074,708615,696489,179294,234870,323883,669887,336343,59594,622036,354463,90420,646972,695703,316136,442766,250489,722594,260731,549106,725983,312312,230538,290147,256712,10629,462648,306610,97632,168046,82601,27163,690802,128198,249504,511371,620692,397097,372741,245697,391861,569556,193571,687123,706800,382132,591822,718251,167001,281419,577465,566959,37872,115208,181020,63821,83102,547774,96784,704021,708367,81178,376212,7225,329257,488443,171869,289375,469910,100384,431834,347122,603061,84153,381680,338457,530135,477489,148514,460818,647724,373425,289828,728729,543376,440365,426493,708548,331071,60065,241746,224256,680326,500012,600310,563100,372035,81578,345969,212847,387244,455992,131555,126557,146862,298182,580023,509952,254276,733024,375314,270500,7719,74409,322136,726402,385695,117837,511247,681677,495556,627559,248384,301139,487319,677102,611060,211120,552839,441897,671930,419650,250876,621449,102089,146251,652193,417078,231527,523186,178974,701433,601754,328585,509760,681670,457378,317989,227094,675877,565439,595164,513494,403038,334591,88839,134289,292173,247301,292705,199705,227033,343183,500904,304311,92663,346517,252515,713183,542807,286163,646406,557863,563396,511857,322212,403625,586965,33008,129068,570798,331910,212285,271220,248194,2160,721425,520534,460586,119677,224673,5520,614840,183372,357852,142001,328404,259867,260536,222857,422990,35211,347734,254504,501974,241843,16013,335744,479053,568479,217861,454203,696283,530332,77365,223978,638676,423460,386748,699932,525391,408548,157610,672575,251075,232233,687305,224866,320861,408081,559716,347724,199964,165057,777,551353,447344,151347,429099,176052,247746,507892,78251,632536,113545,695671,141608,396825,363815,223839,617851,385184,279967,31067,602069,572033,432071,165158,551631,488994,227899,642661,39220,94390,180922,266610,172808,249714,182149,323139,298516,189816,113940,638158,547412,334279,599034,239325,291180,729727,88220,444668,302063,365848,252606,472216,143531,562933,198498,279584,154028,305653,39121,291725,15752,386812,311707,617273,181896,417839,695616,578919,386984,512514,219085,494370,57363,250658,169758,572477,641804,526109,638115,312890,433826,152275,329444,33779,647697,226167,43705,225307,514232,4404,426424,332222,439371,166184,249187,257015,188629,275571,385556,97012,472971,574896,563972,704237,411869,575600,717183,240377,130540,488995,233353,160256,358239,40856,169762,594293,186746,327623,423979,268250,269996,208027,641080,263818,428141,112087,116549,122024,491434,264601,274937,614125,707448,229919,600526,266602,129176,422549,579121,14130,387796,517476,2436,14886,87334,36110,89913,93637,497746,38042,305107,10361,475538,566975,125136,506819,124357,681839,641823,629735,319792,476003,153961,677516,657173,298601,653406,397251,475376,420708,122960,435411,686774,277916,641409,583622,232311,375436,198607,136789,656115,426517,102163,549847,343711,431492,693697,434627,97243,258283,468772,529261,134379,45752,330430,250456,542612,697195,343413,280762,680592,476214,567474,634839,140330,62142,510489,233950,467170,639325,276701,650328,567302,434032,538518,486949,133684,678908,139050,453832,147411,343304,423557,178505,355350,504432,376717,549652,17462,128499,416596,551823,61600,503545,699986,82626,163513,427173,730863,385716,232371,702676,8266,108623,393199,494198,593837,648846,594565,195672,349481,197989,452622,183600,126802,8530,73917,587892,665180,469200,651730,103719,188899,273589,634943,707546,27130,510820,564662,43811,66150,251691,642773,650068,623824,521562,169050,397450,86160,268643,201575,104079,677777,606105,465947,604612,433216,511740,421375,74373,125792,398238,697507,570499,175726,681585,731069,34678,389876,65300,39477,21506,66045,416302,422909,330718,346646,218800,414542,408522,15806,681328,66672,149555,240184,552480,695754,594290,170384,300276,204203,428852,303476,699540,599266,30091,439932,276754,202109,67391,384576,650340,632750,543420,680341,581822,737045,187418,306306,651459,100247,421917,81317,397037,45501,436038,420027,95191,125890,195449,607801,131278,90361,325186,403639,663321,652148,171648,558603,175670,376161,466352,601639,438656,690260,121254,715540,126827,144880,547569,453276,64111,190200,733714,452169,662062,421091,737280,731827,482405,418262,53534,11160,409598,723343,659372,495451,54889,28520,719070,210141,374340,119271,222192,482485,117301,537027,465126,550564,567824,331896,135929,389361,205614,14355,140384,356658,265454,503513,525458,36685,276839,665699,350702,221794,523636,421431,379797,390509,568558,648727,682820,93949,724832,670287,306100,265216,680023,322012,50106,484154,372655,513934,590955,413319,373809,172321,542740,658026,527177,564739,463769,522296,485881,207060,528029,50580,120226,269795,586335,283393,284446,129260,143404,607556,269610,314626,317317,248411,448397,733442,443243,640204,647081,552908,80942,563630,313531,243435,588690,593786,370692,129666,145885,130591,29868,698252,210043,577129,208977,661413,567850,473700,127176,573764,288292,461476,550051,719046,79245,155564,572906,32446,13044,363000,202515,69872,644892,410598,279095,436146,271778,342402,665016,312025,139802,131554,121103,629267,716444,633557,521112,663874,719086,297405,28670,62608,102929,303925,199262,22754,237108,733439,426881,612857,427305,713510,114422,317862,271717,9708,600481,21172,456252,75033,39027,516330,387681,627547,182936,191751,345496,582229,7699,702610,385583,244270,719094,341037,593116,402917,411938,214645,608883,134258,123099,456236,725050,384697,572993,506944,68826,100975,706024,573514,399354,148642,421649,94207,657402,73005,37530,461783,12586,76911,696986,678089,95910,360911,605605,688071,716225,176412,736624,103127,646536,529602,519631,696591,735602,427387,423457,370386,672585,305615,569150,191090,426807,209261,735787,699096,389533,406421,353448,452858,733463,557777,94352,710951,165975,583863,72163,606229,404962,506153,178398,509053,512097,156610,379542,474301,455906,399792,325651,727906,478420,65221,345892,530170,668379,221802,567268,248596,720106,699518,479278,321067,57043,717221,447629,231175,77940,410904,473457,276416,570500,181180,199180,312807,718425,378716,392983,53415,99415,307875,361413,394389,348929,136505,581741,295271,186330,270602,564027,266926,421710,426901,721937,363858,458361,518304,94662,189848,288468,684099,434086,95753,241914,403247,737196,273691,453970,162782,126704,211319,163623,289832,13264,88318,241879,212357,663908,167241,115817,553382,454295,460770,385932,673154,459817,349237,341775,194482,494750,655321,519727,482894,136144,87409,445160,36307,427070,169101,675604,551059,318430,420465,272200,432147,579662,15620,404165,583001,531782,612855,416397,203758,213665,424930,294037,91623,572605,602635,709873,184811,96067,479908,70682,638946,421478,636135,573185,79550,344472,158300,12149,642637,645605,612895,634557,76864,440648,495413,584918,665166,392844,32590,61139,201094,429829,471067,512414,410966,74324,595827,443091,548477,244541,722566,108019,48107,640823,336702,543018,699676,603729,41020,326937,368940,158911,395419,68301,186749,343985,451326,488026,109394,174547,149567,305632,661868,100296,689163,36464,546067,371459,626479,256312,40872,257026,248623,130083,208360,245419,350211,493004,717290,86674,122875,709102,403463,440698,30832,57660,395934,665268,211871,225107,160713,638874,28790,717088,459528,247593,410711,158116,483175,194156,191308,141217,476154,240234,87899,168496,325058,442808,479557,368171,388471,512521,257263,66659,78653,613201,91638,654415,2089,334191,119082,665948,234186,279752,333019,362523,550081,145385,352715,141481,441448,434927,258881,43859,327942,689243,472784,292279,88144,30164,100793,450677,634785,583095,307177,240926,175662,332529,639187,261330,129647,42259,448914,604036,240836,422083,249400,681436,655704,396766,42029,669056,227755,594566,201126,604357,517008,399088,172440,454485,22468,151826,92441,610291,440680,669941,630859,551840,154318,412751,225061,647110,711074,99536,230528,235607,657076,506844,260707,418210,507207,28666,40792,557987,502411,413398,67394,400938,677687,115245,382818,646861,90309,41578,421145,294515,486792,14687,476550,188175,11298,424969,506743,447134,480569,726652,274633,430671,639649,569235,654680,710118,46479,609083,487777,225910,116589,340184,364540,491584,345420,167725,543710,50158,30481,355149,145459,19030,570280,455862,159816,170322,699409,622073,556261,673460,654179,189507,640497,33260,28914,656103,361069,730056,408024,248838,565412,447906,267371,636897,305447,390159,134220,653128,355601,398824,207146,259792,588767,276463,89557,363856,447453,8552,193905,296916,310788,28733,406210,677216,495535,513025,56955,237269,136971,174181,365246,655703,391312,524434,350037,281289,605726,610724,590419,439099,157258,227329,483005,4257,361967,466781,729562,662872,415145,10879,351586,619444,226034,55604,241725,109722,488897,436142,249962,60179,126221,526161,184442,295384,65351,317631,486405,115832,635192,591030,85088,320203,505754,214095,558307,35848,135527,408696,227521,55611,279903,419292,510187,61404,171842,142117,223787,334243,402690,648442,602992,445108,489980,444576,537576,510248,394098,236377,432970,644618,390764,484766,24098,194474,451118,90875,179418,173885,225424,415069,333656,150316,704273,608213,166483,405371,524996,466061,489087,735121,15856,216747,276695,617604,512608,731761,122441,553909,379429,595280,408877,477414,476745,514424,314291,702070,389547,482777,235307,495438,721268,401537,258228,168802,519420,283078,40998,206949,659916,513303,98605,313821,350533,37349,211890,328733,579671,64706,486206,505048,49976,512415,416420,329200,177565,389557,537317,572224,736504,185928,289937,585934,308182,561229,489535,229389,659030,104745,623736,41610,595673,340456,373466,513442,119430,352097,457314,706214,135212,165248,305210,572123,185650,248287,509382,94620,698061,642891,556359,470671,564473,487567,555132,414142,438765,547465,623341,99123,189869,403002,138247,497956,446101,7554,649061,292613,435218,371433,484675,265065,593750,174348,538783,457697,583253,431628,698160,445556,721529,350469,425574,120008,555385,319442,41665,158362,350297,224767,518196,242911,679918,486623,567523,164804,95477,211172,99166,424391,303455,585006,407837,703502,89584,511114,693576,511974,223049,732877,310857,405059,297910,571097,488094,480266,548652,461710,351725,640269,264310,162385,173309,33044,325412,161681,20098,496904,606741,248286,503928,577025,379042,696425,567519,142988,550535,409658,313302,469031,467285,529254,96201,473463,309140,625194,620732,615257,245847,472680,462344,123156,29833,507362,136755,470679,608105,314732,158160,723151,349485,219805,734845,722395,649947,701171,647368,643644,239535,699239,432174,726920,261743,170306,612145,230462,612924,55442,95458,107546,417489,261278,583320,59765,80108,438680,83875,340030,261905,316573,614321,301870,50507,459365,95872,153659,504970,361845,538674,600492,81166,310764,635118,187434,393570,305789,43584,302654,640038,478998,268509,208020,602902,691529,406851,486825,194669,40086,393868,456519,56689,261067,169807,102442,596951,675139,226792,503331,270111,97956,460580,86953,169979,303249,198763,250332,603597,58373,598231,283449,589870,393977,313724,558776,381931,232849,360564,187629,719819,608782,320685,185458,675681,233736,37295,654655,573768,310108,6418,351565,504910,34605,729015,628658,344082,243083,143444,88435,142716,541609,387800,539292,284659,553681,610479,728751,663364,149389,72101,268081,85551,633562,548382,463692,102338,29735,710151,226461,172619,693470,671131,485590,94508,87213,113457,215719,568231,339831,651121,468638,535706,633202,59504,131176,271334,132669,304065,225541,315906,662908,611489,339043,39774,166782,561555,55696,6212,702603,347405,671981,697804,715775,671236,320979,314372,406563,390635,518481,322739,328759,721475,55953,670609,587726,497097,184801,41527,142991,566897,437005,533078,308429,433805,37741,138015,707190,297349,460527,535172,669890,352705,86941,104531,193861,56940,155459,236,549863,430975,85822,637034,315364,655964,340244,691780,301243,317254,642090,611391,541832,129480,606003,646920,412095,333642,73960,85133,565633,178678,561611,361120,270929,135642,298625,47021,616027,21741,610454,592401,189712,284005,673170,547081,3567,285112,75219,316190};
static const uint32_t omega_2560[2560]={1,332395,454489,256974,657037,647638,326630,390633,424563,399456,241830,284544,384357,81492,566681,643834,332965,438422,530073,413298,619980,102509,37640,426511,572198,111921,256097,372617,192525,568418,722926,152407,9974,492354,269698,269920,333510,222571,500162,380738,386579,644901,366269,247287,452799,317546,80148,620087,279286,7417,643332,96181,104773,553300,145331,646625,547912,56620,370094,585718,364626,447523,593025,571277,685022,447336,366764,369149,554149,707344,172542,483662,496597,203130,676932,235593,371101,581909,183548,434710,150946,249058,36825,106713,278725,65915,36948,440843,147516,707915,488870,473969,509832,95228,363168,209230,26401,441933,453095,648093,423750,7167,120054,15205,4720,707713,437651,90035,210754,84334,39029,585260,7602,204803,126612,458979,453780,518839,616133,561479,448989,541354,350127,658315,37311,186144,713360,354790,114257,373924,374281,337055,387808,704682,74252,512065,628577,1168,427554,832,72265,646976,728159,329563,619686,436752,603016,78817,570942,662128,73407,542351,708773,356033,403882,546505,550290,126698,290990,463941,500173,350678,224991,522491,220866,735776,359324,190823,326655,590417,727573,188277,447573,255312,440016,262664,121541,308300,480467,179212,554345,238755,41385,715458,251674,327846,552965,122437,272696,723499,396244,171978,282256,1308,514151,223126,659137,472031,711916,346341,12231,155811,493500,20091,593928,650595,423072,251343,159970,522430,588639,291344,166811,662021,633911,572574,491952,94769,411030,249302,40295,409879,311496,392966,282486,512215,352719,344666,635042,498009,634154,243649,340629,607847,81044,584483,522318,224449,260965,139682,64696,351993,116783,240635,466978,646099,443739,611731,124193,31764,330860,426616,84185,647282,696251,57088,364663,212361,451655,494662,665118,79669,655578,76950,42798,4315,272880,689856,709467,269210,262980,464459,157029,583341,626943,243835,234495,355486,692224,404719,68902,520587,665165,219333,635412,358232,695016,214780,141589,617582,20060,611617,569775,566969,527064,727060,718834,275512,400949,317452,538101,660419,454003,177543,222402,358763,249321,457552,197798,33035,342892,53831,82656,401936,301272,114615,669093,142242,173622,414415,315571,517394,275289,4964,711183,3536,122806,537805,329872,110401,53182,381634,350975,150652,583301,602201,496300,277469,616122,591539,610577,663764,495530,169826,130786,312867,466853,384460,403251,193064,570040,177924,52565,258037,98042,113109,696022,615857,243303,347795,395506,379041,332229,572994,14462,24370,697084,461748,728847,460213,700974,287424,691219,336037,421677,310067,209475,362266,462307,5559,157619,579645,405169,715890,76519,550348,236302,109236,622813,269707,312351,225,323494,515247,311232,377125,474193,500931,155986,417426,666599,590237,616234,218448,640956,690893,355574,451744,586577,564184,94644,149391,208814,358909,118445,457656,114671,113907,526072,555827,344437,456530,376649,32307,187500,225008,274958,574369,680648,469738,141454,718398,595649,572334,343500,134997,668874,338556,173466,170465,194263,242624,259576,718214,629292,259111,246268,154273,205723,695678,550532,202659,422459,720045,250431,38221,380384,683709,483053,83036,636985,483338,443643,404894,730109,429814,661474,184972,430788,10564,488658,47924,4694,175534,417433,44240,85255,203209,394021,13455,28179,140881,474561,433645,45151,611890,628047,41977,639271,201597,576568,234501,138013,470034,472001,324719,720010,413102,351288,233666,543125,671434,447482,235888,369253,471022,50935,355722,248377,21097,257724,15028,153285,626789,664675,284884,594664,516023,201402,640271,82866,163191,634713,257642,38035,486518,198789,609154,262800,353120,187200,39443,325243,159393,423575,83241,210827,18896,39081,175056,48038,296393,377610,221229,481077,187887,574979,689323,490372,592022,430104,472213,13483,487867,332796,297023,398656,484271,172877,506556,133245,27543,337308,433709,674563,207946,116920,67328,63086,462049,509526,127136,635643,464253,250792,593294,37250,553917,268928,162277,585455,681180,356438,101434,294300,668139,68242,112344,38511,191123,512220,540132,405268,445350,96789,185939,402237,81951,518819,603762,319071,470476,671672,668425,23963,334742,542256,97050,679157,321625,59594,219003,62650,44905,680911,153184,232539,472708,135345,589217,722594,389417,262231,701582,368590,540156,272657,293871,365917,471926,462648,548261,309358,471340,321362,376148,127918,308340,505209,664028,511371,715400,142070,509600,394093,352903,311023,210984,595241,614878,706800,720788,230781,48850,356287,44897,233594,203677,388590,377379,115208,188020,546654,679318,15707,241504,304081,414424,358002,184109,376212,20049,641677,731363,689379,672467,238571,75028,402235,154442,347122,89814,479559,649762,18412,624440,649399,273111,58596,265243,647724,158641,400794,405897,134001,642623,358046,63869,467141,267690,60065,473476,315479,165575,487318,693629,720821,140601,301367,726338,345969,224499,660533,8421,379619,26198,58319,351953,92041,493100,509952,169454,343054,80308,719055,6707,572802,338069,498921,18622,385695,245559,416138,164819,609519,672891,353380,348023,241623,45912,677102,709387,219726,30629,550407,678301,381971,301378,696278,184381,102089,515130,496910,286144,636756,304826,322283,540328,673960,314193,328585,678297,526953,695265,405663,505357,460661,683172,408940,62454,513494,74787,658669,477462,347992,259312,702373,83718,247827,49535,227033,237280,50625,532612,177458,722786,65810,524961,642763,444643,286163,316732,92745,43822,490254,445305,621915,377802,634903,6526,129068,651032,435330,534447,390896,108009,490541,733421,561521,401240,460586,83820,237191,695991,633546,162483,491692,671227,208850,528633,259867,124067,175011,573164,488256,610276,145804,91326,235157,691238,16013,209596,31606,159401,133611,32748,54776,114225,59218,576253,223978,6492,624134,681307,545586,313619,489634,61804,480077,306618,251075,289111,370743,286740,415587,598143,124339,638169,330964,343489,165057,93181,460966,318869,419257,287738,369347,13069,10603,181005,78251,442027,732423,607761,249033,574322,540984,489904,597453,66180,385184,703625,415774,87123,326467,31761,70956,537711,50544,150733,227899,551760,667326,413234,727849,506453,548767,401160,411102,588750,323139,479982,432176,574199,206854,621113,692734,351539,352058,341309,291180,212825,591206,515192,461532,447784,348962,490665,662665,147520,562933,94983,27303,188856,473937,195126,297200,250091,565195,683134,311707,486616,333135,174935,378698,599299,249558,346100,268665,478831,494370,189589,79461,84551,652487,413719,474885,486599,580668,558713,433826,488885,298927,691638,263433,634070,339147,502165,403180,186011,4404,364795,588922,724442,500304,394844,43289,271159,30836,51758,385556,491357,648333,572202,704220,599491,663232,608830,209846,554884,240377,233664,615616,499737,670815,396376,548539,555043,6950,243877,186746,274718,425917,720876,727582,230708,114288,356235,455101,193158,112087,137592,615129,87911,518972,587808,551474,711605,190836,224104,600526,381830,619667,19495,77816,357278,621016,153502,502966,493134,14886,139179,232798,301136,620317,52912,583266,27591,72086,130751,475538,42639,237742,262667,381445,197205,514108,675761,285416,481364,476003,514585,712761,316055,669316,538227,517172,211699,115903,433592,122960,116965,279483,608504,229383,584951,516887,588373,347994,186821,136789,597666,87339,607530,143012,281265,162470,594243,661118,554593,97243,687945,301563,257749,214812,456295,415610,133137,255652,650323,697195,493543,304737,230368,641262,658985,83099,196721,362186,412823,510489,243567,363636,203799,390325,528962,500234,720186,669423,715004,486949,428520,377167,426444,420163,626960,733583,587998,300358,65357,355350,460645,525819,509926,374556,322836,34513,593556,125582,190513,503545,519498,691981,733644,220225,7509,257870,621433,153389,543662,8266,468064,359379,40523,255996,715648,558,418879,717479,358978,197989,114314,151133,475319,238953,237586,18717,260137,659716,498395,651730,203525,736939,599465,131053,588612,164051,429385,359252,588656,43811,520314,606893,7044,523205,146414,100001,255791,404525,465000,86160,210036,303768,331410,398178,114876,425030,61630,151265,114599,511740,243228,485724,223757,275297,452281,660690,584766,218135,557942,731069,286341,500562,628158,73772,215161,709033,516856,606062,267174,330718,412510,427475,283743,294403,252617,431906,38550,620751,542547,240184,224876,635678,301582,675006,2731,177834,365536,641763,563374,699540,653801,710397,475821,475737,571235,732771,528104,633071,52992,632750,259942,723419,346760,676908,368204,522580,312781,634842,374299,421917,458519,169247,104422,373053,609669,397033,696878,555511,1519,607801,273775,321857,498010,229268,698138,597603,527603,728682,173832,175670,649012,660421,381512,349240,736350,198275,70035,373531,241783,144880,404523,537491,651744,433369,464256,510696,482199,70891,313185,737280,404886,282792,480307,80244,89643,410651,346648,312718,337825,495451,452737,352924,655789,170600,93447,404316,298859,207208,323983,117301,634772,699641,310770,165083,625360,481184,364664,544756,168863,14355,584874,727307,244927,467583,467361,403771,514710,237119,356543,350702,92380,371012,489994,284482,419735,657133,117194,457995,729864,93949,641100,632508,183981,591950,90656,189369,680661,367187,151563,372655,289758,144256,166004,52259,289945,370517,368132,183132,29937,564739,253619,240684,534151,60349,501688,366180,155372,553733,302571,586335,488223,700456,630568,458556,671366,700333,296438,589765,29366,248411,263312,227449,642053,374113,528051,710880,295348,284186,89188,313531,730114,617227,722076,732561,29568,299630,647246,526527,652947,698252,152021,729679,532478,610669,278302,283501,218442,121148,175802,288292,195927,387154,78966,699970,551137,23921,382491,623024,363357,363000,400226,349473,32599,663029,225216,108704,736113,309727,736449,665016,90305,9122,407718,117595,300529,134265,658464,166339,75153,663874,194930,28508,381248,333399,190776,186991,610583,446291,273340,237108,386603,512290,214790,516415,1505,377957,546458,410626,146864,9708,549004,289708,481969,297265,474617,615740,428981,256814,558069,182936,498526,695896,21823,485607,409435,184316,614844,464585,13782,341037,565303,455025,735973,223130,514155,78144,265250,25365,390940,725050,581470,243781,717190,143353,86686,314209,485938,577311,214851,148642,445937,570470,75260,103370,164707,245329,642512,326251,487979,696986,327402,425785,344315,454795,225066,384562,392615,102239,239272,103127,493632,396652,129434,656237,152798,214963,512832,476316,597599,672585,385288,620498,496646,270303,91182,293542,125550,613088,705517,406421,310665,653096,89999,41030,680193,372618,524920,285626,242619,72163,657612,81703,660331,694483,732966,464401,47425,27814,468071,474301,272822,580252,153940,110338,493446,502786,381795,45057,332562,668379,216694,72116,517948,101869,379049,42265,522501,595692,119699,717221,125664,167506,170312,210217,10221,18447,461769,336332,419829,199180,76862,283278,559738,514879,378518,487960,279729,539483,704246,394389,683450,654625,335345,436009,622666,68188,595039,563659,322866,421710,219887,461992,732317,26098,733745,614475,199476,407409,626880,684099,355647,386306,586629,153980,135080,240981,459812,121159,145742,126704,73517,241751,567455,606495,424414,270428,352821,334030,544217,167241,559357,684716,479244,639239,624172,41259,121424,493978,389486,341775,358240,405052,164287,722819,712911,40197,275533,8434,277068,36307,449857,46062,401244,315604,427214,527806,375015,274974,731722,579662,157636,332112,21391,660762,186933,500979,628045,114468,467574,424930,737056,413787,222034,426049,360156,263088,236350,581295,319855,70682,147044,121047,518833,96325,46388,381707,285537,150704,173097,642637,587890,528467,378372,618836,279625,622610,623374,211209,181454,392844,280751,360632,704974,549781,512273,462323,162912,56633,267543,595827,18883,141632,164947,393781,602284,68407,398725,563815,566816,543018,494657,477705,19067,107989,478170,491013,583008,531558,41603,186749,534622,314822,17236,486850,699060,356897,53572,254228,654245,100296,253943,293638,332387,7172,307467,75807,552309,306493,726717,248623,689357,732587,561747,319848,693041,652026,534072,343260,723826,709102,596400,262720,303636,692130,125391,109234,695304,98010,535684,160713,502780,599268,267247,265280,412562,17271,324179,385993,503615,194156,65847,289799,501393,368028,266259,686346,381559,488904,716184,479557,722253,583996,110492,72606,452397,142617,221258,535879,97010,654415,574090,102568,479639,699246,250763,538492,128127,474481,384161,550081,697838,412038,577888,313706,654040,526454,718385,698200,562225,689243,440888,359671,516052,256204,549394,162302,47958,246909,145259,307177,265068,723798,249414,404485,440258,338625,253010,564404,230725,604036,709738,399973,303572,62718,529335,620361,669953,674195,275232,227755,610145,101638,273028,486489,143987,700031,183364,468353,575004,151826,56101,380843,635847,442981,69142,669039,624937,698770,546158,225061,197149,332013,291931,640492,551342,335044,655330,218462,133519,418210,266805,65609,68856,713318,402539,195025,640231,58124,415656,677687,518278,674631,692376,56370,584097,504742,264573,601936,148064,14687,347864,475050,35699,368691,197125,464624,443410,371364,265355,274633,189020,427923,265941,415919,361133,609363,428941,232072,73253,225910,21881,595211,227681,343188,384378,426258,526297,142040,122403,30481,16493,506500,688431,380994,692384,503687,533604,348691,359902,622073,549261,190627,57963,721574,495777,433200,322857,379279,553172,361069,717232,95604,5918,47902,64814,498710,662253,335046,582839,390159,647467,257722,87519,718869,112841,87882,464170,678685,472038,89557,578640,336487,331384,603280,94658,379235,673412,270140,469591,677216,263805,421802,571706,249963,43652,16460,596680,435914,10943,391312,512782,76748,728860,357662,711083,678962,385328,645240,244181,227329,567827,394227,656973,18226,730574,164479,399212,238360,718659,351586,491722,321143,572462,127762,64390,383901,389258,495658,691369,60179,27894,517555,706652,186874,58980,355310,435903,41003,552900,635192,222151,240371,451137,100525,432455,414998,196953,63321,423088,408696,58984,210328,42016,331618,231924,276620,54109,328341,674827,223787,662494,78612,259819,389289,477969,34908,653563,489454,687746,510248,500001,686656,204669,559823,14495,671471,212320,94518,292638,451118,420549,644536,693459,247027,291976,115366,359479,102378,730755,608213,86249,301951,202834,346385,629272,246740,3860,175760,336041,276695,653461,500090,41290,103735,574798,245589,66054,528431,208648,477414,613214,562270,164117,249025,127005,591477,645955,502124,46043,721268,527685,705675,577880,603670,704533,682505,623056,678063,161028,513303,730789,113147,55974,191695,423662,247647,675477,257204,430663,486206,448170,366538,450541,321694,139138,612942,99112,406317,393792,572224,644100,276315,418412,318024,449543,367934,724212,726678,556276,659030,295254,4858,129520,488248,162959,196297,247377,139828,671101,352097,33656,321507,650158,410814,705520,666325,199570,686737,586548,509382,185521,69955,324047,9432,230828,188514,336121,326179,148531,414142,257299,305105,163082,530427,116168,44547,385742,385223,395972,446101,524456,146075,222089,275749,289497,388319,246616,74616,589761,174348,642298,709978,548425,263344,542155,440081,487190,172086,54147,425574,250665,404146,562346,358583,137982,487723,391181,468616,258450,242911,547692,657820,652730,84794,323562,262396,250682,156613,178568,303455,248396,438354,45643,473848,103211,398134,235116,334101,551270,732877,372486,148359,12839,236977,342437,693992,466122,706445,685523,351725,245924,88948,165079,33061,137790,74049,128451,527435,182397,496904,503617,121665,237544,66466,340905,188742,182238,730331,493404,550535,462563,311364,16405,9699,506573,622993,381046,282180,544123,625194,599689,122152,649370,218309,149473,185807,25676,546445,513177,136755,355451,117614,717786,659465,380003,116265,583779,234315,244147,722395,598102,504483,436145,116964,684369,154015,709690,665195,606530,261743,694642,499539,474614,355836,540076,223173,61520,451865,255917,261278,222696,24520,421226,67965,199054,220109,525582,621378,303689,614321,620316,457798,128777,507898,152330,220394,148908,389287,550460,600492,139615,649942,129751,594269,456016,574811,143038,76163,182688,640038,49336,435718,479532,522469,280986,321671,604144,481629,86958,40086,243738,432544,506913,96019,78296,654182,540560,375095,324458,226792,493714,373645,533482,346956,208319,237047,17095,67858,22277,250332,308761,360114,310837,317118,110321,3698,149283,436923,671924,381931,276636,211462,227355,362725,414445,702768,143725,611699,546768,233736,217783,45300,3637,517056,729772,479411,115848,583892,193619,729015,269217,377902,696758,481285,21633,736723,318402,19802,378303,539292,622967,586148,261962,498328,499695,718564,477144,77565,238886,85551,533756,342,137816,606228,148669,573230,307896,378029,148625,693470,216967,130388,730237,214076,590867,637280,481490,332756,272281,651121,527245,433513,405871,339103,622405,312251,675651,586016,622682,225541,494053,251557,513524,461984,285000,76591,152515,519146,179339,6212,450940,236719,109123,663509,522120,28248,220425,131219,470107,406563,324771,309806,453538,442878,484664,305375,698731,116530,194734,497097,512405,101603,435699,62275,734550,559447,371745,95518,173907,37741,83480,26884,261460,261544,166046,4510,209177,104210,684289,104531,477339,13862,390521,60373,369077,214701,424500,102439,362982,315364,278762,568034,632859,364228,127612,340248,40403,181770,735762,129480,463506,415424,239271,508013,39143,139678,209678,8599,563449,561611,88269,76860,355769,388041,931,539006,667246,363750,495498,592401,332758,199790,85537,303912,273025,226585,255082,666390,424096};

/* multiplication inverses of omega */
static const uint32_t w_4_inv[3][3]={{225910,737280,511371},
{737280,1,737280},
{511371,737280,225910}};

static const uint32_t w_9_inv[8][8]={{529254,524434,512414,139802,195672,224866,68225,17175},
{524434,139802,224866,17175,529254,512414,195672,68225},
{512414,224866,1,512414,224866,1,512414,224866},
{139802,17175,512414,68225,524434,224866,529254,195672},
{195672,529254,224866,524434,68225,512414,17175,139802},
{224866,512414,1,224866,512414,1,224866,512414},
{68225,195672,512414,529254,17175,224866,139802,524434},
{17175,68225,224866,195672,139802,512414,524434,529254}};

static const uint32_t omega_256_inv[128]={1,592401,561611,129480,315364,104531,37741,497097,406563,6212,225541,651121,693470,85551,539292,729015,233736,381931,250332,226792,40086,640038,600492,614321,261278,261743,722395,136755,625194,550535,496904,351725,732877,303455,242911,425574,174348,446101,414142,509382,352097,659030,572224,486206,513303,721268,477414,276695,608213,451118,510248,223787,408696,635192,60179,351586,227329,391312,677216,89557,390159,361069,622073,30481,225910,274633,14687,677687,418210,225061,151826,227755,604036,307177,689243,550081,654415,479557,194156,160713,709102,248623,100296,186749,543018,595827,392844,642637,70682,424930,579662,36307,341775,167241,126704,684099,421710,394389,199180,717221,668379,474301,72163,406421,672585,103127,696986,148642,725050,341037,182936,9708,237108,663874,665016,363000,288292,698252,313531,248411,586335,564739,372655,93949,350702,14355,117301,495451};
static const uint32_t omega_1024_inv[1024]={1,147369,273025,522493,592401,99759,931,66273,561611,572804,39143,715504,129480,505840,127612,226361,315364,369481,369077,551762,104531,617006,166046,413865,37741,542846,734550,90687,497097,447633,484664,352141,406563,379563,522120,182558,6212,490507,285000,215554,225541,386868,622405,285078,651121,140342,590867,380980,693470,723739,148669,159665,85551,60219,499695,663456,539292,454634,21633,30533,729015,573339,729772,64960,233736,409545,414445,724446,381931,20718,110321,112118,250332,584392,208319,119152,226792,425237,78296,692855,40086,338362,280986,713031,640038,664411,456016,196035,600492,278961,152330,725163,614321,400178,199054,189779,261278,514638,540076,238813,261743,474090,684369,632609,722395,413322,380003,483752,136755,608741,149473,679381,625194,631702,506573,506063,550535,653894,340905,501605,496904,22094,137790,518489,351725,295382,342437,662927,732877,531485,103211,732110,303455,80840,323562,96984,242911,346766,137982,59378,425574,343822,542155,647349,174348,722124,289497,118328,446101,323342,116168,634453,414142,308499,230828,220754,509382,113662,705520,410260,352097,557856,162959,388139,659030,40502,449543,318112,572224,89719,139138,106031,486206,512591,423662,215636,513303,656488,704533,201414,721268,216684,127005,721660,477414,247060,574798,455091,276695,202469,629272,718469,608213,490427,291976,491984,451118,180772,14495,210598,510248,185603,477969,198664,223787,687273,231924,272639,408696,635934,432455,628536,635192,202245,58980,17911,60179,503183,64390,283440,351586,454959,730574,289938,227329,673323,711083,367535,391312,87432,43652,174863,677216,76701,94658,298282,89557,595633,112841,629655,390159,482886,64814,99011,361069,70410,495777,562737,622073,19116,692384,670982,30481,438637,384378,102252,225910,207235,361133,654654,274633,87363,197125,505444,14687,488768,584097,234043,677687,183086,402539,140631,418210,396138,551342,141155,225061,428724,69142,163978,151826,179287,143987,273023,227755,46351,529335,290691,604036,559749,440258,390483,307177,51194,549394,605933,689243,60140,654040,475630,550081,103658,250763,694265,654415,442930,452397,659068,479557,502559,266259,227751,194156,174516,412562,446275,160713,436534,125391,272576,709102,392822,693041,171323,248623,143592,307467,25906,100296,249017,699060,236291,186749,525494,478170,328593,543018,277183,602284,417611,595827,685749,512273,9023,392844,248754,279625,684254,642637,290322,46388,83740,70682,29690,360156,444936,424930,547435,186933,361993,579662,620775,427214,200814,36307,78066,712911,650502,341775,425741,624172,425908,167241,309661,424414,444974,126704,600451,135080,17520,684099,656153,733745,160883,421710,90938,622666,409775,394389,114030,378518,613244,199180,326248,10221,730747,717221,274670,379049,714397,668379,552375,493446,618544,474301,76145,732966,376268,72163,48003,680193,112019,406421,97033,91182,453933,672585,333068,152798,389441,103127,149610,225066,428288,696986,564600,164707,678082,148642,604388,86686,698528,725050,181806,514155,139825,341037,47726,409435,424037,182936,415619,474617,196046,9708,333112,1505,606045,237108,410419,190776,469252,663874,207930,300529,188531,665016,403260,225216,415208,363000,49483,551137,159031,288292,223404,278302,357251,698252,601661,29568,75882,313531,86950,528051,550112,248411,604447,671366,586821,586335,481258,501688,194754,564739,5130,289945,521631,372655,682129,90656,352344,93949,507563,419735,263158,350702,679500,467361,681313,14355,222806,625360,27402,117301,240743,93447,256425,495451,443708,89643,735590,737280,589912,464256,214788,144880,637522,736350,671008,175670,164477,698138,21777,607801,231441,609669,510920,421917,367800,368204,185519,632750,120275,571235,323416,699540,194435,2731,646594,240184,289648,252617,385140,330718,357718,215161,554723,731069,246774,452281,521727,511740,350413,114876,452203,86160,596939,146414,356301,43811,13542,588612,577616,651730,677062,237586,73825,197989,282647,715648,706748,8266,163942,7509,672321,503545,327736,322836,12835,355350,716563,626960,625163,486949,152889,528962,618129,510489,312044,658985,44426,697195,398919,456295,24250,97243,72870,281265,541246,136789,458320,584951,12118,122960,337103,538227,547502,476003,222643,197205,498468,475538,263191,52912,104672,14886,323959,357278,253529,600526,128540,587808,57900,112087,105579,230708,231218,186746,83387,396376,235676,240377,715187,599491,218792,385556,441899,394844,74354,4404,205796,634070,5171,433826,656441,413719,640297,494370,390515,599299,677903,311707,393459,195126,89932,562933,15157,447784,618953,291180,413939,621113,102828,323139,428782,506453,516527,227899,623619,31761,327021,385184,179425,574322,349142,78251,696779,287738,419169,165057,647562,598143,631250,251075,224690,313619,521645,223978,80793,32748,535867,16013,520597,610276,15621,259867,490221,162483,282190,460586,534812,108009,18812,129068,246854,445305,245297,286163,556509,722786,526683,227033,551678,259312,538617,513494,50008,505357,464642,328585,101347,304826,108745,102089,535036,678301,719370,677102,234098,672891,453841,385695,282322,6707,447343,509952,63958,26198,369746,345969,649849,693629,562418,60065,660580,642623,438999,647724,141648,624440,107626,347122,254395,672467,638270,376212,666871,241504,174544,115208,718165,44897,66299,706800,298644,352903,635029,511371,530046,376148,82627,462648,649918,540156,231837,722594,248513,153184,503238,59594,554195,334742,596650,319071,341143,185939,596126,512220,308557,668139,573303,585455,557994,593294,464258,509526,690930,207946,446590,133245,177532,297023,346798,430104,686087,187887,131348,48038,677141,83241,261651,187200,633623,486518,43016,82866,294351,284884,78213,257724,234722,471022,509530,543125,562765,324719,291006,576568,300747,611890,464705,28179,344459,44240,565958,488658,593689,429814,711375,636985,488264,38221,500990,550532,211787,259111,408688,194263,460098,134997,319670,141454,51532,225008,728258,344437,488527,457656,53027,94644,446959,690893,653541,666599,707591,377125,292345,312351,189846,550348,375288,157619,116506,310067,536467,700974,659215,24370,86779,395506,311540,113109,311373,570040,427620,312867,292307,610577,136830,602201,719761,53182,81128,3536,576398,315571,646343,114615,327506,342892,623251,358763,124037,538101,411033,727060,6534,20060,462611,358232,22884,68902,184906,243835,118737,262980,661136,4315,361013,665118,689278,57088,625262,330860,640248,646099,283348,64696,404213,584483,347840,634154,587671,512215,308993,40295,172681,572574,59199,588639,132893,650595,38753,12231,555475,223126,597456,396244,689555,327846,313244,554345,321662,262664,541235,727573,404169,735776,131236,500173,326862,546505,268029,73407,529351,436752,548750,72265,334021,512065,322073,374281,687798,186144,578250,448989,513877,458979,380030,39029,135620,707713,661399,423750,650331,209230,187169,488870,132834,65915,150460,150946,256023,235593,542527,172542,732151,447336,215650,364626,55152,646625,384937,643332,229718,317546,474123,386579,57781,269920,55968,722926,514475,111921,709879,619980,496538,643834,480856,241830,293573,647638,1691};
static const uint32_t omega_2304_inv[2304]={1,316190,75219,285112,3567,547081,673170,284005,189712,592401,610454,21741,616027,47021,298625,135642,270929,361120,561611,178678,565633,85133,73960,333642,412095,646920,606003,129480,541832,611391,642090,317254,301243,691780,340244,655964,315364,637034,85822,430975,549863,236,155459,56940,193861,104531,86941,352705,669890,535172,460527,297349,707190,138015,37741,433805,308429,533078,437005,566897,142991,41527,184801,497097,587726,670609,55953,721475,328759,322739,518481,390635,406563,314372,320979,671236,715775,697804,671981,347405,702603,6212,55696,561555,166782,39774,339043,611489,662908,315906,225541,304065,132669,271334,131176,59504,633202,535706,468638,651121,339831,568231,215719,113457,87213,94508,485590,671131,693470,172619,226461,710151,29735,102338,463692,548382,633562,85551,268081,72101,149389,663364,728751,610479,553681,284659,539292,387800,541609,142716,88435,143444,243083,344082,628658,729015,34605,504910,351565,6418,310108,573768,654655,37295,233736,675681,185458,320685,608782,719819,187629,360564,232849,381931,558776,313724,393977,589870,283449,598231,58373,603597,250332,198763,303249,169979,86953,460580,97956,270111,503331,226792,675139,596951,102442,169807,261067,56689,456519,393868,40086,194669,486825,406851,691529,602902,208020,268509,478998,640038,302654,43584,305789,393570,187434,635118,310764,81166,600492,538674,361845,504970,153659,95872,459365,50507,301870,614321,316573,261905,340030,83875,438680,80108,59765,583320,261278,417489,107546,95458,55442,612924,230462,612145,170306,261743,726920,432174,699239,239535,643644,647368,701171,649947,722395,734845,219805,349485,723151,158160,314732,608105,470679,136755,507362,29833,123156,462344,472680,245847,615257,620732,625194,309140,473463,96201,529254,467285,469031,313302,409658,550535,142988,567519,696425,379042,577025,503928,248286,606741,496904,20098,161681,325412,33044,173309,162385,264310,640269,351725,461710,548652,480266,488094,571097,297910,405059,310857,732877,223049,511974,693576,511114,89584,703502,407837,585006,303455,424391,99166,211172,95477,164804,567523,486623,679918,242911,518196,224767,350297,158362,41665,319442,555385,120008,425574,350469,721529,445556,698160,431628,583253,457697,538783,174348,593750,265065,484675,371433,435218,292613,649061,7554,446101,497956,138247,403002,189869,99123,623341,547465,438765,414142,555132,487567,564473,470671,556359,642891,698061,94620,509382,248287,185650,572123,305210,165248,135212,706214,457314,352097,119430,513442,373466,340456,595673,41610,623736,104745,659030,229389,489535,561229,308182,585934,289937,185928,736504,572224,537317,389557,177565,329200,416420,512415,49976,505048,486206,64706,579671,328733,211890,37349,350533,313821,98605,513303,659916,206949,40998,283078,519420,168802,258228,401537,721268,495438,235307,482777,389547,702070,314291,514424,476745,477414,408877,595280,379429,553909,122441,731761,512608,617604,276695,216747,15856,735121,489087,466061,524996,405371,166483,608213,704273,150316,333656,415069,225424,173885,179418,90875,451118,194474,24098,484766,390764,644618,432970,236377,394098,510248,537576,444576,489980,445108,602992,648442,402690,334243,223787,142117,171842,61404,510187,419292,279903,55611,227521,408696,135527,35848,558307,214095,505754,320203,85088,591030,635192,115832,486405,317631,65351,295384,184442,526161,126221,60179,249962,436142,488897,109722,241725,55604,226034,619444,351586,10879,415145,662872,729562,466781,361967,4257,483005,227329,157258,439099,590419,610724,605726,281289,350037,524434,391312,655703,365246,174181,136971,237269,56955,513025,495535,677216,406210,28733,310788,296916,193905,8552,447453,363856,89557,276463,588767,259792,207146,398824,355601,653128,134220,390159,305447,636897,267371,447906,565412,248838,408024,730056,361069,656103,28914,33260,640497,189507,654179,673460,556261,622073,699409,170322,159816,455862,570280,19030,145459,355149,30481,50158,543710,167725,345420,491584,364540,340184,116589,225910,487777,609083,46479,710118,654680,569235,639649,430671,274633,726652,480569,447134,506743,424969,11298,188175,476550,14687,486792,294515,421145,41578,90309,646861,382818,115245,677687,400938,67394,413398,502411,557987,40792,28666,507207,418210,260707,506844,657076,235607,230528,99536,711074,647110,225061,412751,154318,551840,630859,669941,440680,610291,92441,151826,22468,454485,172440,399088,517008,604357,201126,594566,227755,669056,42029,396766,655704,681436,249400,422083,240836,604036,448914,42259,129647,261330,639187,332529,175662,240926,307177,583095,634785,450677,100793,30164,88144,292279,472784,689243,327942,43859,258881,434927,441448,141481,352715,145385,550081,362523,333019,279752,234186,665948,119082,334191,2089,654415,91638,613201,78653,66659,257263,512521,388471,368171,479557,442808,325058,168496,87899,240234,476154,141217,191308,194156,483175,158116,410711,247593,459528,717088,28790,638874,160713,225107,211871,665268,395934,57660,30832,440698,403463,709102,122875,86674,717290,493004,350211,245419,208360,130083,248623,257026,40872,256312,626479,371459,546067,36464,689163,100296,661868,305632,149567,174547,109394,488026,451326,343985,186749,68301,395419,158911,368940,326937,41020,603729,699676,543018,336702,640823,48107,108019,722566,244541,548477,443091,595827,74324,410966,512414,471067,429829,201094,61139,32590,392844,665166,584918,495413,440648,76864,634557,612895,645605,642637,12149,158300,344472,79550,573185,636135,421478,638946,70682,479908,96067,184811,709873,602635,572605,91623,294037,424930,213665,203758,416397,612855,531782,583001,404165,15620,579662,432147,272200,420465,318430,551059,675604,169101,427070,36307,445160,87409,136144,482894,519727,655321,494750,194482,341775,349237,459817,673154,385932,460770,454295,553382,115817,167241,663908,212357,241879,88318,13264,289832,163623,211319,126704,162782,453970,273691,737196,403247,241914,95753,434086,684099,288468,189848,94662,518304,458361,363858,721937,426901,421710,266926,564027,270602,186330,295271,581741,136505,348929,394389,361413,307875,99415,53415,392983,378716,718425,312807,199180,181180,570500,276416,473457,410904,77940,231175,447629,717221,57043,321067,479278,699518,720106,248596,567268,221802,668379,530170,345892,65221,478420,727906,325651,399792,455906,474301,379542,156610,512097,509053,178398,506153,404962,606229,72163,583863,165975,710951,94352,557777,733463,452858,353448,406421,389533,699096,735787,209261,426807,191090,569150,305615,672585,370386,423457,427387,735602,696591,519631,529602,646536,103127,736624,176412,716225,688071,605605,360911,95910,678089,696986,76911,12586,461783,37530,73005,657402,94207,421649,148642,399354,573514,706024,100975,68826,506944,572993,384697,725050,456236,123099,134258,608883,214645,411938,402917,593116,341037,719094,244270,385583,702610,7699,582229,345496,191751,182936,627547,387681,516330,39027,75033,456252,21172,600481,9708,271717,317862,114422,713510,427305,612857,426881,733439,237108,22754,199262,303925,102929,62608,28670,297405,719086,663874,521112,633557,716444,629267,121103,131554,139802,312025,665016,342402,271778,436146,279095,410598,644892,69872,202515,363000,13044,32446,572906,155564,79245,719046,550051,461476,288292,573764,127176,473700,567850,661413,208977,577129,210043,698252,29868,130591,145885,129666,370692,593786,588690,243435,313531,563630,80942,552908,647081,640204,443243,733442,448397,248411,317317,314626,269610,607556,143404,129260,284446,283393,586335,269795,120226,50580,528029,207060,485881,522296,463769,564739,527177,658026,542740,172321,373809,413319,590955,513934,372655,484154,50106,322012,680023,265216,306100,670287,724832,93949,682820,648727,568558,390509,379797,421431,523636,221794,350702,665699,276839,36685,525458,503513,265454,356658,140384,14355,205614,389361,135929,331896,567824,550564,465126,537027,117301,482485,222192,119271,374340,210141,719070,28520,54889,495451,659372,723343,409598,11160,53534,418262,482405,731827,737280,421091,662062,452169,733714,190200,64111,453276,547569,144880,126827,715540,121254,690260,438656,601639,466352,376161,175670,558603,171648,652148,663321,403639,325186,90361,131278,607801,195449,125890,95191,420027,436038,45501,397037,81317,421917,100247,651459,306306,187418,737045,581822,680341,543420,632750,650340,384576,67391,202109,276754,439932,30091,599266,699540,303476,428852,204203,300276,170384,594290,695754,552480,240184,149555,66672,681328,15806,408522,414542,218800,346646,330718,422909,416302,66045,21506,39477,65300,389876,34678,731069,681585,175726,570499,697507,398238,125792,74373,421375,511740,433216,604612,465947,606105,677777,104079,201575,268643,86160,397450,169050,521562,623824,650068,642773,251691,66150,43811,564662,510820,27130,707546,634943,273589,188899,103719,651730,469200,665180,587892,73917,8530,126802,183600,452622,197989,349481,195672,594565,648846,593837,494198,393199,108623,8266,702676,232371,385716,730863,427173,163513,82626,699986,503545,61600,551823,416596,128499,17462,549652,376717,504432,355350,178505,423557,343304,147411,453832,139050,678908,133684,486949,538518,434032,567302,650328,276701,639325,467170,233950,510489,62142,140330,634839,567474,476214,680592,280762,343413,697195,542612,250456,330430,45752,134379,529261,468772,258283,97243,434627,693697,431492,343711,549847,102163,426517,656115,136789,198607,375436,232311,583622,641409,277916,686774,435411,122960,420708,475376,397251,653406,298601,657173,677516,153961,476003,319792,629735,641823,681839,124357,506819,125136,566975,475538,10361,305107,38042,497746,93637,89913,36110,87334,14886,2436,517476,387796,14130,579121,422549,129176,266602,600526,229919,707448,614125,274937,264601,491434,122024,116549,112087,428141,263818,641080,208027,269996,268250,423979,327623,186746,594293,169762,40856,358239,160256,233353,488995,130540,240377,717183,575600,411869,704237,563972,574896,472971,97012,385556,275571,188629,257015,249187,166184,439371,332222,426424,4404,514232,225307,43705,226167,647697,33779,329444,152275,433826,312890,638115,526109,641804,572477,169758,250658,57363,494370,219085,512514,386984,578919,695616,417839,181896,617273,311707,386812,15752,291725,39121,305653,154028,279584,198498,562933,143531,472216,252606,365848,302063,444668,88220,729727,291180,239325,599034,334279,547412,638158,113940,189816,298516,323139,182149,249714,172808,266610,180922,94390,39220,642661,227899,488994,551631,165158,432071,572033,602069,31067,279967,385184,617851,223839,363815,396825,141608,695671,113545,632536,78251,507892,247746,176052,429099,151347,447344,551353,777,165057,199964,347724,559716,408081,320861,224866,687305,232233,251075,672575,157610,408548,525391,699932,386748,423460,638676,223978,77365,530332,696283,454203,217861,568479,479053,335744,16013,241843,501974,254504,347734,35211,422990,222857,260536,259867,328404,142001,357852,183372,614840,5520,224673,119677,460586,520534,721425,2160,248194,271220,212285,331910,570798,129068,33008,586965,403625,322212,511857,563396,557863,646406,286163,542807,713183,252515,346517,92663,304311,500904,343183,227033,199705,292705,247301,292173,134289,88839,334591,403038,513494,595164,565439,675877,227094,317989,457378,681670,509760,328585,601754,701433,178974,523186,231527,417078,652193,146251,102089,621449,250876,419650,671930,441897,552839,211120,611060,677102,487319,301139,248384,627559,495556,681677,511247,117837,385695,726402,322136,74409,7719,270500,375314,733024,254276,509952,580023,298182,146862,126557,131555,455992,387244,212847,345969,81578,372035,563100,600310,500012,680326,224256,241746,60065,331071,708548,426493,440365,543376,728729,289828,373425,647724,460818,148514,477489,530135,338457,381680,84153,603061,347122,431834,100384,469910,289375,171869,488443,329257,7225,376212,81178,708367,704021,96784,547774,83102,63821,181020,115208,37872,566959,577465,281419,167001,718251,591822,382132,706800,687123,193571,569556,391861,245697,372741,397097,620692,511371,249504,128198,690802,27163,82601,168046,97632,306610,462648,10629,256712,290147,230538,312312,725983,549106,260731,722594,250489,442766,316136,695703,646972,90420,354463,622036,59594,336343,669887,323883,234870,179294,696489,708615,230074,319071,476574,230437,80205,501674,506753,637745,26207,90171,512220,324530,582963,185441,106422,67340,296601,126990,644840,585455,714813,282796,564841,338193,220273,132924,536155,142715,509526,68225,695252,340515,81577,55845,487881,315198,496445,133245,288367,695022,607634,475951,98094,404752,561619,496355,430104,154186,102496,286604,636488,707117,649137,445002,264497,48038,409339,693422,478400,302354,295833,595800,384566,591896,187200,374758,404262,457529,503095,71333,618199,403090,735192,82866,645643,124080,658628,670622,480018,224760,348810,369110,257724,294473,412223,568785,649382,497047,261127,596064,545973,543125,254106,579165,326570,489688,277753,20193,708491,98407,576568,512174,525410,72013,341347,679621,706449,296583,333818,28179,614406,650607,19991,244277,387070,491862,528921,607198,488658,480255,696409,480969,110802,365822,191214,700817,48118,636985,75413,431649,587714,562734,627887,249255,285955,393296,550532,668980,341862,578370,368341,410344,696261,133552,37605,194263,400579,96458,689174,629262,14715,492740,188804,294190,141454,662957,326315,224867,266214,307452,536187,676142,704691,344437,72115,152363,241868,296633,660417,102724,124386,91676,94644,725132,578981,392809,657731,164096,101146,315803,98335,666599,257373,641214,552470,27408,134646,164676,645658,443244,312351,523616,533523,320884,124426,205499,154280,333116,721661,157619,305134,465081,316816,418851,186222,61677,568180,310211,700974,292121,649872,601137,254387,217554,81960,242531,542799,395506,388044,277464,64127,351349,276511,282986,183899,621464,570040,73373,524924,495402,648963,724017,447449,573658,525962,610577,574499,283311,463590,85,334034,495367,641528,303195,53182,448813,547433,642619,218977,278920,373423,15344,310380,315571,470355,173254,466679,550951,442010,155540,600776,388352,342892,375868,429406,637866,683866,344298,358565,18856,424474,538101,556101,166781,460865,263824,326377,659341,506106,289652,20060,680238,416214,258003,37763,17175,488685,170013,515479,68902,207111,391389,672060,258861,9375,411630,337489,281375,262980,357739,580671,225184,228228,558883,231128,332319,131052,665118,153418,571306,26330,642929,179504,3818,284423,383833,330860,347748,38185,1494,528020,310474,546191,168131,431666,64696,366895,313824,309894,1679,40690,217650,207679,90745,634154,657,560869,21056,49210,131676,376370,641371,59192,40295,660370,724695,275498,699751,664276,79879,643074,315632,588639,337927,163767,31257,636306,668455,230337,164288,352584,12231,281045,614182,603023,128398,522636,325343,334364,144165,396244,18187,493011,351698,34671,729582,155052,391785,545530,554345,109734,349600,220951,698254,662248,281029,716109,136800,727573,465564,419419,622859,23771,309976,124424,310400,3842,500173,714527,538019,433356,634352,674673,708611,439876,18195,73407,216169,103724,20837,108014,616178,605727,597479,425256,72265,394879,465503,301135,458186,326683,92389,667409,534766,374281,724237,704835,164375,581717,658036,18235,187230,275805,448989,163517,610105,263581,169431,75868,528304,160152,527238,39029,707413,606690,591396,607615,366589,143495,148591,493846,423750,173651,656339,184373,90200,97077,294038,3839,288884,488870,419964,422655,467671,129725,593877,608021,452835,453888,150946,467486,617055,686701,209252,530221,251400,214985,273512,172542,210104,79255,194541,564960,363472,323962,146326,223347,364626,253127,687175,415269,57258,472065,431181,66994,12449,643332,54461,88554,168723,346772,357484,315850,213645,515487,386579,71582,460442,700596,211823,233768,471827,380623,596897,722926,531667,347920,601352,405385,169457,186717,272155,200254,619980,254796,515089,618010,362941,527140,18211,708761,682392,241830,77909,13938,327683,726121,683747,319019,254876,5454};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = barrett_4q2((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = barrett_4q2((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n)
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = barrett_2q2((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 6 --> 256 * 10 */
static void ntt_butterfly_1536_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g);
	a[N2_2560 + n2] = (b + c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4]) % Q;
	a[N2_2560 * 2 + n2] = (b + c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4]) % Q;
	a[N2_2560 * 3 + n2] = (b + c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4]) % Q;
	a[N2_2560 * 4 + n2] = (b + c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4]) % Q;
	a[N2_2560 * 5 + n2] = (b + c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4]) % Q;
	a[N2_2560 * 6 + n2] = (b + c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4]) % Q;
	a[N2_2560 * 7 + n2] = (b + c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4]) % Q;
	a[N2_2560 * 8 + n2] = (b + c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4]) % Q;
	a[N2_2560 * 9 + n2] = (b + c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4]) % Q;
}

/* 256 * 10 --> 256 * 4 */
static void ntt_butterfly_2560_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	k = a[N2_2560 * 9 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j + k);
	a[N2_2560 + n2] = (b + c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7] + k * w_10[0][8]) % Q;
	a[N2_2560 * 2 + n2] = (b + c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7] + k * w_10[1][8]) % Q;
	a[N2_2560 * 3 + n2] = (b + c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7] + k * w_10[2][8]) % Q;
}

/* 256 * 3 --> 256 * 9 */
static void ntt_butterfly_768_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_2304 + n2] = (b + c * w_9[0][0] + d * w_9[0][1]) % Q;
	a[N2_2304 * 2 + n2] = (b + c * w_9[1][0] + d * w_9[1][1]) % Q;
	a[N2_2304 * 3 + n2] = (b + c * w_9[2][0] + d * w_9[2][1]) % Q;
	a[N2_2304 * 4 + n2] = (b + c * w_9[3][0] + d * w_9[3][1]) % Q;
	a[N2_2304 * 5 + n2] = (b + c * w_9[4][0] + d * w_9[4][1]) % Q;
	a[N2_2304 * 6 + n2] = (b + c * w_9[5][0] + d * w_9[5][1]) % Q;
	a[N2_2304 * 7 + n2] = (b + c * w_9[6][0] + d * w_9[6][1]) % Q;
	a[N2_2304 * 8 + n2] = (b + c * w_9[7][0] + d * w_9[7][1]) % Q;
}

/* 256 * 6 --> 256 * 9 */
static void ntt_butterfly_1536_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g);
	a[N2_2304 + n2] = (b + c * w_9[0][0] + d * w_9[0][1] + e * w_9[0][2] + f * w_9[0][3] + g * w_9[0][4]) % Q;
	a[N2_2304 * 2 + n2] = (b + c * w_9[1][0] + d * w_9[1][1] + e * w_9[1][2] + f * w_9[1][3] + g * w_9[1][4]) % Q;
	a[N2_2304 * 3 + n2] = (b + c * w_9[2][0] + d * w_9[2][1] + e * w_9[2][2] + f * w_9[2][3] + g * w_9[2][4]) % Q;
	a[N2_2304 * 4 + n2] = (b + c * w_9[3][0] + d * w_9[3][1] + e * w_9[3][2] + f * w_9[3][3] + g * w_9[3][4]) % Q;
	a[N2_2304 * 5 + n2] = (b + c * w_9[4][0] + d * w_9[4][1] + e * w_9[4][2] + f * w_9[4][3] + g * w_9[4][4]) % Q;
	a[N2_2304 * 6 + n2] = (b + c * w_9[5][0] + d * w_9[5][1] + e * w_9[5][2] + f * w_9[5][3] + g * w_9[5][4]) % Q;
	a[N2_2304 * 7 + n2] = (b + c * w_9[6][0] + d * w_9[6][1] + e * w_9[6][2] + f * w_9[6][3] + g * w_9[6][4]) % Q;
	a[N2_2304 * 8 + n2] = (b + c * w_9[7][0] + d * w_9[7][1] + e * w_9[7][2] + f * w_9[7][3] + g * w_9[7][4]) % Q;
}

/* 256 * 9 --> 256 * 9 */
static void ntt_butterfly_2304_2304_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	h = a[N2_2304 * 6 + n2];
	i = a[N2_2304 * 7 + n2];
	j = a[N2_2304 * 8 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j);
	a[N2_2304 + n2] = (b + c * w_9_inv[0][0] + d * w_9_inv[0][1] + e * w_9_inv[0][2] + f * w_9_inv[0][3] + g * w_9_inv[0][4] + h * w_9_inv[0][5] + i * w_9_inv[0][6] + j * w_9_inv[0][7]) % Q;
	a[N2_2304 * 2 + n2] = (b + c * w_9_inv[1][0] + d * w_9_inv[1][1] + e * w_9_inv[1][2] + f * w_9_inv[1][3] + g * w_9_inv[1][4] + h * w_9_inv[1][5] + i * w_9_inv[1][6] + j * w_9_inv[1][7]) % Q;
	a[N2_2304 * 3 + n2] = (b + c * w_9_inv[2][0] + d * w_9_inv[2][1] + e * w_9_inv[2][2] + f * w_9_inv[2][3] + g * w_9_inv[2][4] + h * w_9_inv[2][5] + i * w_9_inv[2][6] + j * w_9_inv[2][7]) % Q;
	a[N2_2304 * 4 + n2] = (b + c * w_9_inv[3][0] + d * w_9_inv[3][1] + e * w_9_inv[3][2] + f * w_9_inv[3][3] + g * w_9_inv[3][4] + h * w_9_inv[3][5] + i * w_9_inv[3][6] + j * w_9_inv[3][7]) % Q;
	a[N2_2304 * 5 + n2] = (b + c * w_9_inv[4][0] + d * w_9_inv[4][1] + e * w_9_inv[4][2] + f * w_9_inv[4][3] + g * w_9_inv[4][4] + h * w_9_inv[4][5] + i * w_9_inv[4][6] + j * w_9_inv[4][7]) % Q;
	a[N2_2304 * 6 + n2] = (b + c * w_9_inv[5][0] + d * w_9_inv[5][1] + e * w_9_inv[5][2] + f * w_9_inv[5][3] + g * w_9_inv[5][4] + h * w_9_inv[5][5] + i * w_9_inv[5][6] + j * w_9_inv[5][7]) % Q;
	a[N2_2304 * 7 + n2] = (b + c * w_9_inv[6][0] + d * w_9_inv[6][1] + e * w_9_inv[6][2] + f * w_9_inv[6][3] + g * w_9_inv[6][4] + h * w_9_inv[6][5] + i * w_9_inv[6][6] + j * w_9_inv[6][7]) % Q;
	a[N2_2304 * 8 + n2] = (b + c * w_9_inv[7][0] + d * w_9_inv[7][1] + e * w_9_inv[7][2] + f * w_9_inv[7][3] + g * w_9_inv[7][4] + h * w_9_inv[7][5] + i * w_9_inv[7][6] + j * w_9_inv[7][7]) % Q;
}

/* 256 * 4 --> 256 * 4 */
static void ntt_butterfly_1024_1024_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	e = a[N2_1024 * 3 + n2];
	
	a[n2] = barrett_8q(b + c + d + e);
	a[N2_1024 + n2] = (b + c * w_4_inv[0][0] + d * w_4_inv[0][1] + e * w_4_inv[0][2]) % Q;
	a[N2_1024 * 2 + n2] = (b + c * w_4_inv[1][0] + d * w_4_inv[1][1] + e * w_4_inv[1][2]) % Q;
	a[N2_1024 * 3 + n2] = (b + c * w_4_inv[2][0] + d * w_4_inv[2][1] + e * w_4_inv[2][2]) % Q;
}

/* 256 * 3 --> 256 * 4 */
static void ntt_butterfly_768_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_1024 + n2] = (b + c * w_4[0][0] + d * w_4[0][1]) % Q;
	a[N2_1024 * 2 + n2] = (b + c * w_4[1][0] + d * w_4[1][1]) % Q;
	a[N2_1024 * 3 + n2] = (b + c * w_4[2][0] + d * w_4[2][1]) % Q;
}

/* 256 * 4 --> 256 * 1 */
static void ntt_butterfly_1024_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_8q(a[n2] + a[N2_1024 + n2] + a[N2_1024 * 2 + n2] + a[N2_1024 * 3 + n2]);
}

/* 256 * 9 --> 256 * 10 */
static void ntt_butterfly_2304_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j);
	a[N2_2560 + n2] = (b + c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7]) % Q;
	a[N2_2560 * 2 + n2] = (b + c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7]) % Q;
	a[N2_2560 * 3 + n2] = (b + c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7]) % Q;
	a[N2_2560 * 4 + n2] = (b + c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4] + h * w_10[3][5] + i * w_10[3][6] + j * w_10[3][7]) % Q;
	a[N2_2560 * 5 + n2] = (b + c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4] + h * w_10[4][5] + i * w_10[4][6] + j * w_10[4][7]) % Q;
	a[N2_2560 * 6 + n2] = (b + c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4] + h * w_10[5][5] + i * w_10[5][6] + j * w_10[5][7]) % Q;
	a[N2_2560 * 7 + n2] = (b + c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4] + h * w_10[6][5] + i * w_10[6][6] + j * w_10[6][7]) % Q;
	a[N2_2560 * 8 + n2] = (b + c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4] + h * w_10[7][5] + i * w_10[7][6] + j * w_10[7][7]) % Q;
	a[N2_2560 * 9 + n2] = (b + c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4] + h * w_10[8][5] + i * w_10[8][6] + j * w_10[8][7]) % Q;
}

/* 256 * 10 --> 256 * 1 */
static void ntt_butterfly_2560_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_32q(a[n2] + a[N2_2560 + n2] + a[N2_2560 * 2 + n2] + a[N2_2560 * 3 + n2] + a[N2_2560 * 4 + n2] + a[N2_2560 * 5 + n2] + a[N2_2560 * 6 + n2] + a[N2_2560 * 7 + n2] + a[N2_2560 * 8 + n2] + a[N2_2560 * 9 + n2]);	
}

void ntt_1536_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_1536_2560);
}

void intt_2560_1024(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 1024, omega_256, omega_2560, ntt_butterfly_2560_1024, INV_2560);
}

void ntt_768_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_768_2304);
}

void ntt_1536_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_1536_2304);
}

void intt_2304_2304_inv(uint32_t *a)
{
	intt_core(a, N1_2304, N2_2304, 2304, omega_256_inv, omega_2304_inv, ntt_butterfly_2304_2304_inv, INV_2304);
}

void ntt_1024_1024_inv(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256_inv, omega_1024_inv, ntt_butterfly_1024_1024_inv);
}

void ntt_768_1024(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256, omega_1024, ntt_butterfly_768_1024);
}

void intt_1024_256(uint32_t *a)
{
	intt_core(a, N1_1024, N2_1024, 256, omega_256, omega_1024, ntt_butterfly_1024_256, INV_1024);
}

void ntt_2304_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_2304_2560);
}

void intt_2560_256(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 256, omega_256, omega_2560, ntt_butterfly_2560_256, INV_2560);
}
