/* ****************************** *
 * Titanium_CPA_med               *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>
#include <x86intrin.h>

/* 768=3*256 */
#define N1_768 3
#define N2_768 256

/* 1792=7*256 */
#define N1_1792 7
#define N2_1792 256

/* 2048=8*256 */
#define N1_2048 8
#define N2_2048 256

/* multiplication inverses of 768, 1792, 2048 (in Montgomery form) */
#define INV_768 103083
#define INV_1792 216211
#define INV_2048 1024

/* omega_n: n-th root of unity mod Q */
static const __m256i w_3[2]={{11096,11096,11096,11096},{289960,289960,289960,289960}};

static const __m256i w_7[6][6]={{{5408,5408,5408,5408},{43935,43935,43935,43935},{66507,66507,66507,66507},{207798,207798,207798,207798},{226860,226860,226860,226860},{51605,51605,51605,51605}},
{{43935,43935,43935,43935},{207798,207798,207798,207798},{51605,51605,51605,51605},{5408,5408,5408,5408},{66507,66507,66507,66507},{226860,226860,226860,226860}},
{{66507,66507,66507,66507},{51605,51605,51605,51605},{43935,43935,43935,43935},{226860,226860,226860,226860},{5408,5408,5408,5408},{207798,207798,207798,207798}},
{{207798,207798,207798,207798},{5408,5408,5408,5408},{226860,226860,226860,226860},{43935,43935,43935,43935},{51605,51605,51605,51605},{66507,66507,66507,66507}},
{{226860,226860,226860,226860},{66507,66507,66507,66507},{5408,5408,5408,5408},{51605,51605,51605,51605},{207798,207798,207798,207798},{43935,43935,43935,43935}},
{{51605,51605,51605,51605},{226860,226860,226860,226860},{207798,207798,207798,207798},{66507,66507,66507,66507},{43935,43935,43935,43935},{5408,5408,5408,5408}}};

static const __m256i w_8[7][7]={{{111890,111890,111890,111890},{217812,217812,217812,217812},{119473,119473,119473,119473},{301056,301056,301056,301056},{189167,189167,189167,189167},{83245,83245,83245,83245},{181584,181584,181584,181584}},
{{217812,217812,217812,217812},{301056,301056,301056,301056},{83245,83245,83245,83245},{1,1,1,1},{217812,217812,217812,217812},{301056,301056,301056,301056},{83245,83245,83245,83245}},
{{119473,119473,119473,119473},{83245,83245,83245,83245},{111890,111890,111890,111890},{301056,301056,301056,301056},{181584,181584,181584,181584},{217812,217812,217812,217812},{189167,189167,189167,189167}},
{{301056,301056,301056,301056},{1,1,1,1},{301056,301056,301056,301056},{1,1,1,1},{301056,301056,301056,301056},{1,1,1,1},{301056,301056,301056,301056}},
{{189167,189167,189167,189167},{217812,217812,217812,217812},{181584,181584,181584,181584},{301056,301056,301056,301056},{111890,111890,111890,111890},{83245,83245,83245,83245},{119473,119473,119473,119473}},
{{83245,83245,83245,83245},{301056,301056,301056,301056},{217812,217812,217812,217812},{1,1,1,1},{83245,83245,83245,83245},{301056,301056,301056,301056},{217812,217812,217812,217812}},
{{181584,181584,181584,181584},{83245,83245,83245,83245},{189167,189167,189167,189167},{301056,301056,301056,301056},{119473,119473,119473,119473},{217812,217812,217812,217812},{111890,111890,111890,111890}}};

/* omega_256,768,1792,2048, respectively (in Montgomery form) */
static const uint64_t omega_256[128]={290810,185338,235699,224580,151545,37936,10156,243082,24762,130239,155588,142471,222477,219961,55871,28512,12966,42008,252752,134200,222707,89937,145243,48121,90242,247698,75010,214416,88384,112163,109609,273294,189283,60546,68967,232638,237696,56397,165722,52429,293666,78682,120295,112040,53485,26540,258642,207708,273114,173236,29871,119068,198340,220705,182410,155302,26657,223914,1854,74967,165424,55968,293058,205113,117034,107326,24606,176543,129003,105610,232893,185165,24589,220186,151194,142120,25604,235409,48198,51948,235732,122152,232433,144156,146902,180968,297699,31797,80031,74977,15787,7496,5943,273920,34351,217403,158988,144524,300132,143329,268862,215650,108078,272281,204344,214059,101716,277117,274205,135023,40179,255278,148653,201594,119425,185008,55751,17814,293573,175761,29182,223225,106011,283695,228414,101972,239728,117127};
static const uint64_t omega_768[768]={290810,169570,233715,185338,214844,288552,235699,246963,14143,224580,84749,101779,151545,164424,26835,37936,267875,209677,10156,22289,283069,243082,15141,82289,24762,160645,246172,130239,247087,149707,155588,156015,205241,142471,285908,248868,222477,19276,28787,219961,152959,263275,55871,73677,214313,28512,200949,34043,12966,287716,69522,42008,300882,206852,252752,59663,257013,134200,246146,228064,222707,57072,221298,89937,150634,129906,145243,92196,231271,48121,30523,10458,90242,56771,300111,247698,108747,126404,75010,166341,190019,214416,92560,65949,88384,123185,294746,112163,219155,174964,109609,194756,3288,273294,142037,112491,189283,274103,259273,60546,95824,128486,68967,173325,104678,232638,173281,270228,237696,109147,126689,56397,202001,290691,165722,261079,189782,52429,78751,89979,293666,261922,179093,78682,199063,205807,120295,29262,88587,112040,230357,175419,53485,19292,269644,26540,94174,14414,258642,176756,291520,207708,42622,98106,273114,217173,105814,173236,289012,10234,29871,55152,219930,119068,280523,188583,198340,66053,299198,220705,63172,150380,182410,92335,159869,155302,27862,238118,26657,105547,124124,223914,182118,287814,1854,249693,279513,74967,177600,126540,165424,178076,141932,55968,160300,189478,293058,141066,2666,205113,21957,26934,117034,105966,203450,107326,204419,224676,24606,145481,99892,176543,39233,54296,129003,80625,264422,105610,37615,120881,232893,267543,254599,185165,113114,103173,24589,58915,60793,220186,59039,196357,151194,130305,299819,142120,251789,220795,25604,3190,39905,235409,133860,20111,48198,192396,152135,51948,232700,241063,235732,273329,160878,122152,117139,162489,232433,191951,170634,144156,117764,68854,146902,21877,26877,180968,98834,243527,297699,291138,139698,31797,33945,80634,80031,90891,173893,74977,139975,43284,15787,60170,5239,7496,95658,150947,5943,68209,14730,273920,195168,259480,34351,58344,252310,217403,143610,64690,158988,7909,197559,144524,238449,136026,300132,18157,174755,143329,68253,150237,268862,259302,101962,215650,266547,88308,108078,84532,165599,272281,190237,297362,204344,55278,46912,214059,81016,148041,101716,238054,267457,277117,58207,15130,274205,176555,295140,135023,9650,119772,40179,107655,20256,255278,189412,240326,148653,207522,140333,201594,166215,61980,119425,292067,106491,185008,252241,25430,55751,224120,9157,17814,110536,169074,293573,160249,230837,175761,271995,62084,29182,88530,175974,223225,215496,243858,106011,184666,33731,283695,296213,162130,228414,110060,153682,101972,178025,183291,239728,291229,248896,117127,207639,151706,10247,131487,67342,115719,86213,12505,65358,54094,286914,76477,216308,199278,149512,136633,274222,263121,33182,91380,290901,278768,17988,57975,285916,218768,276295,140412,54885,170818,53970,151350,145469,145042,95816,158586,15149,52189,78580,281781,272270,81096,148098,37782,245186,227380,86744,272545,100108,267014,288091,13341,231535,259049,175,94205,48305,241394,44044,166857,54911,72993,78350,243985,79759,211120,150423,171151,155814,208861,69786,252936,270534,290599,210815,244286,946,53359,192310,174653,226047,134716,111038,86641,208497,235108,212673,177872,6311,188894,81902,126093,191448,106301,297769,27763,159020,188566,111774,26954,41784,240511,205233,172571,232090,127732,196379,68419,127776,30829,63361,191910,174368,244660,99056,10366,135335,39978,111275,248628,222306,211078,7391,39135,121964,222375,101994,95250,180762,271795,212470,189017,70700,125638,247572,281765,31413,274517,206883,286643,42415,124301,9537,93349,258435,202951,27943,83884,195243,127821,12045,290823,271186,245905,81127,181989,20534,112474,102717,235004,1859,80352,237885,150677,118647,208722,141188,145755,273195,62939,274400,195510,176933,77143,118939,13243,299203,51364,21544,226090,123457,174517,135633,122981,159125,245089,140757,111579,7999,159991,298391,95944,279100,274123,184023,195091,97607,193731,96638,76381,276451,155576,201165,124514,261824,246761,172054,220432,36635,195447,263442,180176,68164,33514,46458,115892,187943,197884,276468,242142,240264,80871,242018,104700,149863,170752,1238,158937,49268,80262,275453,297867,261152,65648,167197,280946,252859,108661,148922,249109,68357,59994,65325,27728,140179,178905,183918,138568,68624,109106,130423,156901,183293,232203,154155,279180,274180,120089,202223,57530,3358,9919,161359,269260,267112,220423,221026,210166,127164,226080,161082,257773,285270,240887,295818,293561,205399,150110,295114,232848,286327,27137,105889,41577,266706,242713,48747,83654,157447,236367,142069,293148,103498,156533,62608,165031,925,282900,126302,157728,232804,150820,32195,41755,199095,85407,34510,212749,192979,216525,135458,28776,110820,3695,96713,245779,254145,86998,220041,153016,199341,63003,33600,23940,242850,285927,26852,124502,5917,166034,291407,181285,260878,193402,280801,45779,111645,60731,152404,93535,160724,99463,134842,239077,181632,8990,194566,116049,48816,275627,245306,76937,291900,283243,190521,131983,7484,140808,70220,125296,29062,238973,271875,212527,125083,77832,85561,57199,195046,116391,267326,17362,4844,138927,72643,190997,147375,199085,123032,117766,61329,9828,52161,183930,93418,149351};
static const uint64_t omega_1792[1792]={290810,263535,203118,49166,73355,197479,145773,185338,237492,14444,258668,142137,128894,245899,235699,279056,143666,300343,283018,261474,230739,224580,130957,253747,26664,213218,38701,83453,151545,189492,147640,28851,11688,153620,109097,37936,214654,216655,28135,259237,147658,47015,10156,79496,272938,24515,185488,188154,202382,243082,102546,217757,2849,98543,125477,9041,24762,200583,100230,88407,99614,2007,218944,130239,164770,54323,159372,59618,284294,10364,155588,87981,71142,238969,166870,266762,80991,142471,31077,50218,64515,275196,28435,160561,222477,15843,232031,257222,87895,51260,179387,219961,253334,78212,81115,234150,53974,141700,55871,216191,228923,231827,252068,205610,289218,28512,171361,282825,300871,13010,116183,163834,12966,239036,325,194158,106142,166935,64748,42008,175858,104238,118831,159898,55198,172624,252752,293728,231002,222370,75122,73884,95734,134200,114315,152058,105052,103978,23716,14773,222707,181037,279357,213253,207823,247728,7415,89937,138269,172844,240601,208102,228213,284726,145243,118820,115347,89585,217922,69000,184852,48121,55808,152617,234285,190204,130210,102055,90242,278794,13082,188839,157706,17527,292286,247698,77494,293195,261809,128,162617,256712,75010,195019,172168,294359,131834,1411,186177,214416,210642,115293,35093,222518,291372,295443,88384,143306,238120,12601,238669,265546,191943,112163,221653,154408,235261,37770,281297,297685,109609,86290,37274,215638,206097,44738,120866,273294,15800,222090,227431,264969,44546,27469,189283,204342,80090,270236,275016,147852,175881,60546,183775,65184,247825,71848,115132,39880,68967,51199,151282,191702,203475,208714,243675,232638,33483,270388,261147,1112,152059,273315,237696,19598,140953,205236,279769,294499,206208,56397,211771,117253,173158,89151,47574,139389,165722,78375,111797,53023,285911,237164,218668,52429,288613,287720,256304,64702,129392,45970,293666,34634,60393,29381,78206,275765,33956,78682,287791,160697,225913,138071,274097,257453,120295,232304,131300,165012,131274,4972,267290,112040,298237,265229,139661,172594,21774,195929,53485,49654,298195,122494,243588,44493,141240,26540,121539,15804,293028,160189,248497,248209,258642,283154,264910,51910,266646,131188,286147,207708,165131,284809,262450,78305,74610,25530,273114,135217,237410,65500,131844,178756,18072,173236,268214,241640,119242,72881,220922,286468,29871,37458,167159,123535,190197,156597,69200,119068,298705,135379,99829,51712,66842,148040,198340,211799,11705,3521,274904,268987,252315,220705,201294,215594,27893,182286,1001,140400,182410,92680,163297,273892,84036,104292,173323,155302,133883,62033,212489,206230,145499,142997,26657,239605,5846,112279,171456,10732,58630,223914,61003,9374,59739,172241,234221,259424,1854,64550,143261,192710,16431,122922,6472,74967,185078,142377,170376,125120,150550,155499,165424,212520,3357,75959,15339,24496,300118,55968,280624,254118,133438,148191,16208,232398,293058,90110,45239,124669,130301,60081,216300,205113,55296,104263,110608,191221,253305,15497,117034,52515,7438,46245,203213,78130,132171,107326,90593,30878,284265,248706,191507,207403,24606,143514,13155,128701,285296,17970,170659,176543,59562,194333,48581,85139,247269,146347,129003,222089,59168,131251,48664,202346,206754,105610,64948,277281,125385,183809,66043,278382,232893,190454,47980,114228,264970,212809,161187,185165,29465,62619,67911,290158,140807,24455,24589,293613,148405,198707,247635,13920,298557,220186,179327,59062,57736,24235,36740,78182,151194,136351,177514,270041,278944,264801,75720,142120,278993,80092,4648,241395,139616,127184,25604,80182,95468,233735,70053,43218,259556,235409,254020,201799,290335,118715,210095,198874,48198,66608,212965,218256,272240,290228,177994,51948,37386,94503,129663,185636,103347,122884,235732,111652,40505,164449,232160,287045,177268,122152,199529,73601,44311,225188,75481,268901,232433,161123,254385,202166,25114,120930,204074,144156,259595,174412,49996,41197,93386,39460,146902,187298,74500,182134,14870,287140,206232,180968,109376,18421,190908,271961,8686,201740,297699,56835,152000,280679,175816,262560,222758,31797,174664,3235,19749,259878,225835,260065,80031,277600,213136,89757,257686,188164,78670,74977,61366,275329,129196,182692,276897,239648,15787,142070,295439,17446,210548,254592,109995,7496,171675,131375,140343,225243,298236,96966,5943,176712,196651,213400,255810,34512,4183,273920,279545,235712,58019,75658,246809,117016,34351,8970,120369,39372,91551,161337,135827,217403,47033,28320,77964,198814,188356,172067,158988,173881,116272,86391,172645,173591,91236,144524,162637,9288,39857,112659,287312,245996,300132,3194,45277,196466,93616,204654,194228,143329,194428,77545,143955,157116,91167,275600,268862,293430,64090,113930,98058,104369,184123,215650,117854,144069,71450,282169,107205,202646,108078,180429,33776,198099,2054,299823,92788,272281,264700,241406,184167,92797,281363,263934,204344,115559,236615,266780,99155,140939,258010,214059,51094,246030,300991,33751,206322,271788,101716,249915,106942,204856,163913,59235,265763,277117,227497,231218,139281,56738,87567,255484,274205,65380,111103,88617,211175,84486,257335,135023,108544,15110,27565,85453,95819,286876,40179,103085,293357,124228,287397,97615,225996,255278,233582,216716,56240,287496,197517,217570,148653,81008,293429,196884,281269,102176,279246,201594,116918,102712,151114,222876,17069,298424,119425,157196,4642,134988,240479,151892,171695,185008,105190,142883,112323,48603,174241,178495,55751,195450,138784,123873,163318,194731,182601,17814,113590,89468,99856,78958,64544,36854,293573,41139,269013,111298,84689,94226,184647,175761,39805,93636,258287,159075,60969,8515,29182,11196,158899,251324,257650,151836,81734,223225,34741,1114,187528,239694,229460,271958,106011,101643,8996,280409,204413,285540,130390,283695,74922,139668,146207,54629,167103,33574,228414,86148,228488,194273,188739,190598,193292,101972,274092,18252,53819,252894,102514,252367,239728,230319,1458,267056,176965,17096,24613,117127,46010,99875,265385,196730,259669,282537,10247,37522,97939,251891,227702,103578,155284,115719,63565,286613,42389,158920,172163,55158,65358,22001,157391,714,18039,39583,70318,76477,170100,47310,274393,87839,262356,217604,149512,111565,153417,272206,289369,147437,191960,263121,86403,84402,272922,41820,153399,254042,290901,221561,28119,276542,115569,112903,98675,57975,198511,83300,298208,202514,175580,292016,276295,100474,200827,212650,201443,299050,82113,170818,136287,246734,141685,241439,16763,290693,145469,213076,229915,62088,134187,34295,220066,158586,269980,250839,236542,25861,272622,140496,78580,285214,69026,43835,213162,249797,121670,81096,47723,222845,219942,66907,247083,159357,245186,84866,72134,69230,48989,95447,11839,272545,129696,18232,186,288047,184874,137223,288091,62021,300732,106899,194915,134122,236309,259049,125199,196819,182226,141159,245859,128433,48305,7329,70055,78687,225935,227173,205323,166857,186742,148999,196005,197079,277341,286284,78350,120020,21700,87804,93234,53329,293642,211120,162788,128213,60456,92955,72844,16331,155814,182237,185710,211472,83135,232057,116205,252936,245249,148440,66772,110853,170847,199002,210815,22263,287975,112218,143351,283530,8771,53359,223563,7862,39248,300929,138440,44345,226047,106038,128889,6698,169223,299646,114880,86641,90415,185764,265964,78539,9685,5614,212673,157751,62937,288456,62388,35511,109114,188894,79404,146649,65796,263287,19760,3372,191448,214767,263783,85419,94960,256319,180191,27763,285257,78967,73626,36088,256511,273588,111774,96715,220967,30821,26041,153205,125176,240511,117282,235873,53232,229209,185925,261177,232090,249858,149775,109355,97582,92343,57382,68419,267574,30669,39910,299945,148998,27742,63361,281459,160104,95821,21288,6558,94849,244660,89286,183804,127899,211906,253483,161668,135335,222682,189260,248034,15146,63893,82389,248628,12444,13337,44753,236355,171665,255087,7391,266423,240664,271676,222851,25292,267101,222375,13266,140360,75144,162986,26960,43604,180762,68753,169757,136045,169783,296085,33767,189017,2820,35828,161396,128463,279283,105128,247572,251403,2862,178563,57469,256564,159817,274517,179518,285253,8029,140868,52560,52848,42415,17903,36147,249147,34411,169869,14910,93349,135926,16248,38607,222752,226447,275527,27943,165840,63647,235557,169213,122301,282985,127821,32843,59417,181815,228176,80135,14589,271186,263599,133898,177522,110860,144460,231857,181989,2352,165678,201228,249345,234215,153017,102717,89258,289352,297536,26153,32070,48742,80352,99763,85463,273164,118771,300056,160657,118647,208377,137760,27165,217021,196765,127734,145755,167174,239024,88568,94827,155558,158060,274400,61452,295211,188778,129601,290325,242427,77143,240054,291683,241318,128816,66836,41633,299203,236507,157796,108347,284626,178135,294585,226090,115979,158680,130681,175937,150507,145558,135633,88537,297700,225098,285718,276561,939,245089,20433,46939,167619,152866,284849,68659,7999,210947,255818,176388,170756,240976,84757,95944,245761,196794,190449,109836,47752,285560,184023,248542,293619,254812,97844,222927,168886,193731,210464,270179,16792,52351,109550,93654,276451,157543,287902,172356,15761,283087,130398,124514,241495,106724,252476,215918,53788,154710,172054,78968,241889,169806,252393,98711,94303,195447,236109,23776,175672,117248,235014,22675,68164,110603,253077,186829,36087,88248,139870,115892,271592,238438,233146,10899,160250,276602,276468,7444,152652,102350,53422,287137,2500,80871,121730,241995,243321,276822,264317,222875,149863,164706,123543,31016,22113,36256,225337,158937,22064,220965,296409,59662,161441,173873,275453,220875,205589,67322,231004,257839,41501,65648,47037,99258,10722,182342,90962,102183,252859,234449,88092,82801,28817,10829,123063,249109,263671,206554,171394,115421,197710,178173,65325,189405,260552,136608,68897,14012,123789,178905,101528,227456,256746,75869,225576,32156,68624,139934,46672,98891,275943,180127,96983,156901,41462,126645,251061,259860,207671,261597,154155,113759,226557,118923,286187,13917,94825,120089,191681,282636,110149,29096,292371,99317,3358,244222,149057,20378,125241,38497,78299,269260,126393,297822,281308,41179,75222,40992,221026,23457,87921,211300,43371,112893,222387,226080,239691,25728,171861,118365,24160,61409,285270,158987,5618,283611,90509,46465,191062,293561,129382,169682,160714,75814,2821,204091,295114,124345,104406,87657,45247,266545,296874,27137,21512,65345,243038,225399,54248,184041,266706,292087,180688,261685,209506,139720,165230,83654,254024,272737,223093,102243,112701,128990,142069,127176,184785,214666,128412,127466,209821,156533,138420,291769,261200,188398,13745,55061,925,297863,255780,104591,207441,96403,106829,157728,106629,223512,157102,143941,209890,25457,32195,7627,236967,187127,202999,196688,116934,85407,183203,156988,229607,18888,193852,98411,192979,120628,267281,102958,299003,1234,208269,28776,36357,59651,116890,208260,19694,37123,96713,185498,64442,34277,201902,160118,43047,86998,249963,55027,66,267306,94735,29269,199341,51142,194115,96201,137144,241822,35294,23940,73560,69839,161776,244319,213490,45573,26852,235677,189954,212440,89882,216571,43722,166034,192513,285947,273492,215604,205238,14181,260878,197972,7700,176829,13660,203442,75061,45779,67475,84341,244817,13561,103540,83487,152404,220049,7628,104173,19788,198881,21811,99463,184139,198345,149943,78181,283988,2633,181632,143861,296415,166069,60578,149165,129362,116049,195867,158174,188734,252454,126816,122562,245306,105607,162273,177184,137739,106326,118456,283243,187467,211589,201201,222099,236513,264203,7484,259918,32044,189759,216368,206831,116410,125296,261252,207421,42770,141982,240088,292542,271875,289861,142158,49733,43407,149221,219323,77832,266316,299943,113529,61363,71597,29099,195046,199414,292061,20648,96644,15517,170667,17362,226135,161389,154850,246428,133954,267483,72643,214909,72569,106784,112318,110459,107765,199085,26965,282805,247238,48163,198543,48690,61329,70738,299599,34001,124092,283961,276444,183930,255047,201182,35672,104327,41388,18520};
static const uint64_t omega_2048[2048]={290810,23364,151595,185571,76255,21862,191304,170626,185338,35713,192922,151101,99615,172761,255771,248775,235699,67874,68853,239199,74760,62789,87234,125866,224580,240567,11735,235548,41600,13032,160169,172162,151545,176871,67740,45537,95956,138209,264863,24441,37936,278667,17881,100724,64670,113471,175249,86569,10156,261859,103859,8046,195776,45583,103960,25620,243082,148288,212267,205504,232970,195142,236324,176624,24762,93790,62382,16416,146871,266766,54506,151277,130239,82311,172435,199047,12623,89003,132615,194678,155588,278239,244466,88047,267328,152294,6140,165189,142471,103280,208357,127278,169211,240185,246324,110282,222477,175702,165391,177619,197892,112710,42835,227922,219961,38975,158396,164717,60343,263744,130792,178533,55871,87730,212170,188626,5711,90543,99518,155883,28512,144176,98893,47133,72603,289585,111271,93506,12966,148685,281345,182796,195519,865,150510,297838,42008,84024,169440,280031,255217,152379,20930,29136,252752,24526,52726,142614,128162,21970,210096,128807,134200,169411,274985,280384,15582,1755,4313,148348,222707,215722,204560,68714,215013,81194,279134,99139,89937,295131,173104,14396,96448,223817,107805,92536,145243,284551,138526,18964,289166,38365,52256,60834,48121,244515,96573,245567,279621,183877,82556,215065,90242,47144,74517,20507,256591,90398,74288,281718,247698,48301,275835,127227,160337,201394,119944,97323,75010,106289,129809,7491,99206,101595,216224,291908,214416,278373,267782,231290,203879,251277,68933,253119,88384,24909,119368,298156,97340,77968,18867,272288,112163,248714,225085,27380,248265,146959,282078,9281,109609,105375,271830,32471,230928,140891,129417,240340,273294,287207,299613,49801,235778,81620,52201,51264,189283,120029,112113,240014,216570,51055,152917,114542,60546,299066,255680,232941,190096,261491,39827,5587,68967,259035,214597,8810,27655,296115,43263,1337,232638,137374,119573,32769,282780,131429,289371,74035,237696,114295,17568,46262,222106,111148,72104,202759,56397,179254,181325,240622,21305,94386,166086,298549,165722,235213,284367,106510,168263,75233,145091,258103,52429,90936,167900,12071,294012,279455,154993,174709,293666,219251,216492,37483,199845,151475,164691,55819,78682,143103,213248,75141,129083,182224,95991,144299,120295,158397,164891,90619,112742,48403,293583,204809,112040,227312,113821,236149,146174,145488,26124,29721,53485,274680,227314,114169,296701,145227,281767,256224,26540,102105,3907,77704,273988,106906,237167,22249,258642,146215,152622,63212,160836,288220,174818,11575,207708,14352,88792,95901,128639,104968,201012,53476,273114,255887,268959,135031,12948,145553,37434,191319,173236,37364,179139,161315,70509,226286,236354,181844,29871,79585,300225,156289,99156,92895,207709,14526,119068,245956,46250,220018,48893,77786,288256,181082,198340,190662,58918,15794,38643,100628,47966,217545,220705,168431,104465,113490,178555,59699,151688,201753,182410,128355,55552,32224,187950,189144,95843,118547,155302,228475,15126,223468,47079,63207,159966,136840,26657,122463,234572,172833,268299,20191,201607,157006,223914,124683,18738,249842,120300,159267,15214,238780,1854,21539,135102,25302,187750,154344,61783,213247,74967,98807,32169,178380,29249,272414,134087,149749,165424,183361,293829,247613,33511,110831,16946,239091,55968,104608,138372,293225,142517,111284,95768,105497,293058,113459,173161,24314,15838,46299,228544,27132,205113,164936,98449,270934,177624,198762,264090,190996,117034,193097,181551,279946,240427,288432,211706,107890,107326,9190,93775,59772,164390,3445,298373,135098,24606,66646,156238,90282,54104,81329,1567,272658,176543,10668,49890,251264,66671,160588,245068,192795,129003,168304,82367,182179,88161,287164,292131,253218,105610,11663,223020,270184,47124,71037,17101,266061,232893,181744,12471,62555,46518,266650,34322,251945,185165,5611,73143,82488,203233,138873,79342,257943,24589,63688,243660,248860,250489,232878,179134,160445,220186,78125,46185,208708,188352,259092,224515,229257,151194,115797,278916,61207,113023,97297,70486,222284,142120,42206,118476,142948,186278,199273,51947,7068,25604,240298,265986,219843,18443,198512,220590,148421,235409,17414,19466,75457,184067,115616,247422,277,48198,257913,19369,58579,257865,11017,110616,280593,51948,7242,55880,89296,183597,33836,167381,222822,235732,73616,164790,73045,65436,246755,185276,24925,122152,180458,89764,265029,53325,246840,200066,189929,232433,101704,235190,280365,12276,28625,163838,208454,144156,95413,43727,82073,131023,218727,125316,128880,146902,272160,89891,287127,285693,36177,273658,49486,180968,178504,50825,112897,75373,169451,281945,287196,297699,17822,90458,84728,291936,219288,222930,254524,31797,113652,206743,147499,74981,101243,154976,171751,80031,76772,111820,189032,76355,39262,208334,123276,74977,100547,33872,173645,108530,218686,118182,91792,15787,37425,189753,201809,192154,17469,29036,235352,7496,100076,252975,63328,181020,187552,119892,88275,5943,130911,199239,46031,181912,41703,30954,268027,273920,95074,285798,54447,141011,150297,260776,216474,34351,256991,159998,142408,92318,107311,6580,241749,217403,195997,84037,171702,71505,98533,285550,11295,158988,267725,221372,284489,127738,249251,17466,28514,144524,159445,46186,208882,218628,108090,142126,43250,300132,140107,294058,287459,42404,152928,116456,92525,143329,252572,294263,22072,227844,206389,85903,195329,268862,118153,86746,40954,201685,170578,176986,87750,215650,192032,297298,249105,293119,124073,213655,145959,108078,140038,282052,4757,225604,117686,5488,51741,272281,110945,36782,77871,1989,45029,7564,111908,204344,31130,298651,183470,11738,236070,132428,162140,214059,216255,297302,249801,113166,122179,185156,4045,101716,237278,41563,6594,244185,39153,189368,134819,277117,49238,137816,196481,168253,73493,143388,262838,274205,144664,183805,70028,142592,124334,259069,220513,135023,11556,204402,41222,248317,156007,50088,285716,40179,66835,189124,92363,115141,164772,69913,122582,255278,162993,61424,150781,43935,118265,106234,120239,148653,275777,117135,210671,228857,81594,47677,167259,201594,154744,131383,281367,186624,259477,291505,144294,119425,7017,16730,201507,139606,206884,172033,129099,185008,279350,136723,6299,192855,139443,178522,53957,55751,66850,191734,245446,258567,133165,290378,249253,17814,89066,143577,295724,276286,205701,267248,138374,293573,203069,110337,232047,34540,289877,162079,203445,175761,175657,157561,19427,68671,207531,284611,148966,29182,260756,212994,30945,266461,1436,249864,124128,223225,4797,232564,124498,287605,67808,57369,47325,106011,81437,20359,230839,125405,144366,131953,79490,283695,290639,294667,92368,116011,15095,218074,11694,228414,4512,182974,226491,272024,66227,83332,49032,101972,281822,265794,186435,226591,289424,83257,35982,239728,166806,122772,288338,195350,272516,151835,227331,117127,209279,287706,85382,104675,150030,214318,261321,10247,277693,149462,115486,224802,279195,109753,130431,115719,265344,108135,149956,201442,128296,45286,52282,65358,233183,232204,61858,226297,238268,213823,175191,76477,60490,289322,65509,259457,288025,140888,128895,149512,124186,233317,255520,205101,162848,36194,276616,263121,22390,283176,200333,236387,187586,125808,214488,290901,39198,197198,293011,105281,255474,197097,275437,57975,152769,88790,95553,68087,105915,64733,124433,276295,207267,238675,284641,154186,34291,246551,149780,170818,218746,128622,102010,288434,212054,168442,106379,145469,22818,56591,213010,33729,148763,294917,135868,158586,197777,92700,173779,131846,60872,54733,190775,78580,125355,135666,123438,103165,188347,258222,73135,81096,262082,142661,136340,240714,37313,170265,122524,245186,213327,88887,112431,295346,210514,201539,145174,272545,156881,202164,253924,228454,11472,189786,207551,288091,152372,19712,118261,105538,300192,150547,3219,259049,217033,131617,21026,45840,148678,280127,271921,48305,276531,248331,158443,172895,279087,90961,172250,166857,131646,26072,20673,285475,299302,296744,152709,78350,85335,96497,232343,86044,219863,21923,201918,211120,5926,127953,286661,204609,77240,193252,208521,155814,16506,162531,282093,11891,262692,248801,240223,252936,56542,204484,55490,21436,117180,218501,85992,210815,253913,226540,280550,44466,210659,226769,19339,53359,252756,25222,173830,140720,99663,181113,203734,226047,194768,171248,293566,201851,199462,84833,9149,86641,22684,33275,69767,97178,49780,232124,47938,212673,276148,181689,2901,203717,223089,282190,28769,188894,52343,75972,273677,52792,154098,18979,291776,191448,195682,29227,268586,70129,160166,171640,60717,27763,13850,1444,251256,65279,219437,248856,249793,111774,181028,188944,61043,84487,250002,148140,186515,240511,1991,45377,68116,110961,39566,261230,295470,232090,42022,86460,292247,273402,4942,257794,299720,68419,163683,181484,268288,18277,169628,11686,227022,63361,186762,283489,254795,78951,189909,228953,98298,244660,121803,119732,60435,279752,206671,134971,2508,135335,65844,16690,194547,132794,225824,155966,42954,248628,210121,133157,288986,7045,21602,146064,126348,7391,81806,84565,263574,101212,149582,136366,245238,222375,157954,87809,225916,171974,118833,205066,156758,180762,142660,136166,210438,188315,252654,7474,96248,189017,73745,187236,64908,154883,155569,274933,271336,247572,26377,73743,186888,4356,155830,19290,44833,274517,198952,297150,223353,27069,194151,63890,278808,42415,154842,148435,237845,140221,12837,126239,289482,93349,286705,212265,205156,172418,196089,100045,247581,27943,45170,32098,166026,288109,155504,263623,109738,127821,263693,121918,139742,230548,74771,64703,119213,271186,221472,832,144768,201901,208162,93348,286531,181989,55101,254807,81039,252164,223271,12801,119975,102717,110395,242139,285263,262414,200429,253091,83512,80352,132626,196592,187567,122502,241358,149369,99304,118647,172702,245505,268833,113107,111913,205214,182510,145755,72582,285931,77589,253978,237850,141091,164217,274400,178594,66485,128224,32758,280866,99450,144051,77143,176374,282319,51215,180757,141790,285843,62277,299203,279518,165955,275755,113307,146713,239274,87810,226090,202250,268888,122677,271808,28643,166970,151308,135633,117696,7228,53444,267546,190226,284111,61966,245089,196449,162685,7832,158540,189773,205289,195560,7999,187598,127896,276743,285219,254758,72513,273925,95944,136121,202608,30123,123433,102295,36967,110061,184023,107960,119506,21111,60630,12625,89351,193167,193731,291867,207282,241285,136667,297612,2684,165959,276451,234411,144819,210775,246953,219728,299490,28399,124514,290389,251167,49793,234386,140469,55989,108262,172054,132753,218690,118878,212896,13893,8926,47839,195447,289394,78037,30873,253933,230020,283956,34996,68164,119313,288586,238502,254539,34407,266735,49112,115892,295446,227914,218569,97824,162184,221715,43114,276468,237369,57397,52197,50568,68179,121923,140612,80871,222932,254872,92349,112705,41965,76542,71800,149863,185260,22141,239850,188034,203760,230571,78773,158937,258851,182581,158109,114779,101784,249110,293989,275453,60759,35071,81214,282614,102545,80467,152636,65648,283643,281591,225600,116990,185441,53635,300780,252859,43144,281688,242478,43192,290040,190441,20464,249109,293815,245177,211761,117460,267221,133676,78235,65325,227441,136267,228012,235621,54302,115781,276132,178905,120599,211293,36028,247732,54217,100991,111128,68624,199353,65867,20692,288781,272432,137219,92603,156901,205644,257330,218984,170034,82330,175741,172177,154155,28897,211166,13930,15364,264880,27399,251571,120089,122553,250232,188160,225684,131606,19112,13861,3358,283235,210599,216329,9121,81769,78127,46533,269260,187405,94314,153558,226076,199814,146081,129306,221026,224285,189237,112025,224702,261795,92723,177781,226080,200510,267185,127412,192527,82371,182875,209265,285270,263632,111304,99248,108903,283588,272021,65705,293561,200981,48082,237729,120037,113505,181165,212782,295114,170146,101818,255026,119145,259354,270103,33030,27137,205983,15259,246610,160046,150760,40281,84583,266706,44066,141059,158649,208739,193746,294477,59308,83654,105060,217020,129355,229552,202524,15507,289762,142069,33332,79685,16568,173319,51806,283591,272543,156533,141612,254871,92175,82429,192967,158931,257807,925,160950,6999,13598,258653,148129,184601,208532,157728,48485,6794,278985,73213,94668,215154,105728,32195,182904,214311,260103,99372,130479,124071,213307,85407,109025,3759,51952,7938,176984,87402,155098,192979,161019,19005,296300,75453,183371,295569,249316,28776,190112,264275,223186,299068,256028,293493,189149,96713,269927,2406,117587,289319,64987,168629,138917,86998,84802,3755,51256,187891,178878,115901,297012,199341,63779,259494,294463,56872,261904,111689,166238,23940,251819,163241,104576,132804,227564,157669,38219,26852,156393,117252,231029,158465,176723,41988,80544,166034,289501,96655,259835,52740,145050,250969,15341,260878,234222,111933,208694,185916,136285,231144,178475,45779,138064,239633,150276,257122,182792,194823,180818,152404,25280,183922,90386,72200,219463,253380,133798,99463,146313,169674,19690,114433,41580,9552,156763,181632,294040,284327,99550,161451,94173,129024,171958,116049,21707,164334,294758,108202,161614,122535,247100,245306,234207,109323,55611,42490,167892,10679,51804,283243,211991,157480,5333,24771,95356,33809,162683,7484,97988,190720,69010,266517,11180,138978,97612,125296,125400,143496,281630,232386,93526,16446,152091,271875,40301,88063,270112,34596,299621,51193,176929,77832,296260,68493,176559,13452,233249,243688,253732,195046,219620,280698,70218,175652,156691,169104,221567,17362,10418,6390,208689,185046,285962,82983,289363,72643,296545,118083,74566,29033,234830,217725,252025,199085,19235,35263,114622,74466,11633,217800,265075,61329,134251,178285,12719,105707,28541,149222,73726,183930,91778,13351,215675,196382,151027,86739,39736};

/* multiplication inverses of omega */
static const __m256i w_3_inv[2]={{289960,289960,289960,289960},{11096,11096,11096,11096}};

static const __m256i w_7_inv[6][6]={{{51605,51605,51605,51605},{226860,226860,226860,226860},{207798,207798,207798,207798},{66507,66507,66507,66507},{43935,43935,43935,43935},{5408,5408,5408,5408}},
{{226860,226860,226860,226860},{66507,66507,66507,66507},{5408,5408,5408,5408},{51605,51605,51605,51605},{207798,207798,207798,207798},{43935,43935,43935,43935}},
{{207798,207798,207798,207798},{5408,5408,5408,5408},{226860,226860,226860,226860},{43935,43935,43935,43935},{51605,51605,51605,51605},{66507,66507,66507,66507}},
{{66507,66507,66507,66507},{51605,51605,51605,51605},{43935,43935,43935,43935},{226860,226860,226860,226860},{5408,5408,5408,5408},{207798,207798,207798,207798}},
{{43935,43935,43935,43935},{207798,207798,207798,207798},{51605,51605,51605,51605},{5408,5408,5408,5408},{66507,66507,66507,66507},{226860,226860,226860,226860}},
{{5408,5408,5408,5408},{43935,43935,43935,43935},{66507,66507,66507,66507},{207798,207798,207798,207798},{226860,226860,226860,226860},{51605,51605,51605,51605}}};

/* (in Montgomery form) */
static const uint64_t omega_256_inv[128]={290810,183930,61329,199085,72643,17362,195046,77832,271875,125296,7484,283243,245306,116049,181632,99463,152404,45779,260878,166034,26852,23940,199341,86998,96713,28776,192979,85407,32195,157728,925,156533,142069,83654,266706,27137,295114,293561,285270,226080,221026,269260,3358,120089,154155,156901,68624,178905,65325,249109,252859,65648,275453,158937,149863,80871,276468,115892,68164,195447,172054,124514,276451,193731,184023,95944,7999,245089,135633,226090,299203,77143,274400,145755,118647,80352,102717,181989,271186,127821,27943,93349,42415,274517,247572,189017,180762,222375,7391,248628,135335,244660,63361,68419,232090,240511,111774,27763,191448,188894,212673,86641,226047,53359,210815,252936,155814,211120,78350,166857,48305,259049,288091,272545,245186,81096,78580,158586,145469,170818,276295,57975,290901,263121,149512,76477,65358,115719};
static const uint64_t omega_768_inv[768]={290810,149351,93418,183930,52161,9828,61329,117766,123032,199085,147375,190997,72643,138927,4844,17362,267326,116391,195046,57199,85561,77832,125083,212527,271875,238973,29062,125296,70220,140808,7484,131983,190521,283243,291900,76937,245306,275627,48816,116049,194566,8990,181632,239077,134842,99463,160724,93535,152404,60731,111645,45779,280801,193402,260878,181285,291407,166034,5917,124502,26852,285927,242850,23940,33600,63003,199341,153016,220041,86998,254145,245779,96713,3695,110820,28776,135458,216525,192979,212749,34510,85407,199095,41755,32195,150820,232804,157728,126302,282900,925,165031,62608,156533,103498,293148,142069,236367,157447,83654,48747,242713,266706,41577,105889,27137,286327,232848,295114,150110,205399,293561,295818,240887,285270,257773,161082,226080,127164,210166,221026,220423,267112,269260,161359,9919,3358,57530,202223,120089,274180,279180,154155,232203,183293,156901,130423,109106,68624,138568,183918,178905,140179,27728,65325,59994,68357,249109,148922,108661,252859,280946,167197,65648,261152,297867,275453,80262,49268,158937,1238,170752,149863,104700,242018,80871,240264,242142,276468,197884,187943,115892,46458,33514,68164,180176,263442,195447,36635,220432,172054,246761,261824,124514,201165,155576,276451,76381,96638,193731,97607,195091,184023,274123,279100,95944,298391,159991,7999,111579,140757,245089,159125,122981,135633,174517,123457,226090,21544,51364,299203,13243,118939,77143,176933,195510,274400,62939,273195,145755,141188,208722,118647,150677,237885,80352,1859,235004,102717,112474,20534,181989,81127,245905,271186,290823,12045,127821,195243,83884,27943,202951,258435,93349,9537,124301,42415,286643,206883,274517,31413,281765,247572,125638,70700,189017,212470,271795,180762,95250,101994,222375,121964,39135,7391,211078,222306,248628,111275,39978,135335,10366,99056,244660,174368,191910,63361,30829,127776,68419,196379,127732,232090,172571,205233,240511,41784,26954,111774,188566,159020,27763,297769,106301,191448,126093,81902,188894,6311,177872,212673,235108,208497,86641,111038,134716,226047,174653,192310,53359,946,244286,210815,290599,270534,252936,69786,208861,155814,171151,150423,211120,79759,243985,78350,72993,54911,166857,44044,241394,48305,94205,175,259049,231535,13341,288091,267014,100108,272545,86744,227380,245186,37782,148098,81096,272270,281781,78580,52189,15149,158586,95816,145042,145469,151350,53970,170818,54885,140412,276295,218768,285916,57975,17988,278768,290901,91380,33182,263121,274222,136633,149512,199278,216308,76477,286914,54094,65358,12505,86213,115719,67342,131487,10247,151706,207639,117127,248896,291229,239728,183291,178025,101972,153682,110060,228414,162130,296213,283695,33731,184666,106011,243858,215496,223225,175974,88530,29182,62084,271995,175761,230837,160249,293573,169074,110536,17814,9157,224120,55751,25430,252241,185008,106491,292067,119425,61980,166215,201594,140333,207522,148653,240326,189412,255278,20256,107655,40179,119772,9650,135023,295140,176555,274205,15130,58207,277117,267457,238054,101716,148041,81016,214059,46912,55278,204344,297362,190237,272281,165599,84532,108078,88308,266547,215650,101962,259302,268862,150237,68253,143329,174755,18157,300132,136026,238449,144524,197559,7909,158988,64690,143610,217403,252310,58344,34351,259480,195168,273920,14730,68209,5943,150947,95658,7496,5239,60170,15787,43284,139975,74977,173893,90891,80031,80634,33945,31797,139698,291138,297699,243527,98834,180968,26877,21877,146902,68854,117764,144156,170634,191951,232433,162489,117139,122152,160878,273329,235732,241063,232700,51948,152135,192396,48198,20111,133860,235409,39905,3190,25604,220795,251789,142120,299819,130305,151194,196357,59039,220186,60793,58915,24589,103173,113114,185165,254599,267543,232893,120881,37615,105610,264422,80625,129003,54296,39233,176543,99892,145481,24606,224676,204419,107326,203450,105966,117034,26934,21957,205113,2666,141066,293058,189478,160300,55968,141932,178076,165424,126540,177600,74967,279513,249693,1854,287814,182118,223914,124124,105547,26657,238118,27862,155302,159869,92335,182410,150380,63172,220705,299198,66053,198340,188583,280523,119068,219930,55152,29871,10234,289012,173236,105814,217173,273114,98106,42622,207708,291520,176756,258642,14414,94174,26540,269644,19292,53485,175419,230357,112040,88587,29262,120295,205807,199063,78682,179093,261922,293666,89979,78751,52429,189782,261079,165722,290691,202001,56397,126689,109147,237696,270228,173281,232638,104678,173325,68967,128486,95824,60546,259273,274103,189283,112491,142037,273294,3288,194756,109609,174964,219155,112163,294746,123185,88384,65949,92560,214416,190019,166341,75010,126404,108747,247698,300111,56771,90242,10458,30523,48121,231271,92196,145243,129906,150634,89937,221298,57072,222707,228064,246146,134200,257013,59663,252752,206852,300882,42008,69522,287716,12966,34043,200949,28512,214313,73677,55871,263275,152959,219961,28787,19276,222477,248868,285908,142471,205241,156015,155588,149707,247087,130239,246172,160645,24762,82289,15141,243082,283069,22289,10156,209677,267875,37936,26835,164424,151545,101779,84749,224580,14143,246963,235699,288552,214844,185338,233715,169570};
static const uint64_t omega_1792_inv[1792]={290810,18520,41388,104327,35672,201182,255047,183930,276444,283961,124092,34001,299599,70738,61329,48690,198543,48163,247238,282805,26965,199085,107765,110459,112318,106784,72569,214909,72643,267483,133954,246428,154850,161389,226135,17362,170667,15517,96644,20648,292061,199414,195046,29099,71597,61363,113529,299943,266316,77832,219323,149221,43407,49733,142158,289861,271875,292542,240088,141982,42770,207421,261252,125296,116410,206831,216368,189759,32044,259918,7484,264203,236513,222099,201201,211589,187467,283243,118456,106326,137739,177184,162273,105607,245306,122562,126816,252454,188734,158174,195867,116049,129362,149165,60578,166069,296415,143861,181632,2633,283988,78181,149943,198345,184139,99463,21811,198881,19788,104173,7628,220049,152404,83487,103540,13561,244817,84341,67475,45779,75061,203442,13660,176829,7700,197972,260878,14181,205238,215604,273492,285947,192513,166034,43722,216571,89882,212440,189954,235677,26852,45573,213490,244319,161776,69839,73560,23940,35294,241822,137144,96201,194115,51142,199341,29269,94735,267306,66,55027,249963,86998,43047,160118,201902,34277,64442,185498,96713,37123,19694,208260,116890,59651,36357,28776,208269,1234,299003,102958,267281,120628,192979,98411,193852,18888,229607,156988,183203,85407,116934,196688,202999,187127,236967,7627,32195,25457,209890,143941,157102,223512,106629,157728,106829,96403,207441,104591,255780,297863,925,55061,13745,188398,261200,291769,138420,156533,209821,127466,128412,214666,184785,127176,142069,128990,112701,102243,223093,272737,254024,83654,165230,139720,209506,261685,180688,292087,266706,184041,54248,225399,243038,65345,21512,27137,296874,266545,45247,87657,104406,124345,295114,204091,2821,75814,160714,169682,129382,293561,191062,46465,90509,283611,5618,158987,285270,61409,24160,118365,171861,25728,239691,226080,222387,112893,43371,211300,87921,23457,221026,40992,75222,41179,281308,297822,126393,269260,78299,38497,125241,20378,149057,244222,3358,99317,292371,29096,110149,282636,191681,120089,94825,13917,286187,118923,226557,113759,154155,261597,207671,259860,251061,126645,41462,156901,96983,180127,275943,98891,46672,139934,68624,32156,225576,75869,256746,227456,101528,178905,123789,14012,68897,136608,260552,189405,65325,178173,197710,115421,171394,206554,263671,249109,123063,10829,28817,82801,88092,234449,252859,102183,90962,182342,10722,99258,47037,65648,41501,257839,231004,67322,205589,220875,275453,173873,161441,59662,296409,220965,22064,158937,225337,36256,22113,31016,123543,164706,149863,222875,264317,276822,243321,241995,121730,80871,2500,287137,53422,102350,152652,7444,276468,276602,160250,10899,233146,238438,271592,115892,139870,88248,36087,186829,253077,110603,68164,22675,235014,117248,175672,23776,236109,195447,94303,98711,252393,169806,241889,78968,172054,154710,53788,215918,252476,106724,241495,124514,130398,283087,15761,172356,287902,157543,276451,93654,109550,52351,16792,270179,210464,193731,168886,222927,97844,254812,293619,248542,184023,285560,47752,109836,190449,196794,245761,95944,84757,240976,170756,176388,255818,210947,7999,68659,284849,152866,167619,46939,20433,245089,939,276561,285718,225098,297700,88537,135633,145558,150507,175937,130681,158680,115979,226090,294585,178135,284626,108347,157796,236507,299203,41633,66836,128816,241318,291683,240054,77143,242427,290325,129601,188778,295211,61452,274400,158060,155558,94827,88568,239024,167174,145755,127734,196765,217021,27165,137760,208377,118647,160657,300056,118771,273164,85463,99763,80352,48742,32070,26153,297536,289352,89258,102717,153017,234215,249345,201228,165678,2352,181989,231857,144460,110860,177522,133898,263599,271186,14589,80135,228176,181815,59417,32843,127821,282985,122301,169213,235557,63647,165840,27943,275527,226447,222752,38607,16248,135926,93349,14910,169869,34411,249147,36147,17903,42415,52848,52560,140868,8029,285253,179518,274517,159817,256564,57469,178563,2862,251403,247572,105128,279283,128463,161396,35828,2820,189017,33767,296085,169783,136045,169757,68753,180762,43604,26960,162986,75144,140360,13266,222375,267101,25292,222851,271676,240664,266423,7391,255087,171665,236355,44753,13337,12444,248628,82389,63893,15146,248034,189260,222682,135335,161668,253483,211906,127899,183804,89286,244660,94849,6558,21288,95821,160104,281459,63361,27742,148998,299945,39910,30669,267574,68419,57382,92343,97582,109355,149775,249858,232090,261177,185925,229209,53232,235873,117282,240511,125176,153205,26041,30821,220967,96715,111774,273588,256511,36088,73626,78967,285257,27763,180191,256319,94960,85419,263783,214767,191448,3372,19760,263287,65796,146649,79404,188894,109114,35511,62388,288456,62937,157751,212673,5614,9685,78539,265964,185764,90415,86641,114880,299646,169223,6698,128889,106038,226047,44345,138440,300929,39248,7862,223563,53359,8771,283530,143351,112218,287975,22263,210815,199002,170847,110853,66772,148440,245249,252936,116205,232057,83135,211472,185710,182237,155814,16331,72844,92955,60456,128213,162788,211120,293642,53329,93234,87804,21700,120020,78350,286284,277341,197079,196005,148999,186742,166857,205323,227173,225935,78687,70055,7329,48305,128433,245859,141159,182226,196819,125199,259049,236309,134122,194915,106899,300732,62021,288091,137223,184874,288047,186,18232,129696,272545,11839,95447,48989,69230,72134,84866,245186,159357,247083,66907,219942,222845,47723,81096,121670,249797,213162,43835,69026,285214,78580,140496,272622,25861,236542,250839,269980,158586,220066,34295,134187,62088,229915,213076,145469,290693,16763,241439,141685,246734,136287,170818,82113,299050,201443,212650,200827,100474,276295,292016,175580,202514,298208,83300,198511,57975,98675,112903,115569,276542,28119,221561,290901,254042,153399,41820,272922,84402,86403,263121,191960,147437,289369,272206,153417,111565,149512,217604,262356,87839,274393,47310,170100,76477,70318,39583,18039,714,157391,22001,65358,55158,172163,158920,42389,286613,63565,115719,155284,103578,227702,251891,97939,37522,10247,282537,259669,196730,265385,99875,46010,117127,24613,17096,176965,267056,1458,230319,239728,252367,102514,252894,53819,18252,274092,101972,193292,190598,188739,194273,228488,86148,228414,33574,167103,54629,146207,139668,74922,283695,130390,285540,204413,280409,8996,101643,106011,271958,229460,239694,187528,1114,34741,223225,81734,151836,257650,251324,158899,11196,29182,8515,60969,159075,258287,93636,39805,175761,184647,94226,84689,111298,269013,41139,293573,36854,64544,78958,99856,89468,113590,17814,182601,194731,163318,123873,138784,195450,55751,178495,174241,48603,112323,142883,105190,185008,171695,151892,240479,134988,4642,157196,119425,298424,17069,222876,151114,102712,116918,201594,279246,102176,281269,196884,293429,81008,148653,217570,197517,287496,56240,216716,233582,255278,225996,97615,287397,124228,293357,103085,40179,286876,95819,85453,27565,15110,108544,135023,257335,84486,211175,88617,111103,65380,274205,255484,87567,56738,139281,231218,227497,277117,265763,59235,163913,204856,106942,249915,101716,271788,206322,33751,300991,246030,51094,214059,258010,140939,99155,266780,236615,115559,204344,263934,281363,92797,184167,241406,264700,272281,92788,299823,2054,198099,33776,180429,108078,202646,107205,282169,71450,144069,117854,215650,184123,104369,98058,113930,64090,293430,268862,275600,91167,157116,143955,77545,194428,143329,194228,204654,93616,196466,45277,3194,300132,245996,287312,112659,39857,9288,162637,144524,91236,173591,172645,86391,116272,173881,158988,172067,188356,198814,77964,28320,47033,217403,135827,161337,91551,39372,120369,8970,34351,117016,246809,75658,58019,235712,279545,273920,4183,34512,255810,213400,196651,176712,5943,96966,298236,225243,140343,131375,171675,7496,109995,254592,210548,17446,295439,142070,15787,239648,276897,182692,129196,275329,61366,74977,78670,188164,257686,89757,213136,277600,80031,260065,225835,259878,19749,3235,174664,31797,222758,262560,175816,280679,152000,56835,297699,201740,8686,271961,190908,18421,109376,180968,206232,287140,14870,182134,74500,187298,146902,39460,93386,41197,49996,174412,259595,144156,204074,120930,25114,202166,254385,161123,232433,268901,75481,225188,44311,73601,199529,122152,177268,287045,232160,164449,40505,111652,235732,122884,103347,185636,129663,94503,37386,51948,177994,290228,272240,218256,212965,66608,48198,198874,210095,118715,290335,201799,254020,235409,259556,43218,70053,233735,95468,80182,25604,127184,139616,241395,4648,80092,278993,142120,75720,264801,278944,270041,177514,136351,151194,78182,36740,24235,57736,59062,179327,220186,298557,13920,247635,198707,148405,293613,24589,24455,140807,290158,67911,62619,29465,185165,161187,212809,264970,114228,47980,190454,232893,278382,66043,183809,125385,277281,64948,105610,206754,202346,48664,131251,59168,222089,129003,146347,247269,85139,48581,194333,59562,176543,170659,17970,285296,128701,13155,143514,24606,207403,191507,248706,284265,30878,90593,107326,132171,78130,203213,46245,7438,52515,117034,15497,253305,191221,110608,104263,55296,205113,216300,60081,130301,124669,45239,90110,293058,232398,16208,148191,133438,254118,280624,55968,300118,24496,15339,75959,3357,212520,165424,155499,150550,125120,170376,142377,185078,74967,6472,122922,16431,192710,143261,64550,1854,259424,234221,172241,59739,9374,61003,223914,58630,10732,171456,112279,5846,239605,26657,142997,145499,206230,212489,62033,133883,155302,173323,104292,84036,273892,163297,92680,182410,140400,1001,182286,27893,215594,201294,220705,252315,268987,274904,3521,11705,211799,198340,148040,66842,51712,99829,135379,298705,119068,69200,156597,190197,123535,167159,37458,29871,286468,220922,72881,119242,241640,268214,173236,18072,178756,131844,65500,237410,135217,273114,25530,74610,78305,262450,284809,165131,207708,286147,131188,266646,51910,264910,283154,258642,248209,248497,160189,293028,15804,121539,26540,141240,44493,243588,122494,298195,49654,53485,195929,21774,172594,139661,265229,298237,112040,267290,4972,131274,165012,131300,232304,120295,257453,274097,138071,225913,160697,287791,78682,33956,275765,78206,29381,60393,34634,293666,45970,129392,64702,256304,287720,288613,52429,218668,237164,285911,53023,111797,78375,165722,139389,47574,89151,173158,117253,211771,56397,206208,294499,279769,205236,140953,19598,237696,273315,152059,1112,261147,270388,33483,232638,243675,208714,203475,191702,151282,51199,68967,39880,115132,71848,247825,65184,183775,60546,175881,147852,275016,270236,80090,204342,189283,27469,44546,264969,227431,222090,15800,273294,120866,44738,206097,215638,37274,86290,109609,297685,281297,37770,235261,154408,221653,112163,191943,265546,238669,12601,238120,143306,88384,295443,291372,222518,35093,115293,210642,214416,186177,1411,131834,294359,172168,195019,75010,256712,162617,128,261809,293195,77494,247698,292286,17527,157706,188839,13082,278794,90242,102055,130210,190204,234285,152617,55808,48121,184852,69000,217922,89585,115347,118820,145243,284726,228213,208102,240601,172844,138269,89937,7415,247728,207823,213253,279357,181037,222707,14773,23716,103978,105052,152058,114315,134200,95734,73884,75122,222370,231002,293728,252752,172624,55198,159898,118831,104238,175858,42008,64748,166935,106142,194158,325,239036,12966,163834,116183,13010,300871,282825,171361,28512,289218,205610,252068,231827,228923,216191,55871,141700,53974,234150,81115,78212,253334,219961,179387,51260,87895,257222,232031,15843,222477,160561,28435,275196,64515,50218,31077,142471,80991,266762,166870,238969,71142,87981,155588,10364,284294,59618,159372,54323,164770,130239,218944,2007,99614,88407,100230,200583,24762,9041,125477,98543,2849,217757,102546,243082,202382,188154,185488,24515,272938,79496,10156,47015,147658,259237,28135,216655,214654,37936,109097,153620,11688,28851,147640,189492,151545,83453,38701,213218,26664,253747,130957,224580,230739,261474,283018,300343,143666,279056,235699,245899,128894,142137,258668,14444,237492,185338,145773,197479,73355,49166,203118,263535};

static const __m256i V_B4Q_B4Q_B4Q_B4Q = {BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q};
static const __m256i V_B8Q_B8Q_B8Q_B8Q = {BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q};
static const __m256i V_B16Q_B16Q_B16Q_B16Q = {BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q};
static const __m256i V_Q_Q_Q_Q = {Q, Q, Q, Q};
static const __m256i V_Q2_Q2_Q2_Q2 = {Q2, Q2, Q2, Q2};
static const __m256i V_MM_MM_MM_MM = {MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK};
static const __m256i V_MF_MF_MF_MF = {MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint64_t *a)
{
uint64_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint64_t *a, uint32_t n, const uint64_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	__m256i u, v, t, t1, o, u1, v1, r1, r2;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			j_omega = 0;

			for (j = j1; j < j2; j += 4)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = _mm256_loadu_si256((__m256i *)(a + j));
				v = _mm256_loadu_si256((__m256i *)(a + j + d));
				
				t = _mm256_add_epi64(u, v);
				t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
				t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				r1 = _mm256_sub_epi64(t, t1);
				
				t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
				t = _mm256_sub_epi64(t, v);
				o = _mm256_set_epi64x(omega[j_omega + num_of_problems * 3], omega[j_omega + num_of_problems * 2], omega[j_omega + num_of_problems], omega[j_omega]);
				t = _mm256_mul_epu32(t, o);
				t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
				t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				t1 = _mm256_add_epi64(t, t1);
				r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);

				_mm256_storeu_si256((__m256i *)(a + j), r1);
				_mm256_storeu_si256((__m256i *)(a + j + d), r2);

				j_omega += num_of_problems * 4;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k += 2)
	{
		j = k << 2;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);
		
		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		o = _mm256_set_epi64x(omega[num_of_problems], omega[0], omega[num_of_problems], omega[0]);
		t = _mm256_mul_epu32(t, o);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
		
		u = _mm256_permute2f128_si256(r1, r2, 0x20);
		v = _mm256_permute2f128_si256(r1, r2, 0x31);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
	
	for (k = 0; k < (n >> 1); k += 4)
	{
		j = k << 1;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u1 = _mm256_permute4x64_epi64(u1, 0xD8);
		v1 = _mm256_permute4x64_epi64(v1, 0xD8);
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);

		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r2 = _mm256_sub_epi64(t, t1);

		u1 = _mm256_permute2f128_si256(r1, r2, 0x20);
		v1 = _mm256_permute2f128_si256(r1, r2, 0x31);
		u = _mm256_permute4x64_epi64(u1, 0xD8);
		v = _mm256_permute4x64_epi64(v1, 0xD8);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint64_t *a, uint32_t N1, uint32_t N2, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t))
{
	uint32_t n1, n2;
	__m256i u, v, t, t1;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint64_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t), uint64_t inv_n)
{
	uint32_t i, n1, n2;
	__m256i u, v, t, t1;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i += 4)
	{
		u = _mm256_loadu_si256((__m256i *)(a + i));
		v = _mm256_set1_epi64x(inv_n);
		
		t = _mm256_mul_epu32(u, v);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
		_mm256_storeu_si256((__m256i *)(a + i), u);
	}
}

/* 5*256-->8*256 */
static void ntt_butterfly_1280_2048(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, c1, d1, e1, f1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_8[0][0]);
	d1 = _mm256_mul_epu32(d, w_8[0][1]);
	e1 = _mm256_mul_epu32(e, w_8[0][2]);
	f1 = _mm256_mul_epu32(f, w_8[0][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 + n2), t);
	a[N2_2048 + n2] %= Q;
	a[N2_2048 + n2 + 1] %= Q;
	a[N2_2048 + n2 + 2] %= Q;
	a[N2_2048 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_8[1][0]);
	d1 = _mm256_mul_epu32(d, w_8[1][1]);
	e1 = _mm256_mul_epu32(e, w_8[1][2]);
	f1 = _mm256_mul_epu32(f, w_8[1][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 2 + n2), t);
	a[N2_2048 * 2 + n2] %= Q;
	a[N2_2048 * 2 + n2 + 1] %= Q;
	a[N2_2048 * 2 + n2 + 2] %= Q;
	a[N2_2048 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[2][0]);
	d1 = _mm256_mul_epu32(d, w_8[2][1]);
	e1 = _mm256_mul_epu32(e, w_8[2][2]);
	f1 = _mm256_mul_epu32(f, w_8[2][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 3 + n2), t);
	a[N2_2048 * 3 + n2] %= Q;
	a[N2_2048 * 3 + n2 + 1] %= Q;
	a[N2_2048 * 3 + n2 + 2] %= Q;
	a[N2_2048 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[3][0]);
	d1 = _mm256_mul_epu32(d, w_8[3][1]);
	e1 = _mm256_mul_epu32(e, w_8[3][2]);
	f1 = _mm256_mul_epu32(f, w_8[3][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 4 + n2), t);
	a[N2_2048 * 4 + n2] %= Q;
	a[N2_2048 * 4 + n2 + 1] %= Q;
	a[N2_2048 * 4 + n2 + 2] %= Q;
	a[N2_2048 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[4][0]);
	d1 = _mm256_mul_epu32(d, w_8[4][1]);
	e1 = _mm256_mul_epu32(e, w_8[4][2]);
	f1 = _mm256_mul_epu32(f, w_8[4][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 5 + n2), t);
	a[N2_2048 * 5 + n2] %= Q;
	a[N2_2048 * 5 + n2 + 1] %= Q;
	a[N2_2048 * 5 + n2 + 2] %= Q;
	a[N2_2048 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[5][0]);
	d1 = _mm256_mul_epu32(d, w_8[5][1]);
	e1 = _mm256_mul_epu32(e, w_8[5][2]);
	f1 = _mm256_mul_epu32(f, w_8[5][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 6 + n2), t);
	a[N2_2048 * 6 + n2] %= Q;
	a[N2_2048 * 6 + n2 + 1] %= Q;
	a[N2_2048 * 6 + n2 + 2] %= Q;
	a[N2_2048 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[6][0]);
	d1 = _mm256_mul_epu32(d, w_8[6][1]);
	e1 = _mm256_mul_epu32(e, w_8[6][2]);
	f1 = _mm256_mul_epu32(f, w_8[6][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 7 + n2), t);
	a[N2_2048 * 7 + n2] %= Q;
	a[N2_2048 * 7 + n2 + 1] %= Q;
	a[N2_2048 * 7 + n2 + 2] %= Q;
	a[N2_2048 * 7 + n2 + 3] %= Q;
}

/* 8*256-->3*256 */
static void ntt_butterfly_2048_768(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, c1, d1, e1, f1, g1, h1, i1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 7 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_8[0][0]);
	d1 = _mm256_mul_epu32(d, w_8[0][1]);
	e1 = _mm256_mul_epu32(e, w_8[0][2]);
	f1 = _mm256_mul_epu32(f, w_8[0][3]);
	g1 = _mm256_mul_epu32(g, w_8[0][4]);
	h1 = _mm256_mul_epu32(h, w_8[0][5]);
	i1 = _mm256_mul_epu32(i, w_8[0][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 + n2), t);
	a[N2_2048 + n2] %= Q;
	a[N2_2048 + n2 + 1] %= Q;
	a[N2_2048 + n2 + 2] %= Q;
	a[N2_2048 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_8[1][0]);
	d1 = _mm256_mul_epu32(d, w_8[1][1]);
	e1 = _mm256_mul_epu32(e, w_8[1][2]);
	f1 = _mm256_mul_epu32(f, w_8[1][3]);
	g1 = _mm256_mul_epu32(g, w_8[1][4]);
	h1 = _mm256_mul_epu32(h, w_8[1][5]);
	i1 = _mm256_mul_epu32(i, w_8[1][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 2 + n2), t);
	a[N2_2048 * 2 + n2] %= Q;
	a[N2_2048 * 2 + n2 + 1] %= Q;
	a[N2_2048 * 2 + n2 + 2] %= Q;
	a[N2_2048 * 2 + n2 + 3] %= Q;
}

/* 2*256-->7*256 */
static void ntt_butterfly_512_1792(uint64_t *a, uint32_t n2)
{
	__m256i b, c, c1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1792 + n2));
	
	t = _mm256_add_epi64(b, c);
	t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_7[0][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 + n2), t);
	a[N2_1792 + n2] %= Q;
	a[N2_1792 + n2 + 1] %= Q;
	a[N2_1792 + n2 + 2] %= Q;
	a[N2_1792 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[1][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 2 + n2), t);
	a[N2_1792 * 2 + n2] %= Q;
	a[N2_1792 * 2 + n2 + 1] %= Q;
	a[N2_1792 * 2 + n2 + 2] %= Q;
	a[N2_1792 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[2][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 3 + n2), t);
	a[N2_1792 * 3 + n2] %= Q;
	a[N2_1792 * 3 + n2 + 1] %= Q;
	a[N2_1792 * 3 + n2 + 2] %= Q;
	a[N2_1792 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[3][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 4 + n2), t);
	a[N2_1792 * 4 + n2] %= Q;
	a[N2_1792 * 4 + n2 + 1] %= Q;
	a[N2_1792 * 4 + n2 + 2] %= Q;
	a[N2_1792 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[4][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 5 + n2), t);
	a[N2_1792 * 5 + n2] %= Q;
	a[N2_1792 * 5 + n2 + 1] %= Q;
	a[N2_1792 * 5 + n2 + 2] %= Q;
	a[N2_1792 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[5][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 6 + n2), t);
	a[N2_1792 * 6 + n2] %= Q;
	a[N2_1792 * 6 + n2 + 1] %= Q;
	a[N2_1792 * 6 + n2 + 2] %= Q;
	a[N2_1792 * 6 + n2 + 3] %= Q;
}

/* 5*256-->7*256 */
static void ntt_butterfly_1280_1792(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, c1, d1, e1, f1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1792 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 4 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_7[0][0]);
	d1 = _mm256_mul_epu32(d, w_7[0][1]);
	e1 = _mm256_mul_epu32(e, w_7[0][2]);
	f1 = _mm256_mul_epu32(f, w_7[0][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 + n2), t);
	a[N2_1792 + n2] %= Q;
	a[N2_1792 + n2 + 1] %= Q;
	a[N2_1792 + n2 + 2] %= Q;
	a[N2_1792 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_7[1][0]);
	d1 = _mm256_mul_epu32(d, w_7[1][1]);
	e1 = _mm256_mul_epu32(e, w_7[1][2]);
	f1 = _mm256_mul_epu32(f, w_7[1][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 2 + n2), t);
	a[N2_1792 * 2 + n2] %= Q;
	a[N2_1792 * 2 + n2 + 1] %= Q;
	a[N2_1792 * 2 + n2 + 2] %= Q;
	a[N2_1792 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[2][0]);
	d1 = _mm256_mul_epu32(d, w_7[2][1]);
	e1 = _mm256_mul_epu32(e, w_7[2][2]);
	f1 = _mm256_mul_epu32(f, w_7[2][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 3 + n2), t);
	a[N2_1792 * 3 + n2] %= Q;
	a[N2_1792 * 3 + n2 + 1] %= Q;
	a[N2_1792 * 3 + n2 + 2] %= Q;
	a[N2_1792 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[3][0]);
	d1 = _mm256_mul_epu32(d, w_7[3][1]);
	e1 = _mm256_mul_epu32(e, w_7[3][2]);
	f1 = _mm256_mul_epu32(f, w_7[3][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 4 + n2), t);
	a[N2_1792 * 4 + n2] %= Q;
	a[N2_1792 * 4 + n2 + 1] %= Q;
	a[N2_1792 * 4 + n2 + 2] %= Q;
	a[N2_1792 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[4][0]);
	d1 = _mm256_mul_epu32(d, w_7[4][1]);
	e1 = _mm256_mul_epu32(e, w_7[4][2]);
	f1 = _mm256_mul_epu32(f, w_7[4][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 5 + n2), t);
	a[N2_1792 * 5 + n2] %= Q;
	a[N2_1792 * 5 + n2 + 1] %= Q;
	a[N2_1792 * 5 + n2 + 2] %= Q;
	a[N2_1792 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[5][0]);
	d1 = _mm256_mul_epu32(d, w_7[5][1]);
	e1 = _mm256_mul_epu32(e, w_7[5][2]);
	f1 = _mm256_mul_epu32(f, w_7[5][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 6 + n2), t);
	a[N2_1792 * 6 + n2] %= Q;
	a[N2_1792 * 6 + n2 + 1] %= Q;
	a[N2_1792 * 6 + n2 + 2] %= Q;
	a[N2_1792 * 6 + n2 + 3] %= Q;
}

/* 7*256-->7*256 */
static void ntt_butterfly_1792_1792_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, c1, d1, e1, f1, g1, h1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1792 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 6 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_7_inv[0][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[0][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[0][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[0][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[0][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[0][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 + n2), t);
	a[N2_1792 + n2] %= Q;
	a[N2_1792 + n2 + 1] %= Q;
	a[N2_1792 + n2 + 2] %= Q;
	a[N2_1792 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_7_inv[1][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[1][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[1][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[1][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[1][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[1][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 2 + n2), t);
	a[N2_1792 * 2 + n2] %= Q;
	a[N2_1792 * 2 + n2 + 1] %= Q;
	a[N2_1792 * 2 + n2 + 2] %= Q;
	a[N2_1792 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[2][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[2][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[2][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[2][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[2][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[2][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 3 + n2), t);
	a[N2_1792 * 3 + n2] %= Q;
	a[N2_1792 * 3 + n2 + 1] %= Q;
	a[N2_1792 * 3 + n2 + 2] %= Q;
	a[N2_1792 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[3][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[3][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[3][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[3][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[3][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[3][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 4 + n2), t);
	a[N2_1792 * 4 + n2] %= Q;
	a[N2_1792 * 4 + n2 + 1] %= Q;
	a[N2_1792 * 4 + n2 + 2] %= Q;
	a[N2_1792 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[4][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[4][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[4][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[4][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[4][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[4][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 5 + n2), t);
	a[N2_1792 * 5 + n2] %= Q;
	a[N2_1792 * 5 + n2 + 1] %= Q;
	a[N2_1792 * 5 + n2 + 2] %= Q;
	a[N2_1792 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[5][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[5][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[5][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[5][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[5][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[5][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 6 + n2), t);
	a[N2_1792 * 6 + n2] %= Q;
	a[N2_1792 * 6 + n2 + 1] %= Q;
	a[N2_1792 * 6 + n2 + 2] %= Q;
	a[N2_1792 * 6 + n2 + 3] %= Q;
}

/* 3*256-->3*256 */
static void ntt_butterfly_768_768_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, c1, d1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_768 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_768 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_3_inv[0]);
	d1 = _mm256_mul_epu32(d, w_3_inv[1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 + n2), t);
	a[N2_768 + n2] %= Q;
	a[N2_768 + n2 + 1] %= Q;
	a[N2_768 + n2 + 2] %= Q;
	a[N2_768 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_3_inv[1]);
	d1 = _mm256_mul_epu32(d, w_3_inv[0]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 * 2 + n2), t);
	a[N2_768 * 2 + n2] %= Q;
	a[N2_768 * 2 + n2 + 1] %= Q;
	a[N2_768 * 2 + n2 + 2] %= Q;
	a[N2_768 * 2 + n2 + 3] %= Q;
}

/* 2*256-->3*256 */
static void ntt_butterfly_512_768(uint64_t *a, uint32_t n2)
{
	__m256i b, c, c1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_768 + n2));
	
	t = _mm256_add_epi64(b, c);
	t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_3[0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 + n2), t);
	a[N2_768 + n2] %= Q;
	a[N2_768 + n2 + 1] %= Q;
	a[N2_768 + n2 + 2] %= Q;
	a[N2_768 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_3[1]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 * 2 + n2), t);
	a[N2_768 * 2 + n2] %= Q;
	a[N2_768 * 2 + n2 + 1] %= Q;
	a[N2_768 * 2 + n2 + 2] %= Q;
	a[N2_768 * 2 + n2 + 3] %= Q;	
}

/* 3*256-->1*256 */
static void ntt_butterfly_768_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_768 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_768 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

/* 7*256-->8*256 */
static void ntt_butterfly_1792_2048(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, c1, d1, e1, f1, g1, h1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 6 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_8[0][0]);
	d1 = _mm256_mul_epu32(d, w_8[0][1]);
	e1 = _mm256_mul_epu32(e, w_8[0][2]);
	f1 = _mm256_mul_epu32(f, w_8[0][3]);
	g1 = _mm256_mul_epu32(g, w_8[0][4]);
	h1 = _mm256_mul_epu32(h, w_8[0][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 + n2), t);
	a[N2_2048 + n2] %= Q;
	a[N2_2048 + n2 + 1] %= Q;
	a[N2_2048 + n2 + 2] %= Q;
	a[N2_2048 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[1][0]);
	d1 = _mm256_mul_epu32(d, w_8[1][1]);
	e1 = _mm256_mul_epu32(e, w_8[1][2]);
	f1 = _mm256_mul_epu32(f, w_8[1][3]);
	g1 = _mm256_mul_epu32(g, w_8[1][4]);
	h1 = _mm256_mul_epu32(h, w_8[1][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 2 + n2), t);
	a[N2_2048 * 2 + n2] %= Q;
	a[N2_2048 * 2 + n2 + 1] %= Q;
	a[N2_2048 * 2 + n2 + 2] %= Q;
	a[N2_2048 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[2][0]);
	d1 = _mm256_mul_epu32(d, w_8[2][1]);
	e1 = _mm256_mul_epu32(e, w_8[2][2]);
	f1 = _mm256_mul_epu32(f, w_8[2][3]);
	g1 = _mm256_mul_epu32(g, w_8[2][4]);
	h1 = _mm256_mul_epu32(h, w_8[2][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 3 + n2), t);
	a[N2_2048 * 3 + n2] %= Q;
	a[N2_2048 * 3 + n2 + 1] %= Q;
	a[N2_2048 * 3 + n2 + 2] %= Q;
	a[N2_2048 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[3][0]);
	d1 = _mm256_mul_epu32(d, w_8[3][1]);
	e1 = _mm256_mul_epu32(e, w_8[3][2]);
	f1 = _mm256_mul_epu32(f, w_8[3][3]);
	g1 = _mm256_mul_epu32(g, w_8[3][4]);
	h1 = _mm256_mul_epu32(h, w_8[3][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 4 + n2), t);
	a[N2_2048 * 4 + n2] %= Q;
	a[N2_2048 * 4 + n2 + 1] %= Q;
	a[N2_2048 * 4 + n2 + 2] %= Q;
	a[N2_2048 * 4 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_8[4][0]);
	d1 = _mm256_mul_epu32(d, w_8[4][1]);
	e1 = _mm256_mul_epu32(e, w_8[4][2]);
	f1 = _mm256_mul_epu32(f, w_8[4][3]);
	g1 = _mm256_mul_epu32(g, w_8[4][4]);
	h1 = _mm256_mul_epu32(h, w_8[4][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 5 + n2), t);
	a[N2_2048 * 5 + n2] %= Q;
	a[N2_2048 * 5 + n2 + 1] %= Q;
	a[N2_2048 * 5 + n2 + 2] %= Q;
	a[N2_2048 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[5][0]);
	d1 = _mm256_mul_epu32(d, w_8[5][1]);
	e1 = _mm256_mul_epu32(e, w_8[5][2]);
	f1 = _mm256_mul_epu32(f, w_8[5][3]);
	g1 = _mm256_mul_epu32(g, w_8[5][4]);
	h1 = _mm256_mul_epu32(h, w_8[5][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 6 + n2), t);
	a[N2_2048 * 6 + n2] %= Q;
	a[N2_2048 * 6 + n2 + 1] %= Q;
	a[N2_2048 * 6 + n2 + 2] %= Q;
	a[N2_2048 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[6][0]);
	d1 = _mm256_mul_epu32(d, w_8[6][1]);
	e1 = _mm256_mul_epu32(e, w_8[6][2]);
	f1 = _mm256_mul_epu32(f, w_8[6][3]);
	g1 = _mm256_mul_epu32(g, w_8[6][4]);
	h1 = _mm256_mul_epu32(h, w_8[6][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 7 + n2), t);
	a[N2_2048 * 7 + n2] %= Q;
	a[N2_2048 * 7 + n2 + 1] %= Q;
	a[N2_2048 * 7 + n2 + 2] %= Q;
	a[N2_2048 * 7 + n2 + 3] %= Q;
}

/* 8*256-->1*256 */
static void ntt_butterfly_2048_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 7 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

void ntt_1280_2048(uint64_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1280_2048);
}

void intt_2048_768(uint64_t *a)
{
	intt_core(a, N1_2048, N2_2048, 768, omega_256, omega_2048, ntt_butterfly_2048_768, INV_2048);
}

void ntt_512_1792(uint64_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_512_1792);
}

void ntt_1280_1792(uint64_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1280_1792);
}

void intt_1792_1792_inv(uint64_t *a)
{
	intt_core(a, N1_1792, N2_1792, 1792, omega_256_inv, omega_1792_inv, ntt_butterfly_1792_1792_inv, INV_1792);
}

void ntt_768_768_inv(uint64_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256_inv, omega_768_inv, ntt_butterfly_768_768_inv);
}

void ntt_512_768(uint64_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256, omega_768, ntt_butterfly_512_768);
}

void intt_768_256(uint64_t *a)
{
	intt_core(a, N1_768, N2_768, 256, omega_256, omega_768, ntt_butterfly_768_256, INV_768);
}

void ntt_1792_2048(uint64_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1792_2048);
}

void intt_2048_256(uint64_t *a)
{
	intt_core(a, N1_2048, N2_2048, 256, omega_256, omega_2048, ntt_butterfly_2048_256, INV_2048);
}
